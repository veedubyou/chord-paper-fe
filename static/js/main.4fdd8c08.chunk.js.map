{"version":3,"sources":["assets/img/symphony.png","components/edit/CopyAndPaste.ts","common/Whitespace.ts","components/about/About.tsx","components/edit/ErrorPage.tsx","common/LyricTokenizer.ts","common/ChordModel/ChordBlock.ts","common/ChordModel/ChordLinePatcher.ts","common/ChordModel/Collection.ts","common/ChordModel/ChordLine.ts","components/edit/DragAndDrop.tsx","components/WithAutoSave.tsx","components/edit/InteractionContext.ts","components/edit/HighlightChordLyricStyle.ts","components/display/Lyric.tsx","components/edit/ChordDroppable.tsx","components/display/ChordSymbol.tsx","components/edit/DraggableChordSymbol.tsx","components/edit/TextInput.tsx","components/edit/Token.tsx","components/edit/Block.tsx","components/edit/WithHoverMenu.tsx","components/edit/WithLyricInput.tsx","components/display/SectionLabel.ts","components/edit/EditableTypography.tsx","components/edit/WithSectionLabel.tsx","components/edit/Line.tsx","components/edit/NewLine.tsx","components/edit/ChordPaperBody.tsx","components/tutorial/Playground.tsx","common/ChordModel/ChordSong.ts","components/tutorial/Common.tsx","components/tutorial/Start.tsx","components/Tutorial.tsx","components/tutorial/EditChord.tsx","components/tutorial/RemoveChord.tsx","components/tutorial/AddChord.tsx","components/tutorial/DragAndDropChord.tsx","components/tutorial/EditLyrics.tsx","components/tutorial/Instrumental.tsx","components/tutorial/ChordPositioning.tsx","components/tutorial/AddLine.tsx","components/tutorial/RemoveLine.tsx","components/tutorial/PasteLyrics.tsx","components/tutorial/MergeLine.tsx","components/tutorial/CopyAndPaste.tsx","components/SideMenu.tsx","components/edit/ChordPaperMenu.tsx","components/edit/Header.tsx","components/edit/ChordPaper.tsx","components/play/PlayBlock.tsx","components/play/PlayLine.tsx","components/play/PlayContent.tsx","components/play/DisplaySettings.tsx","components/play/PlayMenu.tsx","components/play/Play.tsx","components/SongRouter.tsx","components/Version.tsx","components/WithSongContext.tsx","NeverGonnaGiveYouUp.ts","App.tsx","common/BrowserSave.ts","serviceWorker.ts","index.tsx"],"names":["module","exports","RangePosition","isWhitespace","s","test","inflateIfEmpty","value","RootPaper","withStyles","theme","root","margin","spacing","padding","minHeight","minWidth","Paper","About","Grid","container","data-testid","item","xs","Typography","variant","position","ErrorPage","tokenize","lineOfLyrics","matches","match","ChordBlockValidator","iots","chord","lyric","type","ChordBlock","id","this","shortid","generate","lodash","omit","splitIndex","Error","tokens","lyricTokens","prevBlockLyricTokens","slice","thisBlockLyricTokens","prevBlock","join","other","validatedFields","jsonStr","result","parseJSON","isLeft","jsonObj","right","validationResult","decode","left","differ","dmp","DiffMatchPatch","diffTimeout","matchThreshold","ChordLineIterator","chordLine","currBlockIndex","currCharIndex","blockBuffer","prependLyrics","elements","map","currentBlock","charAt","length","skipChar","currentChar","nextChar","insertChar","atBlockBoundary","prevBlockIndex","deleteChar","i","splice","normalizeBlocks","replaceChordLineLyrics","newLyrics","diffs","diff_main","lyrics","diff_cleanupSemanticLossless","iterator","diff","diffOperation","diffChar","DiffOperation","DIFF_EQUAL","skip","DIFF_INSERT","insert","DIFF_DELETE","delete","finish","newBlocks","block","push","removeOrphanedBlocksWithNoChords","blocks","endsWith","lastIndex","addSpacesToOrphanedBlocks","Collection","undefined","index","findIndex","elem","idable","indexOfBefore","indexOf","newElem","requiredFields","optionalFields","label","ChordLineValidator","ChordLine","newChord","newPrevBlock","split","clone","chordBlocks","reduce","isEqual","otherBlock","contentEquals","isEmpty","chordBlock","fromValidatedFields","CopiedChordLinesValidator","copiedChordLines","normalizeNodeBoundary","offset","getPositionForNode","MIDDLE","offsetFromParent","findOffsetForNode","END","node","parentNode","nodeType","Node","TEXT_NODE","START","nodeValue","getPositionForTextNode","ELEMENT_NODE","childNodes","getPositionForElementNode","nodes","getSelectedLineIDs","selection","window","getSelection","rangeCount","range","wideRange","document","createRange","firstRange","getRangeAt","setStart","startContainer","startOffset","setEnd","endContainer","endOffset","rangeIndex","compareBoundaryPoints","Range","START_TO_START","END_TO_END","getWideSelectionBoundary","normalizeRange","lineElements","querySelectorAll","lineIDs","lineElementIndex","lineElement","intersectsNode","lineID","getAttribute","useLineCopyHandler","song","enqueueSnackbar","useSnackbar","event","lines","chordLines","filter","line","includes","copyMsg","serialized","payload","JSON","stringify","serializeCopiedChordLines","clipboardData","setData","preventDefault","useLinePasteHandler","deserializedCopyResult","obj","deserializeCopiedChordLines","errorMsg","message","currLine","get","copiedLines","addAfter","remove","RNDContext","createDndContext","HTML5Backend","OriginalComponent","DragAndDrop","props","DNDElement","manager","useRef","children","current","dragDropManager","DndProvider","useDNDProviderElement","Fragment","InteractionContext","React","createContext","startInteraction","endInteraction","useEditingState","useState","editing","setEditing","useContext","startEdit","finishEdit","highlightedSpaceStyle","backgroundColor","palette","primary","main","highlightedWordStyle","color","outlineStyle","borderStyle","borderColor","borderRadius","borderWidth","withCustomLyricSelector","selector","options","customLyricClassSelector","withCustomChordSymbolSelector","customChordSymbolClassSelector","dragOverChordLyricStyle","highlightedSpace","highlightedWord","customOutlineStyles","outline","spaceClassSelector","wordClassSelector","chordSymbolSelector","hoverChordLyricStyle","chordTargetSelector","customChordTargetClassSelector","withCustomChordTargetSelector","lyricTypographyProps","display","lyricStyle","createStyles","tabSize","whiteSpace","wordSpacing","LyricTypography","Lyric","customClassName","className","clsx","ChordDroppable","useDrop","accept","drop","droppedChord","handled","onDropped","sourceBlockID","collect","monitor","isOver","shallow","dropRef","childElem","childClassName","dragOverClassName","hoverableClassName","cloneElement","RootRef","rootRef","ChordTypography","cursor","fontFamily","userSelect","ChordSymbol","formattedChord","DraggableChordSymbol","useDrag","chordBlockID","dragRef","InputTypography","width","grey","useContentEditableStyle","makeStyles","pointerEvents","content","TextInput","contentEditableRef","createRef","textContent","enterHandler","key","selectionRange","selectionOffsets","contains","specialBackspaceHandler","onSpecialBackspace","metaKey","ctrlKey","offsets","insertTextAtSelection","newContent","deleteContents","insertNode","createTextNode","collapse","normalize","tabHandler","specialStylingKeysHandler","newValue","onFinish","composeMultilinePaste","pasteContent","currValue","splitStringBySelection","beforeSelection","afterSelection","newPasteLines","handlePlainTextPaste","onPasteOverflow","getData","linesOfText","flatMap","setValue","handleJSONPaste","onJSONPaste","useEffect","focus","newRange","selectNodeContents","removeAllRanges","addRange","contentEditableStyle","classes","contentEditable","ref","onBlur","onKeyDown","handler","onPaste","suppressContentEditableWarning","InvisibleTypography","top","transform","ChordTargetBox","onClick","Token","lyricClassName","lyricBlock","Box","invisibleTarget","ChordInput","borderBottom","borderBottomColor","borderBottomWidth","useFirstTokenStyle","dragOver","red","hoverable","dark","useNormalTokenStyle","Block","firstTokenStyle","normalTokenStyle","invisibleTargetForFirstToken","clickHandler","tokenIndex","onBlockSplit","stopPropagation","handleDragged","onChordChange","dropHandler","onChordDragAndDrop","endEdit","lyricBlocks","lyricToken","invisibleTargetOption","direction","onDragged","Button","contained","UnstyledButton","Tooltip","tooltip","background","UnstyledTooltip","WithHoverMenu","hoverMenu","ButtonGroup","orientation","menuItems","menuItem","icon","placement","title","interactive","LyricInput","secondary","WithLyricInput","handlers","lyricEdit","replaceLyrics","onChangeLine","pasteOverflow","overflowContent","jsonPaste","specialBackspace","onMergeWithPreviousLine","bottom","sectionLabelStyle","blueGrey","PlaceholderTypography","EditableTypography","editingState","setEditingState","editControl","onStartEdit","onEndEdit","onValueChange","editableLine","placeholder","typographyProps","nonEditableLine","UnstyledEditableTypography","WithSectionLabel","childElement","newLabel","onChangeLabel","AtomicSelectionBox","BackspaceIcon","UnstyledBackspaceIcon","HighlightableBox","Line","removed","setRemoved","chordChange","setChord","blockSplit","splitBlock","onRemoveLine","setTimeout","withHoverMenu","basicLine","lineContent","editLabel","withLyricInput","yeetDirection","Slide","in","timeout","data-lineid","HighlightableGrid","Divider","UnstyledDivider","AddCircleOutlineIcon","light","UnstyledAddCircleOutlineIcon","NewLine","useTheme","onAdd","justify","style","useUninteractiveStyle","UnstyledPaper","ChordPaperBody","interacting","setInteracting","handleCopy","handleLinePaste","interactionContextValue","uninteractiveStyle","handleAddLineToTop","newLine","addBeginning","notifySongChanged","handleRemoveLine","handleChangeLine","handlePasteOverflow","newChordLines","newLyricLine","fromLyrics","mergeWithPreviousLine","mergeLineWithPrevious","onSongChanged","handleChordDND","destinationBlockID","findLineAndBlock","sourceLine","destinationLine","destinationBlock","allowInteraction","paperClassName","Provider","onCopy","elevation","handleAddLine","firstNewLine","CheckCircleIcon","success","UnstyledCheckCircleIcon","Badge","UnstyledBadge","Playground","initialSong","setSong","setFinish","checkExpected","updatedSong","expectedSong","badgeContent","invisible","SongMetadataValidator","composedBy","performedBy","asHeardFrom","ChordSongValidator","metadata","ChordSong","prevLine","lastBlockIndex","otherLine","blockID","find","newTitle","newPerformedBy","newComposedBy","newAsHeardFrom","chordLineValidatedFields","lyricLines","lyricLine","LyricsTypography","LineBreak","Header","Preamble","allExercises","route","component","tabExample","example","variantMapping","body1","PlayArrowIcon","UnstyledPlayArrowIcon","marginTop","marginBottom","Fab","UnstyledFab","Tutorial","matchEntry","entry","exerciseEntry","exerciseIndex","nextButton","nextExercise","to","withPointerStyle","MenuIcon","UnstyledMenuIcon","CloseIcon","UnstyledCloseIcon","VerticalGridItem","maxWidth","TitleGrid","TitleName","CollapsedMenuSurface","height","FullHeightGrid","SideMenu","expanded","setExpanded","learnSubmenuOpen","setLearnSubMenuOpen","learnClickHandler","linkStyle","textDecoration","collapsedMenu","Drawer","open","anchor","alignContent","expandedMenu","alignItems","List","ListItem","button","ListItemIcon","ListItemText","primaryTypographyProps","exerciseLinks","exerciseRoute","inset","Collapse","tutorialMenu","SpeedDial","UnstyledSpeedDial","ChordPaperMenu","setOpen","pickFileHandler","fileList","files","file","fileReader","FileReader","onload","ev","target","ArrayBuffer","results","deserialize","onLoad","readAsText","loadAction","a","inputElem","createElement","addEventListener","click","SpeedDialIcon","onOpen","onClose","ariaLabel","SpeedDialAction","tooltipTitle","blob","Blob","objectURL","URL","createObjectURL","download","href","revokeObjectURL","onNewSong","onPlay","paddingBottom","align","details","newComposer","newPerformer","newHeardFrom","paddingTop","paddingLeft","paddingRight","ChordPaper","songChangeHandler","loadedSong","PlayBlock","LabelTypography","TopMarginBox","PlayLine","lineComponent","PlayContent","numberOfColumns","formatting","columnMargin","windowWidth","useWindowWidth","columnWidth","snapThreshold","scrollPage","forward","nextPos","scrollX","distanceFromLastColumn","scrollTo","behavior","scrollForward","scrollBackward","handleLeftClick","handleRightClick","ColumnedPaper","columnGap","columnRuleWidth","columnRuleStyle","columnRuleColor","columns","MarginBox","marginLeft","marginRight","onMouseDown","onContextMenu","tabIndex","UnstyledBox","DisplaySettings","defaultSettings","toString","fontSize","settings","setSettings","validateNumber","strValue","convertedNumber","Number","isNaN","validateInt","convertedInteger","Math","floor","validatedSettings","numberOfColumnsResults","fontSizeResults","columnMarginResults","inputSpecs","field","adornment","validationErrorPropsFn","val","makeInput","spec","textFieldProps","defaultValue","onChange","newSettings","error","helperText","InputProps","endAdornment","InputAdornment","TextField","Dialog","DialogTitle","DialogContent","DialogActions","disabled","onSubmit","PlayMenu","displaySettingsOpen","setDisplaySettingsOpen","onFormattingChange","FabProps","onMouseDownCapture","onExit","Play","setFormatting","onEdit","ThemeProvider","createMuiTheme","typography","fontWeightRegular","SongRouter","history","useHistory","editPath","basePath","playPath","path","PaddedTypography","Version","version","process","useBackdropStyles","backdrop","zIndex","drawer","withSongContext","propsWithoutInitialSong","originalComponentProps","chords","NeverGonnaGiveYouUp","assembleLine","arr","tokenSize","subArr","chunk","lyricChunk","random","contrastText","SnackbarProvider","variantSuccess","UnstyledSnackbarProvider","AppLayout","backgroundImage","WoodBackground","MainSong","setLoadedSong","backdropStyles","loadResults","jsonSong","localStorage","getItem","loadSong","msg","loadLastSavedSong","Backdrop","CircularProgress","setItem","saveSong","DemoSong","AppContent","location","useLocation","routes","from","exact","pathname","App","titleTemplate","defaultTitle","Boolean","hostname","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","then","registration","unregister","catch","console"],"mappings":"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","file":"static/js/main.4fdd8c08.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/symphony.4ca23f9c.png\";","import {\n    ChordLine,\n    ChordLineValidator,\n    ChordLineValidatedFields,\n} from \"../../common/ChordModel/ChordLine\";\nimport * as iots from \"io-ts\";\nimport { Either, right, left, isLeft, parseJSON } from \"fp-ts/lib/Either\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport { useSnackbar } from \"notistack\";\n\nconst CopiedChordLinesValidator = iots.type({\n    copiedChordLines: iots.array(ChordLineValidator),\n});\n\ntype CopiedChordLines = iots.TypeOf<typeof CopiedChordLinesValidator>;\n\nconst deserializeCopiedChordLines = (\n    jsonStr: string\n): Either<Error, ChordLine[]> | null => {\n    const result: Either<Error, unknown> = parseJSON(\n        jsonStr,\n        () => new Error(\"Failed to parse json string\")\n    );\n\n    if (isLeft(result)) {\n        return result;\n    }\n\n    const jsonObj = result.right as any;\n\n    // if the JSON doesn't contain this field, then it's a JSON copy payload\n    // from somewhere else - don't handle it\n    if (jsonObj.copiedChordLines === undefined) {\n        return null;\n    }\n\n    const validationResult = CopiedChordLinesValidator.decode(jsonObj);\n\n    if (isLeft(validationResult)) {\n        return left(new Error(\"Invalid Chord Lines payload\"));\n    }\n\n    const validatedChordLineObjects = validationResult.right.copiedChordLines;\n    const chordLines: ChordLine[] = validatedChordLineObjects.map(\n        (obj: ChordLineValidatedFields) => {\n            return ChordLine.fromValidatedFields(obj);\n        }\n    );\n\n    return right(chordLines);\n};\n\nconst serializeCopiedChordLines = (chordLines: ChordLine[]): string => {\n    const payload: CopiedChordLines = {\n        copiedChordLines: chordLines,\n    };\n\n    return JSON.stringify(payload);\n};\n\nenum RangePosition {\n    START,\n    END,\n    MIDDLE,\n}\n\nconst parentNode = (node: Node): Node => {\n    if (node.parentNode === null) {\n        throw new Error(\"Node doesn't have parent\");\n    }\n\n    return node.parentNode;\n};\n\nconst normalizeNodeBoundary = (\n    container: Node,\n    offset: number\n): [Node, number] => {\n    const position = getPositionForNode(container, offset);\n    if (position === RangePosition.MIDDLE) {\n        return [container, offset];\n    }\n\n    let offsetFromParent = findOffsetForNode(container);\n    if (position === RangePosition.END) {\n        offsetFromParent += 1;\n    }\n\n    return normalizeNodeBoundary(parentNode(container), offsetFromParent);\n};\n\n// ranges from selection tend to end up inside elements\n// e.g. selecting line 2 might look like\n// <div><div>line 1 |sel-start|</div></div>\n// <div><div>line 2 |sel-end|</div></div>\n// but what we really want is more like\n// <div><div>line 1 </div></div>\n// |sel-start|<div><div>line 2 </div></div>|sel-end|\n// this function adjusts the boundaries of range by climbing up the DOM tree\n// when the range boundary is at the start or end edge of an element\nconst normalizeRange = (range: Range) => {\n    const [startContainer, startOffset] = normalizeNodeBoundary(\n        range.startContainer,\n        range.startOffset\n    );\n    const [endContainer, endOffset] = normalizeNodeBoundary(\n        range.endContainer,\n        range.endOffset\n    );\n\n    range.setStart(startContainer, startOffset);\n    range.setEnd(endContainer, endOffset);\n};\n\nconst getPositionForTextNode = (\n    container: Node,\n    offset: number\n): RangePosition => {\n    if (offset === 0) {\n        return RangePosition.START;\n    }\n\n    const nodeValue: string | null = container.nodeValue;\n    if (nodeValue === null) {\n        throw new Error(\"Text node has no value?\");\n    }\n\n    if (offset === nodeValue.length) {\n        return RangePosition.END;\n    }\n\n    return RangePosition.MIDDLE;\n};\n\nconst getPositionForElementNode = (\n    container: Node,\n    offset: number\n): RangePosition => {\n    const childNodes = container.childNodes;\n    if (offset === 0) {\n        return RangePosition.START;\n    }\n\n    if (offset === childNodes.length) {\n        return RangePosition.END;\n    }\n\n    return RangePosition.MIDDLE;\n};\n\nconst getPositionForNode = (container: Node, offset: number): RangePosition => {\n    switch (container.nodeType) {\n        case Node.TEXT_NODE: {\n            return getPositionForTextNode(container, offset);\n        }\n        case Node.ELEMENT_NODE: {\n            return getPositionForElementNode(container, offset);\n        }\n\n        default: {\n            throw new Error(\"Crash for now \" + container.nodeType);\n        }\n    }\n};\n\nconst findOffsetForNode = (node: Node): number => {\n    if (node.parentNode === null) {\n        throw new Error(\"wtf\");\n    }\n\n    const nodes = node.parentNode.childNodes;\n\n    for (let i = 0; i < nodes.length; i++) {\n        if (nodes.item(i) === node) {\n            return i;\n        }\n    }\n\n    throw new Error(\"Child node doesn't exist in parent???\");\n};\n\n// selection can be represented as many discontiguous ranges, but that doesn't help us\n// figure out whether a line is under selection or not.\n// this utility function figures out a range that's the superset of all ranges in the selection\n// with the start point as the earliest start point, and the end point as the latest end point\nconst getWideSelectionBoundary = (selection: Selection): Range => {\n    const wideRange = document.createRange();\n    const firstRange = selection.getRangeAt(0);\n    wideRange.setStart(firstRange.startContainer, firstRange.startOffset);\n    wideRange.setEnd(firstRange.endContainer, firstRange.endOffset);\n    // selecting in the app can result in many dis\n\n    for (let rangeIndex = 1; rangeIndex < selection.rangeCount; rangeIndex++) {\n        const range = selection.getRangeAt(rangeIndex);\n\n        if (\n            range.compareBoundaryPoints(Range.START_TO_START, wideRange) === -1\n        ) {\n            wideRange.setStart(range.startContainer, range.startOffset);\n        }\n\n        if (range.compareBoundaryPoints(Range.END_TO_END, wideRange) === 1) {\n            wideRange.setEnd(range.endContainer, range.endOffset);\n        }\n    }\n\n    return wideRange;\n};\n\nconst getSelectedLineIDs = (): string[] => {\n    const selection: Selection | null = window.getSelection();\n    if (selection === null || selection.rangeCount === 0) {\n        return [];\n    }\n\n    const range = getWideSelectionBoundary(selection);\n    normalizeRange(range);\n\n    const lineElements = document.querySelectorAll(\"[data-lineid]\");\n    const lineIDs: string[] = [];\n\n    for (\n        let lineElementIndex = 0;\n        lineElementIndex < lineElements.length;\n        lineElementIndex++\n    ) {\n        const lineElement = lineElements.item(lineElementIndex);\n\n        if (!range.intersectsNode(lineElement)) {\n            continue;\n        }\n\n        const lineID: string | null = lineElement.getAttribute(\"data-lineid\");\n        if (lineID === null) {\n            throw new Error(\n                \"Unexpected - line element should have line ID because that's how it was selected\"\n            );\n        }\n\n        lineIDs.push(lineID);\n    }\n\n    return lineIDs;\n};\n\nexport const useLineCopyHandler = (song: ChordSong) => {\n    const { enqueueSnackbar } = useSnackbar();\n\n    return (event: React.ClipboardEvent<HTMLDivElement>): boolean => {\n        const lineIDs: string[] = getSelectedLineIDs();\n        const lines = song.chordLines.filter((line: ChordLine): boolean => {\n            return lineIDs.includes(line.id);\n        });\n\n        if (lines.length === 0) {\n            return false;\n        }\n\n        const serialized = serializeCopiedChordLines(lines);\n        event.clipboardData.setData(\"application/json\", serialized);\n\n        event.preventDefault();\n\n        let copyMsg: string;\n        if (lines.length === 1) {\n            copyMsg = `1 line copied to your clipboard`;\n        } else {\n            copyMsg = `${lines.length} lines copied to your clipboard`;\n        }\n\n        enqueueSnackbar(copyMsg, { variant: \"info\" });\n        return true;\n    };\n};\n\nexport const useLinePasteHandler = (song: ChordSong) => {\n    const { enqueueSnackbar } = useSnackbar();\n\n    return (id: IDable<ChordLine>, jsonStr: string): boolean => {\n        const deserializedCopyResult = deserializeCopiedChordLines(jsonStr);\n        // not actually a Chord Paper line payload, don't handle it\n        if (deserializedCopyResult === null) {\n            return false;\n        }\n\n        if (isLeft(deserializedCopyResult)) {\n            const errorMsg =\n                \"Failed to paste copied lines: \" +\n                deserializedCopyResult.left.message;\n            enqueueSnackbar(errorMsg, { variant: \"error\" });\n            return true;\n        }\n\n        const currLine: ChordLine = song.get(id);\n\n        const copiedLines: ChordLine[] = deserializedCopyResult.right;\n        song.addAfter(id, ...copiedLines);\n\n        // if the line is empty, the user was probably trying to paste into the current line, and not the next\n        // so just remove the current line to simulate that\n        if (currLine.isEmpty()) {\n            song.remove(id);\n        }\n\n        return true;\n    };\n};\n","export const isWhitespace = (s: string): boolean => {\n    return /^\\s+$/.test(s);\n};\n\nexport const inflatingWhitespace = (): string => {\n    return \"\\u00A0\";\n};\n\nexport const inflateIfEmpty = (value: string) => {\n    if (isWhitespace(value)) {\n        return inflatingWhitespace();\n    }\n\n    return value;\n};\n","import React from \"react\";\nimport { Paper, Typography, Theme, Grid } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport { inflatingWhitespace } from \"../../common/Whitespace\";\n\nconst RootPaper = withStyles((theme: Theme) => ({\n    root: {\n        margin: theme.spacing(5),\n        padding: theme.spacing(5),\n        minHeight: theme.spacing(46),\n        minWidth: theme.spacing(92),\n    },\n}))(Paper);\n\nconst About: React.FC<{}> = (): JSX.Element => {\n    return (\n        <Grid container data-testid=\"About\">\n            <Grid item xs={3}></Grid>\n            <Grid item xs={6}>\n                <RootPaper>\n                    <Typography variant=\"h6\">About Chord Paper</Typography>\n                    <Typography variant=\"h6\">\n                        {inflatingWhitespace()}\n                    </Typography>\n                    <Typography>\n                        Chord Paper makes writing and reading chord sheets\n                        easier than the traditional monospace font formatting.\n                        It's a passion project born out of frustration at the\n                        clunkiness of writing chords on a computer.\n                    </Typography>\n                    <Typography>{inflatingWhitespace()}</Typography>\n                    <Typography>\n                        Hope you will find that Chord Paper helps you focus more\n                        of your musical time on playing and listening, and less\n                        on formatting.\n                    </Typography>\n                </RootPaper>\n            </Grid>\n            <Grid item xs={3}></Grid>\n        </Grid>\n    );\n};\n\nexport default About;\n","import { Grid, Paper, Theme, Typography } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React from \"react\";\n\nconst RootPaper = withStyles((theme: Theme) => ({\n    root: {\n        margin: theme.spacing(5),\n        padding: theme.spacing(5),\n        minHeight: theme.spacing(46),\n        minWidth: theme.spacing(92),\n        position: \"relative\",\n    },\n}))(Paper);\n\nconst ErrorPage: React.FC<{}> = (): JSX.Element => {\n    return (\n        <Grid container data-testid=\"Tutorial\">\n            <Grid item xs={3}></Grid>\n            <Grid item xs={6}>\n                <RootPaper>\n                    <Typography>An Error Occurred Oh No</Typography>\n                </RootPaper>\n            </Grid>\n            <Grid item xs={3}></Grid>\n        </Grid>\n    );\n};\n\nexport default ErrorPage;\n","export const tokenize = (lineOfLyrics: string): string[] => {\n    const matches = lineOfLyrics.match(/((\\w|')+|[^\\w'])/g);\n    if (matches === null) {\n        return [];\n    }\n\n    return matches;\n};\n","import { Either, isLeft, left, parseJSON, right } from \"fp-ts/lib/Either\";\nimport * as iots from \"io-ts\";\nimport lodash from \"lodash\";\nimport shortid from \"shortid\";\nimport { tokenize } from \"../LyricTokenizer\";\nimport { IDable } from \"./Collection\";\n\ninterface ChordBlockConstructorParams {\n    chord: string;\n    lyric: string;\n}\n\nexport const ChordBlockValidator = iots.type({\n    chord: iots.string,\n    lyric: iots.string,\n    type: iots.literal(\"ChordBlock\"),\n});\n\nexport type ChordBlockValidatedFields = iots.TypeOf<typeof ChordBlockValidator>;\n\nexport class ChordBlock implements IDable<ChordBlock> {\n    id: string;\n    chord: string;\n    lyric: string;\n    type: \"ChordBlock\";\n\n    constructor({ chord, lyric }: ChordBlockConstructorParams) {\n        this.id = shortid.generate();\n        this.chord = chord;\n        this.lyric = lyric;\n        this.type = \"ChordBlock\";\n    }\n\n    toJSON(): object {\n        return lodash.omit(this, \"id\");\n    }\n\n    static fromValidatedFields(\n        validatedFields: ChordBlockValidatedFields\n    ): ChordBlock {\n        return new ChordBlock({\n            chord: validatedFields.chord,\n            lyric: validatedFields.lyric,\n        });\n    }\n\n    static deserialize(jsonStr: string): Either<Error, ChordBlock> {\n        const result: Either<Error, unknown> = parseJSON(\n            jsonStr,\n            () => new Error(\"Failed to parse json string\")\n        );\n\n        if (isLeft(result)) {\n            return result;\n        }\n\n        const jsonObj = result.right;\n        const validationResult = ChordBlockValidator.decode(jsonObj);\n\n        if (isLeft(validationResult)) {\n            return left(new Error(\"Invalid Chord Block object\"));\n        }\n\n        return right(\n            new ChordBlock({\n                chord: validationResult.right.chord,\n                lyric: validationResult.right.lyric,\n            })\n        );\n    }\n\n    get lyricTokens(): string[] {\n        return tokenize(this.lyric);\n    }\n\n    // splits a block, and returns the block before\n    // e.g.\n    // {id:\"A\", chord: \"B7\", lyric:\"my dear we're\"}\n    // splitBlock(4) =>\n    // {id:\"B\", chord: \"B7\", lyric:\"my dear \"}\n    // {id:\"A\", chord: \"\", \"we're\"}\n    split(splitIndex: number): ChordBlock {\n        if (splitIndex === 0) {\n            throw new Error(\"Split index can't be zero\");\n        }\n\n        const tokens = this.lyricTokens;\n        const prevBlockLyricTokens: string[] = tokens.slice(0, splitIndex);\n        const thisBlockLyricTokens: string[] = tokens.slice(splitIndex);\n\n        const prevBlock: ChordBlock = new ChordBlock({\n            chord: this.chord,\n            lyric: prevBlockLyricTokens.join(\"\"),\n        });\n\n        this.chord = \"\";\n        this.lyric = thisBlockLyricTokens.join(\"\");\n\n        return prevBlock;\n    }\n\n    contentEquals(other: ChordBlock): boolean {\n        return this.chord === other.chord && this.lyric === other.lyric;\n    }\n\n    isEmpty(): boolean {\n        return this.chord === \"\" && this.lyric === \"\";\n    }\n}\n","import { ChordLine } from \"./ChordLine\";\nimport { ChordBlock } from \"./ChordBlock\";\nimport { DiffMatchPatch, DiffOperation } from \"diff-match-patch-typescript\";\n\nconst differ: DiffMatchPatch = (() => {\n    const dmp = new DiffMatchPatch();\n    dmp.diffTimeout = 0;\n    dmp.matchThreshold = 0;\n    return dmp;\n})();\n\nclass ChordLineIterator {\n    private chordLine: ChordLine;\n    private currBlockIndex: number;\n    private currCharIndex: number;\n    private blockBuffer: string[];\n    private prependLyrics: string;\n\n    constructor(chordLine: ChordLine) {\n        this.chordLine = chordLine;\n\n        this.currBlockIndex = 0;\n        this.currCharIndex = 0;\n\n        this.blockBuffer = chordLine.elements.map(() => \"\");\n        this.prependLyrics = \"\";\n    }\n\n    private atBlockBoundary(): boolean {\n        return this.currCharIndex === 0;\n    }\n\n    private currentBlock(): ChordBlock {\n        return this.chordLine.elements[this.currBlockIndex];\n    }\n\n    private currentChar(): string {\n        return this.currentBlock().lyric.charAt(this.currCharIndex);\n    }\n\n    private nextChar(): void {\n        this.currCharIndex += 1;\n\n        if (this.currCharIndex >= this.currentBlock().lyric.length) {\n            this.currBlockIndex += 1;\n            this.currCharIndex = 0;\n        }\n    }\n\n    skip(skipChar: string): void {\n        if (this.currentChar() !== skipChar) {\n            throw new Error(\"Mismatched characters when skipping\");\n        }\n\n        this.blockBuffer[this.currBlockIndex] += skipChar;\n\n        this.nextChar();\n    }\n\n    insert(insertChar: string): void {\n        if (!this.atBlockBoundary()) {\n            this.blockBuffer[this.currBlockIndex] += insertChar;\n        } else {\n            // bias towards inserting  at the end of the previous block if between two blocks\n            // since chords are aligned to the beginning of the block, we don't want to shift the lyrics\n            // inside a block unnecessarily\n            const prevBlockIndex = this.currBlockIndex - 1;\n            if (prevBlockIndex >= 0) {\n                this.blockBuffer[prevBlockIndex] += insertChar;\n            } else {\n                this.prependLyrics += insertChar;\n            }\n        }\n    }\n\n    delete(deleteChar: string): void {\n        if (this.currentChar() !== deleteChar) {\n            throw new Error(\"Mismatched characters when deleting\");\n        }\n\n        this.nextChar();\n    }\n\n    finish(): void {\n        for (let i = 0; i < this.chordLine.elements.length; i++) {\n            this.chordLine.elements[i].lyric = this.blockBuffer[i];\n        }\n\n        if (this.prependLyrics !== \"\") {\n            this.chordLine.elements.splice(\n                0,\n                0,\n                new ChordBlock({ chord: \"\", lyric: this.prependLyrics })\n            );\n        }\n\n        this.chordLine.normalizeBlocks();\n    }\n}\n\nconst removeOrphanedBlocksWithNoChords = (chordLine: ChordLine): void => {\n    const newBlocks: ChordBlock[] = [];\n\n    for (const block of chordLine.elements) {\n        if (block.lyric !== \"\" || block.chord !== \"\") {\n            newBlocks.push(block);\n        }\n    }\n\n    chordLine.elements = newBlocks;\n};\n\nconst addSpacesToOrphanedBlocks = (chordLine: ChordLine): void => {\n    const blocks: ChordBlock[] = chordLine.elements;\n    for (let i = 0; i < blocks.length; i++) {\n        const block = blocks[i];\n        if (block.lyric !== \"\") {\n            continue;\n        }\n\n        const prevBlockHasSpaceToSteal =\n            i > 0 &&\n            blocks[i - 1].lyric.length > 1 &&\n            blocks[i - 1].lyric.endsWith(\" \");\n\n        if (prevBlockHasSpaceToSteal) {\n            // \"steal\" a space from the previous block\n            // e.g. if * represents a space\n            // G        A\n            // We're*no*strangers\n            // replaced with\n            // We're*no*\n            // instead of adding two spaces consecutively, like\n            // G        A\n            // We're*no**\n            // we'll just relegate one of the unused spaces for the orphaned block, like\n            // G       A\n            // We're*no*\n\n            // if there's no space to steal, just add one so that it's backed by a character\n            const prevBlock = blocks[i - 1];\n            const lastIndex = prevBlock.lyric.length - 1;\n            prevBlock.lyric = prevBlock.lyric.slice(0, lastIndex);\n        }\n\n        block.lyric = \" \";\n    }\n};\n\nexport const replaceChordLineLyrics = (\n    chordLine: ChordLine,\n    newLyrics: string\n): void => {\n    const diffs = differ.diff_main(chordLine.lyrics, newLyrics);\n    differ.diff_cleanupSemanticLossless(diffs);\n\n    const iterator = new ChordLineIterator(chordLine);\n\n    for (const diff of diffs) {\n        const diffOperation = diff[0];\n        for (const diffChar of diff[1]) {\n            switch (diffOperation) {\n                case DiffOperation.DIFF_EQUAL: {\n                    iterator.skip(diffChar);\n                    break;\n                }\n                case DiffOperation.DIFF_INSERT: {\n                    iterator.insert(diffChar);\n                    break;\n                }\n                case DiffOperation.DIFF_DELETE: {\n                    iterator.delete(diffChar);\n                    break;\n                }\n            }\n        }\n    }\n\n    iterator.finish();\n\n    removeOrphanedBlocksWithNoChords(chordLine);\n    addSpacesToOrphanedBlocks(chordLine);\n};\n","// use the name of the class the ID is describing for T\n// e.g. IDable<Person>\nexport interface IDable<T extends IDable<T>> {\n    id: string;\n    type: T[\"type\"];\n}\n\nexport abstract class Collection<T extends IDable<T>> {\n    elements: T[];\n\n    constructor(elements?: T[]) {\n        if (elements !== undefined) {\n            this.elements = elements; //TODO: consider whether this needs to be a shallow copy\n        } else {\n            this.elements = [];\n        }\n    }\n\n    protected indexOf(id: string): number {\n        const index = this.elements.findIndex((elem: T) => elem.id === id);\n\n        if (index < 0) {\n            throw new Error(\"Can't find element inside collection\");\n        }\n\n        return index;\n    }\n\n    abstract clone(): Collection<T>;\n\n    // adds a element after the specified id\n    addAfter(idable: IDable<T>, ...newElem: T[]): void {\n        const indexOfBefore = this.indexOf(idable.id);\n        this.elements.splice(indexOfBefore + 1, 0, ...newElem);\n    }\n\n    addBeginning(...newElem: T[]): void {\n        this.elements.splice(0, 0, ...newElem);\n    }\n\n    remove(idable: IDable<T>): T {\n        const index = this.indexOf(idable.id);\n        const removed = this.elements.splice(index, 1);\n        return removed[0];\n    }\n\n    get(idable: IDable<T>): T {\n        const index = this.indexOf(idable.id);\n        return this.elements[index];\n    }\n}\n","import { Either, isLeft, left, parseJSON, right } from \"fp-ts/lib/Either\";\nimport * as iots from \"io-ts\";\nimport lodash from \"lodash\";\nimport shortid from \"shortid\";\nimport {\n    ChordBlock,\n    ChordBlockValidatedFields,\n    ChordBlockValidator,\n} from \"./ChordBlock\";\nimport { replaceChordLineLyrics } from \"./ChordLinePatcher\";\nimport { Collection, IDable } from \"./Collection\";\n\nconst requiredFields = iots.type({\n    elements: iots.array(ChordBlockValidator),\n    type: iots.literal(\"ChordLine\"),\n});\n\nconst optionalFields = iots.partial({\n    label: iots.string,\n});\n\nexport const ChordLineValidator = iots.intersection([\n    requiredFields,\n    optionalFields,\n]);\n\nexport type ChordLineValidatedFields = iots.TypeOf<typeof ChordLineValidator>;\n\nexport class ChordLine extends Collection<ChordBlock>\n    implements IDable<ChordLine> {\n    id: string;\n    type: \"ChordLine\";\n    label?: string;\n\n    constructor(elements?: ChordBlock[], label?: string) {\n        if (elements === undefined) {\n            elements = [new ChordBlock({ chord: \"\", lyric: \"\" })];\n        }\n\n        super(elements);\n\n        this.id = shortid.generate();\n        this.type = \"ChordLine\";\n        this.label = label;\n    }\n\n    static fromValidatedFields(\n        validatedFields: ChordLineValidatedFields\n    ): ChordLine {\n        const chordBlockElems: ChordBlock[] = validatedFields.elements.map(\n            (value: ChordBlockValidatedFields) => {\n                return ChordBlock.fromValidatedFields(value);\n            }\n        );\n\n        return new ChordLine(chordBlockElems, validatedFields.label);\n    }\n\n    static deserialize(jsonStr: string): Either<Error, ChordLine> {\n        const result: Either<Error, unknown> = parseJSON(\n            jsonStr,\n            () => new Error(\"Failed to parse json string\")\n        );\n\n        if (isLeft(result)) {\n            return result;\n        }\n\n        const jsonObj = result.right;\n        const validationResult = ChordLineValidator.decode(jsonObj);\n\n        if (isLeft(validationResult)) {\n            return left(new Error(\"Invalid Chord Line object\"));\n        }\n\n        return right(this.fromValidatedFields(validationResult.right));\n    }\n\n    static fromLyrics(lyrics: string): ChordLine {\n        const block = new ChordBlock({\n            chord: \"\",\n            lyric: lyrics,\n        });\n\n        return new ChordLine([block]);\n    }\n\n    get chordBlocks(): ChordBlock[] {\n        return this.elements;\n    }\n\n    get lyrics(): string {\n        const lyricTokens = this.chordBlocks.map(\n            (chordBlock: ChordBlock) => chordBlock.lyric\n        );\n\n        return lyricTokens.join(\"\");\n    }\n\n    replaceLyrics(newLyrics: string): void {\n        if (newLyrics === this.lyrics) {\n            return;\n        }\n\n        replaceChordLineLyrics(this, newLyrics);\n    }\n\n    setChord(idable: IDable<ChordBlock>, newChord: string): void {\n        const index = this.indexOf(idable.id);\n        this.elements[index].chord = newChord;\n        this.normalizeBlocks();\n    }\n\n    splitBlock(idable: IDable<ChordBlock>, splitIndex: number): void {\n        const index = this.indexOf(idable.id);\n        const block = this.elements[index];\n        const newPrevBlock = block.split(splitIndex);\n        this.elements.splice(index, 0, newPrevBlock);\n    }\n\n    // passes through every block to ensure that blocks without chords exist (except for the first)\n    normalizeBlocks(): void {\n        const newBlocks: ChordBlock[] = [];\n\n        for (let i = 0; i < this.elements.length; i++) {\n            const block = this.elements[i];\n\n            if (block.chord === \"\" && newBlocks.length > 0) {\n                const lastIndex = newBlocks.length - 1;\n                newBlocks[lastIndex].lyric += block.lyric;\n            } else {\n                newBlocks.push(block);\n            }\n        }\n\n        // avoid rejiggering the data if it's a no-op\n        if (newBlocks.length !== this.elements.length) {\n            this.elements = newBlocks;\n        }\n    }\n\n    clone(): ChordLine {\n        const clone = new ChordLine(this.elements, this.label);\n        clone.id = this.id;\n        return clone;\n    }\n\n    toJSON(): object {\n        return lodash.omit(this, \"id\");\n    }\n\n    contentEquals(other: ChordLine): boolean {\n        if (this.chordBlocks.length !== other.chordBlocks.length) {\n            return false;\n        }\n\n        if (this.label !== other.label) {\n            return false;\n        }\n\n        const reducer = (\n            isEqual: boolean,\n            value: ChordBlock,\n            index: number\n        ): boolean => {\n            if (!isEqual) {\n                return false;\n            }\n\n            const otherBlock = other.chordBlocks[index];\n            if (!value.contentEquals(otherBlock)) {\n                return false;\n            }\n\n            return true;\n        };\n\n        return this.chordBlocks.reduce(reducer, true);\n    }\n\n    isEmpty(): boolean {\n        if (this.chordBlocks.length > 1) {\n            return false;\n        }\n\n        if (this.chordBlocks.length === 0) {\n            return true;\n        }\n\n        return this.chordBlocks[0].isEmpty();\n    }\n}\n","import React, { useRef } from \"react\";\nimport { createDndContext, DndProvider } from \"react-dnd\";\nimport { HTML5Backend } from \"react-dnd-html5-backend\";\n\nconst RNDContext = createDndContext(HTML5Backend);\n\ninterface DragAndDropProps {\n    children: React.ReactElement | null;\n}\n\nfunction useDNDProviderElement(props: DragAndDropProps) {\n    const manager = useRef(RNDContext);\n\n    if (!props.children) {\n        throw new Error(\"No children provided to DND wrapper\");\n    }\n\n    if (manager.current.dragDropManager === undefined) {\n        throw new Error(\"No DND manager found\");\n    }\n\n    return (\n        <DndProvider manager={manager.current.dragDropManager}>\n            {props.children}\n        </DndProvider>\n    );\n}\n\nconst DragAndDrop: React.FC<DragAndDropProps> = (\n    props: DragAndDropProps\n): JSX.Element => {\n    const DNDElement = useDNDProviderElement(props);\n    return <React.Fragment>{DNDElement}</React.Fragment>;\n};\n\nexport default DragAndDrop;\n","import { Backdrop, CircularProgress, Theme } from \"@material-ui/core\";\nimport { createStyles, makeStyles } from \"@material-ui/styles\";\nimport { isLeft } from \"fp-ts/lib/Either\";\nimport { useSnackbar } from \"notistack\";\nimport React, { useState } from \"react\";\nimport { loadSong, saveSong } from \"../common/BrowserSave\";\nimport { ChordSong } from \"../common/ChordModel/ChordSong\";\n\nconst useBackdropStyles = makeStyles((theme: Theme) =>\n    createStyles({\n        backdrop: {\n            zIndex: theme.zIndex.drawer + 1,\n            color: \"#fff\",\n        },\n    })\n);\n\ninterface SongProps {\n    song: ChordSong;\n    onSongChanged?: (song: ChordSong) => void;\n}\n\ntype PropsWithoutSong<P extends SongProps> = Omit<P, keyof SongProps>;\n\nexport const withAutoSave = <P extends SongProps>(\n    OriginalComponent: React.FC<P>\n): React.FC<PropsWithoutSong<P>> => {\n    return (props: PropsWithoutSong<P>): JSX.Element => {\n        const [loadedSong, setLoadedSong] = useState<ChordSong | null>(null);\n        const { enqueueSnackbar } = useSnackbar();\n        const backdropStyles = useBackdropStyles();\n\n        const loadLastSavedSong = (): ChordSong => {\n            const loadResults = loadSong();\n\n            if (isLeft(loadResults)) {\n                const msg =\n                    \"Error loading previously auto saved song: \" +\n                    loadResults.left.message;\n                enqueueSnackbar(msg, { variant: \"error\" });\n                return new ChordSong();\n            }\n\n            if (loadResults.right === null) {\n                return new ChordSong();\n            }\n\n            enqueueSnackbar(\"Loaded last saved song\", { variant: \"success\" });\n            return loadResults.right;\n        };\n\n        const handleSongChanged = (song: ChordSong) => {\n            saveSong(song);\n        };\n\n        if (loadedSong === null) {\n            setLoadedSong(loadLastSavedSong());\n            return (\n                <Backdrop className={backdropStyles.backdrop} open>\n                    <CircularProgress />\n                </Backdrop>\n            );\n        }\n\n        // https://github.com/microsoft/TypeScript/issues/35858\n        const originalComponentProps = {\n            ...props,\n            song: loadedSong,\n            onSongChanged: handleSongChanged,\n        } as P;\n\n        return <OriginalComponent {...originalComponentProps} />;\n    };\n};\n","import React, { useState, useContext } from \"react\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\nexport interface InteractionSetter {\n    startInteraction: PlainFn;\n    endInteraction: PlainFn;\n}\n\nconst defaultSetter: InteractionSetter = {\n    startInteraction: () => {},\n    endInteraction: () => {},\n};\n\nexport const InteractionContext = React.createContext<InteractionSetter>(\n    defaultSetter\n);\n\ninterface EditingState {\n    editing: boolean;\n    startEdit: PlainFn;\n    finishEdit: PlainFn;\n}\n\nexport const useEditingState = (): EditingState => {\n    const [editing, setEditing] = useState(false);\n    const { startInteraction, endInteraction } = useContext(InteractionContext);\n\n    const startEdit = () => {\n        setEditing(true);\n        startInteraction();\n    };\n\n    const finishEdit = () => {\n        setEditing(false);\n        endInteraction();\n    };\n\n    return {\n        editing: editing,\n        startEdit: startEdit,\n        finishEdit: finishEdit,\n    };\n};\n","import { Theme } from \"@material-ui/core\";\nimport { CSSProperties } from \"@material-ui/styles\";\n\nexport const spaceClassName = \"LyricTokenSpace\";\nexport const wordClassName = \"LyricTokenWord\";\nexport const firstTokenClassName = \"FirstLyricToken\";\n\nexport const chordTargetClassName = \"ChordTarget\";\nexport const chordSymbolClassName = \"ChordSymbol\";\n\nconst highlightedSpaceStyle = (theme: Theme): CSSProperties => ({\n    backgroundColor: theme.palette.primary.main,\n});\n\nconst highlightedWordStyle = (theme: Theme): CSSProperties => ({\n    color: theme.palette.primary.main,\n});\n\nconst outlineStyle = (theme: Theme): CSSProperties => ({\n    borderStyle: \"solid\",\n    borderColor: theme.palette.primary.main,\n    borderRadius: \"0.3em\",\n    borderWidth: \"0.075em\",\n});\n\nexport interface HighlightChordLyricStyleOptions {\n    outline?: (theme: Theme) => CSSProperties;\n    customLyricClassSelector?: string;\n    customChordTargetClassSelector?: string;\n    customChordSymbolClassSelector?: string;\n}\n\nconst withCustomLyricSelector = (\n    selector: string,\n    options?: HighlightChordLyricStyleOptions\n): string => {\n    if (options?.customLyricClassSelector === undefined) {\n        return selector;\n    }\n\n    return `${selector}.${options.customLyricClassSelector}`;\n};\n\nconst withCustomChordTargetSelector = (\n    selector: string,\n    options?: HighlightChordLyricStyleOptions\n): string => {\n    if (options?.customChordTargetClassSelector === undefined) {\n        return selector;\n    }\n\n    return `${selector}.${options.customChordTargetClassSelector}`;\n};\n\nconst withCustomChordSymbolSelector = (\n    selector: string,\n    options?: HighlightChordLyricStyleOptions\n): string => {\n    if (options?.customChordSymbolClassSelector === undefined) {\n        return selector;\n    }\n\n    return `${selector}.${options.customChordSymbolClassSelector}`;\n};\n\nexport const dragOverChordLyricStyle = (\n    options?: HighlightChordLyricStyleOptions\n) => {\n    return (theme: Theme) => {\n        const highlightedSpace = highlightedSpaceStyle(theme);\n        const highlightedWord = highlightedWordStyle(theme);\n\n        const customOutlineStyles: CSSProperties | undefined =\n            options?.outline !== undefined ? options.outline(theme) : undefined;\n\n        const outline = {\n            ...outlineStyle(theme),\n            ...customOutlineStyles,\n        };\n\n        const spaceClassSelector = withCustomLyricSelector(\n            `.${spaceClassName}`,\n            options\n        );\n        const wordClassSelector = withCustomLyricSelector(\n            `.${wordClassName}`,\n            options\n        );\n\n        const chordSymbolSelector = withCustomChordSymbolSelector(\n            `.${chordSymbolClassName}`,\n            options\n        );\n\n        return {\n            root: {\n                [`& ${spaceClassSelector}`]: highlightedSpace,\n                [`& ${wordClassSelector}`]: highlightedWord,\n                [`& ${chordSymbolSelector}`]: outline,\n            },\n        };\n    };\n};\n\nexport const hoverChordLyricStyle = (\n    options?: HighlightChordLyricStyleOptions\n) => {\n    return (theme: Theme) => {\n        const highlightedSpace = highlightedSpaceStyle(theme);\n        const highlightedWord = highlightedWordStyle(theme);\n\n        const customOutlineStyles: CSSProperties | undefined =\n            options?.outline !== undefined ? options.outline(theme) : undefined;\n\n        const outline = {\n            ...outlineStyle(theme),\n            ...customOutlineStyles,\n        };\n\n        const spaceClassSelector = withCustomLyricSelector(\n            `.${spaceClassName}`,\n            options\n        );\n        const wordClassSelector = withCustomLyricSelector(\n            `.${wordClassName}`,\n            options\n        );\n        const chordTargetSelector = withCustomChordTargetSelector(\n            `.${chordTargetClassName}`,\n            options\n        );\n        const chordSymbolSelector = withCustomChordSymbolSelector(\n            `.${chordSymbolClassName}`,\n            options\n        );\n\n        return {\n            root: {\n                [`& ${chordTargetSelector}:hover ~ ${spaceClassSelector}`]: highlightedSpace,\n                [`& ${chordTargetSelector}:hover ~ * ${spaceClassSelector}`]: highlightedSpace,\n\n                [`& ${chordTargetSelector}:hover ~ ${wordClassSelector}`]: highlightedWord,\n                [`& ${chordTargetSelector}:hover ~ * ${wordClassSelector}`]: highlightedWord,\n\n                [`& ${chordTargetSelector}${chordSymbolSelector}:hover`]: outline,\n                [`& ${chordTargetSelector}:hover ${chordSymbolSelector}`]: outline,\n            },\n        };\n    };\n};\n","import { Typography, withStyles, createStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\nimport { DataTestID } from \"../../common/DataTestID\";\nimport { isWhitespace } from \"../../common/Whitespace\";\nimport {\n    spaceClassName,\n    wordClassName,\n} from \"../edit/HighlightChordLyricStyle\";\n\nexport const lyricTypographyVariant: \"h6\" = \"h6\";\n\nexport const lyricTypographyProps = {\n    variant: lyricTypographyVariant,\n    display: \"inline\" as \"inline\",\n};\n\nexport const lyricStyle = createStyles({\n    root: {\n        tabSize: 16,\n        whiteSpace: \"pre\",\n        wordSpacing: \".15em\",\n        display: \"inline-block\",\n    },\n});\n\nexport const LyricTypography = withStyles(lyricStyle)(Typography);\n\ninterface LyricProps extends DataTestID {\n    children: string;\n    className?: string;\n}\n\nconst Lyric: React.FC<LyricProps> = (props: LyricProps): JSX.Element => {\n    const customClassName = props.className ?? \"\";\n\n    const className = clsx({\n        [spaceClassName]: isWhitespace(props.children),\n        [wordClassName]: !isWhitespace(props.children),\n        [customClassName]: props.className !== undefined,\n    });\n\n    return (\n        <LyricTypography\n            {...lyricTypographyProps}\n            className={className}\n            data-testid={props[\"data-testid\"]}\n        >\n            {props.children}\n        </LyricTypography>\n    );\n};\n\nexport default Lyric;\n","import { RootRef } from \"@material-ui/core\";\nimport React from \"react\";\nimport { DropTargetMonitor, useDrop } from \"react-dnd\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\n\nexport const DNDChordType: \"chord\" = \"chord\";\n\nexport interface DNDChord {\n    type: typeof DNDChordType;\n    sourceBlockID: IDable<ChordBlock>;\n    chord: string;\n    handled: boolean;\n}\n\nexport const NewDNDChord = (\n    sourceBlockID: IDable<ChordBlock>,\n    chord: string\n): DNDChord => {\n    return {\n        type: DNDChordType,\n        sourceBlockID: sourceBlockID,\n        chord: chord,\n        handled: false,\n    };\n};\n\ninterface ClassNameable {\n    className?: string;\n}\n\ninterface ChordDroppableProps {\n    children: React.ReactElement<ClassNameable>;\n    onDropped: (newChord: string, sourceBlockID: IDable<ChordBlock>) => void;\n    hoverableClassName?: string;\n    dragOverClassName?: string;\n}\n\nconst ChordDroppable: React.FC<ChordDroppableProps> = (\n    props: ChordDroppableProps\n) => {\n    const [{ isOver }, dropRef] = useDrop<DNDChord, DNDChord, any>({\n        accept: DNDChordType,\n        drop: (droppedChord: DNDChord) => {\n            if (!droppedChord.handled) {\n                droppedChord.handled = true;\n                props.onDropped(droppedChord.chord, droppedChord.sourceBlockID);\n            }\n            return droppedChord;\n        },\n        collect: (monitor: DropTargetMonitor) => ({\n            isOver: monitor.isOver({ shallow: true }),\n        }),\n    });\n\n    let childElem: React.ReactElement<ClassNameable> = props.children;\n    const childClassName: string | undefined = isOver\n        ? props.dragOverClassName\n        : props.hoverableClassName;\n\n    if (childClassName !== undefined) {\n        childElem = React.cloneElement(childElem, {\n            className: childClassName,\n        });\n    }\n\n    return <RootRef rootRef={dropRef}>{childElem}</RootRef>;\n};\n\nexport default ChordDroppable;\n","import { Typography } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React from \"react\";\nimport { inflateIfEmpty } from \"../../common/Whitespace\";\nimport { lyricTypographyVariant } from \"./Lyric\";\n\nconst ChordTypography = withStyles({\n    root: {\n        whiteSpace: \"pre\",\n        cursor: \"pointer\",\n        fontFamily: \"PoriChord\",\n        userSelect: \"all\",\n    },\n})(Typography);\n\nexport interface ChordSymbolProps {\n    children: string;\n    className?: string;\n}\n\nconst ChordSymbol: React.FC<ChordSymbolProps> = (\n    props: ChordSymbolProps\n): JSX.Element => {\n    const formattedChord = (): string => {\n        let chord = props.children;\n        if (chord.endsWith(\" \")) {\n            return chord;\n        }\n\n        chord = chord + \" \";\n\n        return inflateIfEmpty(chord);\n    };\n\n    return (\n        <ChordTypography\n            variant={lyricTypographyVariant} // keep chords and lyrics the same size\n            display=\"inline\"\n            data-testid=\"ChordSymbol\"\n            className={props.className}\n        >\n            {formattedChord()}\n        </ChordTypography>\n    );\n};\n\nexport default ChordSymbol;\n","import { RootRef } from \"@material-ui/core\";\nimport React from \"react\";\nimport { useDrag } from \"react-dnd\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport ChordSymbol, { ChordSymbolProps } from \"../display/ChordSymbol\";\nimport { NewDNDChord } from \"./ChordDroppable\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\ninterface DraggableChordSymbolProps extends ChordSymbolProps {\n    chordBlockID: IDable<ChordBlock>;\n    onDragged?: PlainFn;\n}\n\nconst DraggableChordSymbol: React.FC<DraggableChordSymbolProps> = (\n    props: DraggableChordSymbolProps\n): JSX.Element => {\n    const [, dragRef] = useDrag({\n        item: NewDNDChord(props.chordBlockID, props.children),\n    });\n\n    return (\n        <RootRef rootRef={dragRef}>\n            <ChordSymbol className={props.className}>\n                {props.children}\n            </ChordSymbol>\n        </RootRef>\n    );\n};\n\nexport default DraggableChordSymbol;\n","import { makeStyles, Typography, TypographyVariant } from \"@material-ui/core\";\nimport grey from \"@material-ui/core/colors/grey\";\nimport { StyledComponentProps, withStyles } from \"@material-ui/styles\";\nimport React, { useEffect } from \"react\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\nconst InputTypography = withStyles({\n    root: {\n        width: \"100%\",\n        backgroundColor: grey[200],\n        whiteSpace: \"pre\",\n        display: \"inline-block\",\n    },\n})(Typography);\n\nconst useContentEditableStyle = makeStyles({\n    root: {\n        display: \"inline-block\",\n        width: \"100%\",\n        pointerEvents: \"auto\",\n        userSelect: \"text\",\n        outline: \"none\",\n        // this prevent the span height from collapsing if there's no content\n        \"&:empty:before\": {\n            content: '\"\\\\a0\"',\n        },\n    },\n});\n\ninterface TextInputProps extends StyledComponentProps {\n    children: string;\n    onFinish?: (newValue: string) => void;\n    onSpecialBackspace?: PlainFn;\n    onPasteOverflow?: (overflowContent: string[]) => void;\n    onJSONPaste?: (jsonStr: string) => boolean;\n    variant?: TypographyVariant;\n}\n\nconst TextInput: React.FC<TextInputProps> = (\n    props: TextInputProps\n): JSX.Element => {\n    const contentEditableRef: React.RefObject<HTMLSpanElement> = React.createRef();\n\n    const value = (): string => {\n        if (\n            contentEditableRef.current === null ||\n            contentEditableRef.current.textContent === null\n        ) {\n            return \"\";\n        }\n\n        return contentEditableRef.current.textContent;\n    };\n\n    const setValue = (newValue: string) => {\n        if (contentEditableRef.current === null) {\n            return;\n        }\n\n        contentEditableRef.current.textContent = newValue;\n    };\n\n    const enterHandler = (\n        event: React.KeyboardEvent<HTMLDivElement>\n    ): boolean => {\n        if (event.key !== \"Enter\") {\n            return false;\n        }\n\n        finish(value());\n        return true;\n    };\n\n    const selectionRange = (): Range | null => {\n        const selection = window.getSelection();\n        if (selection === null || selection.rangeCount === 0) {\n            return null;\n        }\n\n        return selection.getRangeAt(0);\n    };\n\n    const selectionOffsets = (): [number, number] | null => {\n        if (contentEditableRef.current === null) {\n            return null;\n        }\n\n        const node = contentEditableRef.current;\n\n        const range = selectionRange();\n        if (\n            range === null ||\n            !node.contains(range.startContainer) ||\n            !node.contains(range.endContainer)\n        ) {\n            return null;\n        }\n\n        return [range.startOffset, range.endOffset];\n    };\n\n    const specialBackspaceHandler = (\n        event: React.KeyboardEvent<HTMLDivElement>\n    ): boolean => {\n        if (!props.onSpecialBackspace) {\n            return false;\n        }\n\n        const specialBackspace: boolean =\n            event.key === \"Backspace\" && (event.metaKey || event.ctrlKey);\n        if (!specialBackspace) {\n            return false;\n        }\n\n        const offsets = selectionOffsets();\n        if (offsets === null) {\n            return false;\n        }\n\n        if (offsets[0] !== 0 || offsets[1] !== 0) {\n            return false;\n        }\n\n        props.onSpecialBackspace();\n        return true;\n    };\n\n    const splitStringBySelection = (): [string, string] => {\n        const currValue = value();\n\n        const offsets = selectionOffsets();\n        if (offsets === null) {\n            return [value(), \"\"];\n        }\n\n        const beforeSelection = currValue.slice(0, offsets[0]);\n        const afterSelection = currValue.slice(offsets[1]);\n        return [beforeSelection, afterSelection];\n    };\n\n    const insertTextAtSelection = (newContent: string): boolean => {\n        if (contentEditableRef.current === null) {\n            return false;\n        }\n\n        const range = selectionRange();\n        if (range === null) {\n            return false;\n        }\n\n        range.deleteContents();\n        range.insertNode(document.createTextNode(newContent));\n        range.collapse(false);\n        contentEditableRef.current.normalize();\n        return true;\n    };\n\n    const tabHandler = (\n        event: React.KeyboardEvent<HTMLDivElement>\n    ): boolean => {\n        if (event.key !== \"Tab\") {\n            return false;\n        }\n\n        return insertTextAtSelection(\"\\t\");\n    };\n\n    const specialStylingKeysHandler = (\n        event: React.KeyboardEvent<HTMLDivElement>\n    ): boolean => {\n        if (!event.metaKey && !event.ctrlKey) {\n            return false;\n        }\n\n        // prevent bold, underline, or italics commands\n        return (\n            event.key === \"b\" ||\n            event.key === \"B\" ||\n            event.key === \"u\" ||\n            event.key === \"U\" ||\n            event.key === \"i\" ||\n            event.key === \"I\"\n        );\n    };\n\n    const keyDownHandler = (event: React.KeyboardEvent<HTMLDivElement>) => {\n        const handlers: ((\n            event: React.KeyboardEvent<HTMLDivElement>\n        ) => boolean)[] = [\n            enterHandler,\n            specialBackspaceHandler,\n            tabHandler,\n            specialStylingKeysHandler,\n        ];\n\n        for (const handler of handlers) {\n            const handled: boolean = handler(event);\n            if (handled) {\n                event.preventDefault();\n                return;\n            }\n        }\n    };\n\n    const finish = (newValue: string) => {\n        if (props.onFinish) {\n            props.onFinish(newValue);\n        }\n    };\n\n    const blurHandler = () => {\n        finish(value());\n    };\n\n    const composeMultilinePaste = (\n        pasteContent: string[]\n    ): [string, string[]] => {\n        const [beforeSelection, afterSelection] = splitStringBySelection();\n        const newValue = beforeSelection + pasteContent[0];\n\n        const newPasteLines = pasteContent.slice(1);\n        const lastIndex = newPasteLines.length - 1;\n        newPasteLines[lastIndex] += afterSelection;\n\n        return [newValue, newPasteLines];\n    };\n\n    const handlePlainTextPaste = (\n        event: React.ClipboardEvent<HTMLDivElement>\n    ): boolean => {\n        if (props.onPasteOverflow === undefined) {\n            return false;\n        }\n\n        const payload = event.clipboardData.getData(\"text/plain\");\n\n        if (payload === \"\") {\n            return false;\n        }\n\n        // handling both Windows + Mac\n        let linesOfText: string[] = payload.split(\"\\r\\n\");\n        linesOfText = linesOfText.flatMap((line: string) => line.split(\"\\n\"));\n\n        if (linesOfText.length === 0) {\n            return false;\n        }\n\n        if (linesOfText.length === 1) {\n            return insertTextAtSelection(linesOfText[0]);\n        }\n\n        const [newValue, newPasteLines] = composeMultilinePaste(linesOfText);\n\n        setValue(newValue);\n        finish(newValue);\n        props.onPasteOverflow(newPasteLines);\n        return true;\n    };\n\n    const handleJSONPaste = (\n        event: React.ClipboardEvent<HTMLDivElement>\n    ): boolean => {\n        if (props.onJSONPaste === undefined) {\n            return false;\n        }\n\n        const payload = event.clipboardData.getData(\"application/json\");\n\n        if (payload === \"\") {\n            return false;\n        }\n\n        const handled = props.onJSONPaste(payload);\n        if (handled) {\n            finish(value());\n        }\n\n        return handled;\n    };\n\n    const handlePaste = (event: React.ClipboardEvent<HTMLDivElement>) => {\n        const handlers: ((\n            event: React.ClipboardEvent<HTMLDivElement>\n        ) => boolean)[] = [handleJSONPaste, handlePlainTextPaste];\n\n        for (const handler of handlers) {\n            const handled: boolean = handler(event);\n            if (handled) {\n                event.preventDefault();\n                return;\n            }\n        }\n    };\n\n    const focusAndPlaceCaret = () => {\n        if (contentEditableRef.current === null) {\n            return;\n        }\n\n        contentEditableRef.current.focus();\n\n        const selection = window.getSelection();\n        if (selection === null) {\n            return;\n        }\n\n        const newRange = document.createRange();\n        newRange.selectNodeContents(contentEditableRef.current);\n        newRange.collapse(false);\n\n        selection.removeAllRanges();\n        selection.addRange(newRange);\n    };\n\n    useEffect(focusAndPlaceCaret);\n\n    const contentEditableStyle = useContentEditableStyle();\n\n    return (\n        <InputTypography\n            classes={props.classes}\n            variant={props.variant}\n            display=\"inline\"\n            data-testid=\"EditableLine\"\n        >\n            <span\n                contentEditable\n                className={contentEditableStyle.root}\n                ref={contentEditableRef}\n                data-testid=\"InnerInput\"\n                onBlur={blurHandler}\n                onKeyDown={keyDownHandler}\n                onPaste={handlePaste}\n                suppressContentEditableWarning\n            >\n                {props.children}\n            </span>\n        </InputTypography>\n    );\n};\n\nexport default TextInput;\n","import { Box, StyledComponentProps, withStyles } from \"@material-ui/core\";\nimport clsx from \"clsx\";\nimport React from \"react\";\nimport Lyric, { LyricTypography, lyricTypographyProps } from \"../display/Lyric\";\nimport {\n    chordSymbolClassName,\n    chordTargetClassName,\n    firstTokenClassName,\n} from \"./HighlightChordLyricStyle\";\n\nconst InvisibleTypography = withStyles({\n    root: {\n        color: \"transparent\",\n        cursor: \"pointer\",\n        userSelect: \"none\",\n        position: \"absolute\",\n        left: 0,\n        top: 0,\n        transform: \"translate(0%, -115%)\",\n    },\n})(LyricTypography);\n\ninterface ChordTargetBoxProps extends StyledComponentProps {\n    children: string;\n    className?: string;\n    onClick?: (event: React.MouseEvent<HTMLSpanElement>) => void;\n}\n\nconst ChordTargetBox: React.FC<ChordTargetBoxProps> = (\n    props: ChordTargetBoxProps\n): JSX.Element => {\n    return (\n        <InvisibleTypography\n            {...lyricTypographyProps}\n            onClick={props.onClick}\n            classes={props.classes}\n            className={props.className}\n            data-testid=\"ChordEditButton\"\n        >\n            {props.children}\n        </InvisibleTypography>\n    );\n};\n\ninterface TokenProps {\n    children: string;\n    index: number;\n    className?: string;\n    invisibleTarget?: { onClick: ChordTargetBoxProps[\"onClick\"] };\n}\n\nconst Token: React.FC<TokenProps> = (props: TokenProps): JSX.Element => {\n    const invisibleTarget = (): JSX.Element | null => {\n        if (props.invisibleTarget === undefined) {\n            return null;\n        }\n\n        return (\n            <ChordTargetBox\n                className={clsx(chordTargetClassName, chordSymbolClassName)}\n                onClick={props.invisibleTarget.onClick}\n            >\n                {props.children}\n            </ChordTargetBox>\n        );\n    };\n\n    const lyricClassName: string | undefined =\n        props.index === 0 ? firstTokenClassName : undefined;\n\n    const lyricBlock = (\n        <Lyric className={lyricClassName} data-testid={`Token-${props.index}`}>\n            {props.children}\n        </Lyric>\n    );\n\n    return (\n        <Box\n            className={props.className}\n            key={props.index}\n            position=\"relative\"\n            display=\"inline\"\n            data-testid={`TokenBox-${props.index}`}\n        >\n            {invisibleTarget()}\n            {lyricBlock}\n        </Box>\n    );\n};\n\nexport default Token;\n","import { Box, Grid, makeStyles, Theme } from \"@material-ui/core\";\nimport red from \"@material-ui/core/colors/red\";\nimport { withStyles } from \"@material-ui/styles\";\nimport clsx from \"clsx\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport { DataTestID } from \"../../common/DataTestID\";\nimport { inflatingWhitespace } from \"../../common/Whitespace\";\nimport { lyricTypographyVariant } from \"../display/Lyric\";\nimport ChordDroppable from \"./ChordDroppable\";\nimport DraggableChordSymbol from \"./DraggableChordSymbol\";\nimport {\n    chordTargetClassName,\n    dragOverChordLyricStyle,\n    firstTokenClassName,\n    hoverChordLyricStyle,\n} from \"./HighlightChordLyricStyle\";\nimport { useEditingState } from \"./InteractionContext\";\nimport TextInput from \"./TextInput\";\nimport Token from \"./Token\";\n\nconst chordSymbolClassName = \"ChordSymbol\";\n\nconst blockChordSymbolClassName = \"BlockChordSymbol\";\nconst blockChordTargetClassName = \"BlockChordTarget\";\n\nconst ChordInput = withStyles((theme: Theme) => ({\n    root: {\n        fontFamily: \"PoriChord\",\n        borderBottom: \"solid\",\n        borderBottomColor: theme.palette.primary.main,\n        borderBottomWidth: \"2px\",\n    },\n}))(TextInput);\n\nconst useFirstTokenStyle = {\n    dragOver: makeStyles(\n        dragOverChordLyricStyle({\n            outline: (theme: Theme) => ({\n                borderColor: red[300],\n                color: red[300],\n            }),\n            customLyricClassSelector: firstTokenClassName,\n            customChordSymbolClassSelector: blockChordSymbolClassName,\n            customChordTargetClassSelector: blockChordTargetClassName,\n        })\n    ),\n    hoverable: makeStyles(\n        hoverChordLyricStyle({\n            outline: (theme: Theme) => ({\n                color: theme.palette.primary.dark,\n            }),\n            customLyricClassSelector: firstTokenClassName,\n            customChordSymbolClassSelector: blockChordSymbolClassName,\n            customChordTargetClassSelector: blockChordTargetClassName,\n        })\n    ),\n};\n\nconst useNormalTokenStyle = {\n    dragOver: makeStyles(dragOverChordLyricStyle()),\n    hoverable: makeStyles(hoverChordLyricStyle()),\n};\n\nexport interface BlockProps extends DataTestID {\n    chordBlock: ChordBlock;\n    onChordDragAndDrop?: (\n        destinationBlockID: IDable<ChordBlock>,\n        splitIndex: number,\n        newChord: string,\n        sourceBlockID: IDable<ChordBlock>\n    ) => void;\n    onChordChange?: (id: IDable<ChordBlock>, newChord: string) => void;\n    onBlockSplit?: (id: IDable<ChordBlock>, splitIndex: number) => void;\n}\n\nconst Block: React.FC<BlockProps> = (props: BlockProps): JSX.Element => {\n    const { editing, startEdit, finishEdit } = useEditingState();\n\n    let lyricTokens: string[] = props.chordBlock.lyricTokens;\n\n    if (lyricTokens.length === 0) {\n        lyricTokens = [inflatingWhitespace()];\n    }\n\n    const firstTokenStyle = {\n        hoverable: useFirstTokenStyle.hoverable(),\n        dragOver: useFirstTokenStyle.dragOver(),\n    };\n\n    const normalTokenStyle = {\n        hoverable: useNormalTokenStyle.hoverable(),\n        dragOver: useNormalTokenStyle.dragOver(),\n    };\n\n    const invisibleTargetForFirstToken: boolean =\n        props.chordBlock.chord === \"\" && !editing;\n\n    const clickHandler: (\n        tokenIndex: number\n    ) => (event: React.MouseEvent<HTMLSpanElement>) => void = (\n        tokenIndex: number\n    ) => {\n        return (event: React.MouseEvent<HTMLSpanElement>) => {\n            // block splitting happens after the first token\n            // as first token is already aligned with the current chord\n            if (tokenIndex !== 0 && props.onBlockSplit) {\n                props.onBlockSplit(props.chordBlock, tokenIndex);\n            }\n\n            startEdit();\n\n            event.stopPropagation();\n        };\n    };\n\n    const handleDragged = () => {\n        if (props.onChordChange) {\n            props.onChordChange(props.chordBlock, \"\");\n        }\n    };\n\n    const dropHandler = (tokenIndex: number) => {\n        return (newChord: string, sourceBlockID: IDable<ChordBlock>) => {\n            if (props.onChordDragAndDrop) {\n                props.onChordDragAndDrop(\n                    props.chordBlock,\n                    tokenIndex,\n                    newChord,\n                    sourceBlockID\n                );\n            }\n        };\n    };\n\n    const endEdit = (newChord: string) => {\n        if (props.onChordChange) {\n            props.onChordChange(props.chordBlock, newChord);\n        }\n\n        finishEdit();\n    };\n\n    const lyricBlock = (lyric: string, index: number): React.ReactElement => {\n        // every above lyric target above after the first should get its own highlightable outline chord target box\n        // the first one will depend if it has a chord above it.\n        // if it does not, then treat it the same as all other tokens\n        // if it does, then don't let it be highlightable, defer it to the chord row for highlighting\n        const hasInvisibleTarget = index > 0 || invisibleTargetForFirstToken;\n\n        const invisibleTargetOption = hasInvisibleTarget\n            ? {\n                  onClick: clickHandler(index),\n              }\n            : undefined;\n\n        return (\n            <ChordDroppable\n                key={index}\n                onDropped={dropHandler(index)}\n                hoverableClassName={normalTokenStyle.hoverable.root}\n                dragOverClassName={normalTokenStyle.dragOver.root}\n            >\n                <Token index={index} invisibleTarget={invisibleTargetOption}>\n                    {lyric}\n                </Token>\n            </ChordDroppable>\n        );\n    };\n\n    const lyricBlocks = lyricTokens.map((lyricToken: string, index: number) =>\n        lyricBlock(lyricToken, index)\n    );\n\n    const chordRow = (): JSX.Element => {\n        if (editing) {\n            return (\n                <Box data-testid=\"ChordEdit\">\n                    <ChordInput\n                        variant={lyricTypographyVariant}\n                        onFinish={endEdit}\n                    >\n                        {props.chordBlock.chord}\n                    </ChordInput>\n                </Box>\n            );\n        }\n\n        return (\n            <DraggableChordSymbol\n                chordBlockID={props.chordBlock}\n                onDragged={handleDragged}\n                className={clsx(\n                    chordSymbolClassName,\n                    blockChordSymbolClassName\n                )}\n            >\n                {props.chordBlock.chord}\n            </DraggableChordSymbol>\n        );\n    };\n\n    return (\n        <Box display=\"inline-block\">\n            <ChordDroppable\n                onDropped={dropHandler(0)}\n                hoverableClassName={firstTokenStyle.hoverable.root}\n                dragOverClassName={firstTokenStyle.dragOver.root}\n            >\n                <Grid\n                    container\n                    direction=\"column\"\n                    data-testid={props[\"data-testid\"]}\n                >\n                    <Grid\n                        className={clsx(\n                            chordTargetClassName,\n                            blockChordTargetClassName\n                        )}\n                        onClick={clickHandler(0)}\n                        item\n                    >\n                        {chordRow()}\n                    </Grid>\n                    <Grid item data-testid=\"Lyric\">\n                        {lyricBlocks}\n                    </Grid>\n                </Grid>\n            </ChordDroppable>\n        </Box>\n    );\n};\n\nexport default Block;\n","import {\n    Button as UnstyledButton,\n    ButtonGroup,\n    Theme,\n    Tooltip as UnstyledTooltip,\n    withStyles,\n} from \"@material-ui/core\";\nimport React from \"react\";\nimport { DataTestID } from \"../../common/DataTestID\";\n\nconst Button = withStyles((theme: Theme) => ({\n    contained: {\n        backgroundColor: \"transparent\",\n        \"&:hover\": {\n            backgroundColor: theme.palette.primary.dark,\n        },\n    },\n}))(UnstyledButton);\n\nconst Tooltip = withStyles({\n    tooltip: {\n        padding: 0,\n        background: \"transparent\",\n        margin: 0,\n    },\n})(UnstyledTooltip);\n\nexport interface MenuItem extends DataTestID {\n    icon: React.ReactElement;\n    onClick?: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n}\n\nexport interface WithHoverMenuProps {\n    children: React.ReactElement;\n    menuItems: MenuItem[];\n}\n\nconst WithHoverMenu: React.FC<WithHoverMenuProps> = (\n    props: WithHoverMenuProps\n): JSX.Element => {\n    const hoverMenu = (\n        <ButtonGroup orientation=\"vertical\" variant=\"text\">\n            {props.menuItems.map((menuItem: MenuItem, index: number) => {\n                return (\n                    <Button\n                        key={index}\n                        onClick={menuItem.onClick}\n                        data-testid={menuItem[\"data-testid\"]}\n                    >\n                        {menuItem.icon}\n                    </Button>\n                );\n            })}\n        </ButtonGroup>\n    );\n\n    return (\n        <Tooltip placement=\"right\" title={hoverMenu} interactive>\n            {props.children}\n        </Tooltip>\n    );\n};\n\nexport default WithHoverMenu;\n","import { Box, Theme, withStyles } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport { PlainFn } from \"../../common/PlainFn\";\nimport { lyricStyle, lyricTypographyVariant } from \"../display/Lyric\";\nimport { useEditingState } from \"./InteractionContext\";\nimport TextInput from \"./TextInput\";\n\nconst LyricInput = withStyles((theme: Theme) => ({\n    root: {\n        ...lyricStyle.root,\n        borderBottom: \"solid\",\n        borderBottomColor: theme.palette.secondary.main,\n        borderBottomWidth: \"2px\",\n    },\n}))(TextInput);\n\ninterface WithLyricInputProps {\n    children: (handleEdit: PlainFn) => React.ReactElement;\n    chordLine: ChordLine;\n    onChangeLine?: (id: IDable<ChordLine>) => void;\n    onPasteOverflow?: (\n        id: IDable<ChordLine>,\n        overflowPasteContent: string[]\n    ) => void;\n    onJSONPaste?: (id: IDable<ChordLine>, jsonStr: string) => boolean;\n    onMergeWithPreviousLine?: (id: IDable<ChordLine>) => boolean;\n}\n\n// this component is inherently quite coupled with Line & friends\n// however, this is a good opportunity to separate concerns and organize functionality\nconst WithLyricInput: React.FC<WithLyricInputProps> = (\n    props: WithLyricInputProps\n): JSX.Element => {\n    const { editing, startEdit, finishEdit } = useEditingState();\n\n    const handlers = {\n        lyricEdit: (newLyrics: string) => {\n            finishEdit();\n\n            props.chordLine.replaceLyrics(newLyrics);\n            props.onChangeLine?.(props.chordLine);\n        },\n        pasteOverflow: (overflowContent: string[]) => {\n            if (props.onPasteOverflow) {\n                props.onPasteOverflow(props.chordLine, overflowContent);\n                finishEdit();\n            }\n        },\n        jsonPaste: (jsonStr: string): boolean => {\n            if (props.onJSONPaste === undefined) {\n                return false;\n            }\n\n            return props.onJSONPaste(props.chordLine, jsonStr);\n        },\n        specialBackspace: () => {\n            if (props.onMergeWithPreviousLine) {\n                const handledAndStopEditing = props.onMergeWithPreviousLine(\n                    props.chordLine\n                );\n                if (handledAndStopEditing) {\n                    finishEdit();\n                }\n            }\n        },\n    };\n\n    const lineElement: React.ReactElement = props.children(startEdit);\n\n    if (!editing) {\n        return lineElement;\n    }\n\n    // using a css trick to overlay the lyrics edit input over\n    // the noneditable lyrics line so chords are still showing\n    return (\n        <>\n            {lineElement}\n            <Box position=\"absolute\" left=\"0\" bottom=\"2px\" width=\"100%\">\n                <LyricInput\n                    variant={lyricTypographyVariant}\n                    onFinish={handlers.lyricEdit}\n                    onJSONPaste={handlers.jsonPaste}\n                    onPasteOverflow={handlers.pasteOverflow}\n                    onSpecialBackspace={handlers.specialBackspace}\n                >\n                    {props.chordLine.lyrics}\n                </LyricInput>\n            </Box>\n        </>\n    );\n};\n\nexport default WithLyricInput;\n","import { createStyles } from \"@material-ui/core\";\nimport blueGrey from \"@material-ui/core/colors/blueGrey\";\n\nexport const sectionLabelStyle = createStyles({\n    root: {\n        borderColor: blueGrey[500],\n        borderStyle: \"solid\",\n        borderRadius: \"0.3em\",\n        borderWidth: \"0.075em\",\n        color: blueGrey[500],\n        display: \"inline-block\",\n    },\n});\n\nexport const sectionTypographyVariant: \"body2\" = \"body2\";\n","import { Box, Typography, TypographyProps } from \"@material-ui/core\";\nimport grey from \"@material-ui/core/colors/grey\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React, { useState } from \"react\";\nimport { DataTestID } from \"../../common/DataTestID\";\nimport { inflateIfEmpty } from \"../../common/Whitespace\";\nimport TextInput from \"./TextInput\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\nexport interface EditControl {\n    editing: boolean;\n    onStartEdit: PlainFn;\n    onEndEdit: PlainFn;\n}\n\ninterface EditableTypographyProps extends DataTestID, TypographyProps {\n    children: string;\n    // provide this if you want to provide explicit control over the editability\n    // of the field. this means the parent must manage this component's editing state\n    editControl?: EditControl;\n\n    onValueChange?: (newValue: string) => void;\n    placeholder?: string;\n}\n\nconst PlaceholderTypography = withStyles({\n    root: {\n        color: grey[400],\n    },\n})(Typography);\n\nconst EditableTypography: React.FC<EditableTypographyProps> = (\n    props: EditableTypographyProps\n): JSX.Element => {\n    const [editingState, setEditingState] = useState(false);\n\n    const editing: boolean =\n        props.editControl !== undefined\n            ? props.editControl.editing\n            : editingState;\n\n    const startEdit = () => {\n        if (props.editControl !== undefined) {\n            props.editControl.onStartEdit();\n        } else {\n            setEditingState(true);\n        }\n    };\n\n    const finishEdit = (newValue: string) => {\n        if (props.editControl !== undefined) {\n            props.editControl.onEndEdit();\n        } else {\n            setEditingState(false);\n        }\n\n        if (props.onValueChange) {\n            props.onValueChange(newValue);\n        }\n    };\n\n    const nonEditableLine = (): React.ReactElement => {\n        const {\n            children,\n            placeholder,\n            onValueChange,\n            ...typographyProps\n        } = props;\n\n        if (props.children === \"\" && props.placeholder !== undefined) {\n            return (\n                <PlaceholderTypography {...typographyProps} onClick={startEdit}>\n                    {props.placeholder}\n                </PlaceholderTypography>\n            );\n        }\n\n        return (\n            <Typography {...typographyProps} onClick={startEdit}>\n                {inflateIfEmpty(props.children)}\n            </Typography>\n        );\n    };\n\n    const editableLine = (): React.ReactElement => {\n        if (props.variant === \"inherit\" || props.variant === \"srOnly\") {\n            throw new Error(\"can't have these variant types\");\n        }\n\n        return (\n            <TextInput\n                variant={props.variant}\n                onFinish={finishEdit}\n                data-testid={\"EditableLine\"}\n            >\n                {props.children}\n            </TextInput>\n        );\n    };\n\n    const elem: React.ReactElement = editing\n        ? editableLine()\n        : nonEditableLine();\n\n    return <Box>{elem}</Box>;\n};\n\nexport default EditableTypography;\n","import { Box } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React from \"react\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport { PlainFn } from \"../../common/PlainFn\";\nimport { DataTestID } from \"../../common/DataTestID\";\nimport {\n    sectionLabelStyle,\n    sectionTypographyVariant,\n} from \"../display/SectionLabel\";\nimport UnstyledEditableTypography, { EditControl } from \"./EditableTypography\";\nimport { useEditingState } from \"./InteractionContext\";\n\nconst EditableTypography = withStyles(sectionLabelStyle)(\n    UnstyledEditableTypography\n);\n\nexport interface MenuItem extends DataTestID {\n    icon: React.ReactElement;\n    onClick?: (event: React.MouseEvent<HTMLButtonElement, MouseEvent>) => void;\n}\n\nexport interface WithSectionLabelProps {\n    chordLine: ChordLine;\n    children: (editLabel: PlainFn) => React.ReactElement;\n    onChangeLabel?: (id: IDable<ChordLine>) => void;\n}\n\nconst WithSectionLabel: React.FC<WithSectionLabelProps> = (\n    props: WithSectionLabelProps\n): JSX.Element => {\n    const { editing, startEdit, finishEdit } = useEditingState();\n\n    const editControl: EditControl = {\n        editing: editing,\n        onStartEdit: startEdit,\n        onEndEdit: finishEdit,\n    };\n\n    const handleLabelChange = (newValue: string) => {\n        const newLabel: string | undefined =\n            newValue !== \"\" ? newValue : undefined;\n\n        props.chordLine.label = newLabel;\n        props.onChangeLabel?.(props.chordLine);\n    };\n\n    const childElement: React.ReactElement = props.children(startEdit);\n\n    if (!editing && props.chordLine.label === undefined) {\n        return childElement;\n    }\n\n    const label: string = props.chordLine.label ?? \"\";\n\n    return (\n        <>\n            <Box>\n                <EditableTypography\n                    variant={sectionTypographyVariant}\n                    data-testid=\"EditLabel\"\n                    editControl={editControl}\n                    onValueChange={handleLabelChange}\n                >\n                    {label}\n                </EditableTypography>\n            </Box>\n            {childElement}\n        </>\n    );\n};\n\nexport default WithSectionLabel;\n","import { Box, Slide, withStyles } from \"@material-ui/core\";\nimport grey from \"@material-ui/core/colors/grey\";\nimport red from \"@material-ui/core/colors/red\";\nimport UnstyledBackspaceIcon from \"@material-ui/icons/Backspace\";\nimport ChatBubbleIcon from \"@material-ui/icons/ChatBubbleOutline\";\nimport React, { useState } from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport { PlainFn } from \"../../common/PlainFn\";\nimport { DataTestID } from \"../../common/DataTestID\";\nimport Block, { BlockProps } from \"./Block\";\nimport WithHoverMenu, { MenuItem } from \"./WithHoverMenu\";\nimport WithLyricInput from \"./WithLyricInput\";\nimport WithSectionLabel from \"./WithSectionLabel\";\n\nconst AtomicSelectionBox = withStyles({\n    root: {\n        userSelect: \"all\",\n    },\n})(Box);\n\nconst BackspaceIcon = withStyles({\n    root: {\n        color: red[300],\n    },\n})(UnstyledBackspaceIcon);\n\nconst HighlightableBox = withStyles({\n    root: {\n        \"&:hover\": {\n            backgroundColor: grey[100],\n        },\n    },\n})(Box);\n\ninterface LineProps extends DataTestID {\n    chordLine: ChordLine;\n    \"data-lineid\": string;\n    onChangeLine?: (id: IDable<ChordLine>) => void;\n    onRemoveLine?: (id: IDable<ChordLine>) => void;\n    onPasteOverflow?: (\n        id: IDable<ChordLine>,\n        overflowPasteContent: string[]\n    ) => void;\n    onJSONPaste?: (id: IDable<ChordLine>, jsonStr: string) => boolean;\n    onMergeWithPreviousLine?: (id: IDable<ChordLine>) => boolean;\n    onChordDragAndDrop?: BlockProps[\"onChordDragAndDrop\"];\n}\n\nconst Line: React.FC<LineProps> = (props: LineProps): JSX.Element => {\n    const [removed, setRemoved] = useState(false);\n    const removalTime = 250;\n\n    const handlers = {\n        chordChange: (id: IDable<ChordBlock>, newChord: string) => {\n            props.chordLine.setChord(id, newChord);\n            props.onChangeLine?.(props.chordLine);\n        },\n        blockSplit: (id: IDable<ChordBlock>, splitIndex: number) => {\n            props.chordLine.splitBlock(id, splitIndex);\n            props.onChangeLine?.(props.chordLine);\n        },\n        remove: () => {\n            if (removed) {\n                return;\n            }\n\n            setRemoved(true);\n\n            if (props.onRemoveLine) {\n                setTimeout(() => {\n                    if (props.onRemoveLine) {\n                        props.onRemoveLine(props.chordLine);\n                    }\n                }, removalTime);\n            }\n        },\n    };\n\n    let chordBlocks: ChordBlock[] = props.chordLine.chordBlocks;\n    if (chordBlocks.length === 0) {\n        chordBlocks = [\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"\",\n            }),\n        ];\n    }\n\n    const blocks: React.ReactElement[] = chordBlocks.map(\n        (chordBlock: ChordBlock, index: number) => (\n            <Block\n                key={chordBlock.id}\n                chordBlock={chordBlock}\n                onChordDragAndDrop={props.onChordDragAndDrop}\n                onChordChange={handlers.chordChange}\n                onBlockSplit={handlers.blockSplit}\n                data-testid={`Block-${index}`}\n            ></Block>\n        )\n    );\n\n    const basicLine = (startEdit: PlainFn) => (\n        <HighlightableBox data-testid={\"NoneditableLine\"} onClick={startEdit}>\n            {blocks}\n        </HighlightableBox>\n    );\n\n    const withHoverMenu = (startEdit: PlainFn, menuItems: MenuItem[]) => (\n        <WithHoverMenu menuItems={menuItems}>\n            {basicLine(startEdit)}\n        </WithHoverMenu>\n    );\n\n    const withLyricInput = (menuItems: MenuItem[]) => (\n        <WithLyricInput\n            chordLine={props.chordLine}\n            onChangeLine={props.onChangeLine}\n            onJSONPaste={props.onJSONPaste}\n            onMergeWithPreviousLine={props.onMergeWithPreviousLine}\n            onPasteOverflow={props.onPasteOverflow}\n        >\n            {(startEdit: PlainFn) => withHoverMenu(startEdit, menuItems)}\n        </WithLyricInput>\n    );\n\n    const withSectionLabel = (\n        <WithSectionLabel\n            chordLine={props.chordLine}\n            onChangeLabel={props.onChangeLine}\n        >\n            {(editLabel: PlainFn) => {\n                const menuItems: MenuItem[] = [\n                    {\n                        onClick: editLabel,\n                        icon: <ChatBubbleIcon />,\n                        \"data-testid\": \"EditLabel\",\n                    },\n                    {\n                        onClick: handlers.remove,\n                        icon: <BackspaceIcon />,\n                        \"data-testid\": \"RemoveButton\",\n                    },\n                ];\n\n                return withLyricInput(menuItems);\n            }}\n        </WithSectionLabel>\n    );\n\n    const lineContent: React.ReactElement = withSectionLabel;\n    const yeetDirection = removed ? \"up\" : \"down\";\n\n    return (\n        <Slide direction={yeetDirection} in={!removed} timeout={removalTime}>\n            <AtomicSelectionBox>\n                <Box\n                    borderBottom={1}\n                    width=\"100%\"\n                    position=\"relative\"\n                    data-lineid={props[\"data-lineid\"]}\n                    data-testid={props[\"data-testid\"]}\n                >\n                    {lineContent}\n                </Box>\n            </AtomicSelectionBox>\n        </Slide>\n    );\n};\n\nexport default Line;\n","import {\n    Button,\n    Divider as UnstyledDivider,\n    Grid,\n    Theme,\n    Tooltip as UnstyledTooltip,\n} from \"@material-ui/core\";\nimport UnstyledAddCircleOutlineIcon from \"@material-ui/icons/AddCircleOutline\";\nimport { useTheme, withStyles } from \"@material-ui/styles\";\nimport React from \"react\";\nimport { DataTestID } from \"../../common/DataTestID\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\nconst HighlightableGrid = withStyles({\n    root: {\n        \"&:hover .MuiDivider-root\": {\n            backgroundColor: \"rgba(0, 0, 0, 0.25)\",\n        },\n    },\n})(Grid);\n\nconst Tooltip = withStyles({\n    tooltip: {\n        padding: 0,\n        background: \"transparent\",\n        margin: 0,\n    },\n})(UnstyledTooltip);\n\nconst Divider = withStyles({\n    root: {\n        width: \"100%\",\n        backgroundColor: \"transparent\",\n    },\n})(UnstyledDivider);\n\nconst AddCircleOutlineIcon = withStyles((theme: Theme) => ({\n    root: {\n        color: theme.palette.secondary.light,\n    },\n}))(UnstyledAddCircleOutlineIcon);\n\ninterface NewLineProps extends DataTestID {\n    onAdd?: PlainFn;\n}\n\nconst NewLine: React.FC<NewLineProps> = (props: NewLineProps): JSX.Element => {\n    const theme: Theme = useTheme();\n\n    const hoverMenu = (): React.ReactElement => {\n        return (\n            <Button data-testid={\"AddButton\"} onClick={props.onAdd}>\n                <AddCircleOutlineIcon />\n            </Button>\n        );\n    };\n\n    return (\n        <Tooltip title={hoverMenu()} interactive placement=\"right\">\n            <HighlightableGrid\n                container\n                direction=\"column\"\n                justify=\"center\"\n                onClick={props.onAdd}\n                data-testid={props[\"data-testid\"]}\n                style={{\n                    minHeight: theme.spacing(3),\n                }}\n            >\n                <Divider />\n            </HighlightableGrid>\n        </Tooltip>\n    );\n};\n\nexport default NewLine;\n","import {\n    Grid,\n    makeStyles,\n    Paper as UnstyledPaper,\n    withStyles,\n} from \"@material-ui/core\";\nimport React, { useState } from \"react\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { IDable } from \"../../common/ChordModel/Collection\";\nimport { useLineCopyHandler, useLinePasteHandler } from \"./CopyAndPaste\";\nimport DragAndDrop from \"./DragAndDrop\";\nimport { InteractionContext, InteractionSetter } from \"./InteractionContext\";\nimport Line from \"./Line\";\nimport NewLine from \"./NewLine\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\n\nconst useUninteractiveStyle = makeStyles({\n    root: {\n        pointerEvents: \"none\",\n    },\n});\n\nconst Paper = withStyles({\n    root: {\n        width: \"auto\",\n    },\n})(UnstyledPaper);\n\ninterface ChordPaperBodyProps {\n    song: ChordSong;\n    onSongChanged?: (updatedSong: ChordSong) => void;\n}\n\nconst ChordPaperBody: React.FC<ChordPaperBodyProps> = (\n    props: ChordPaperBodyProps\n): React.ReactElement => {\n    const [interacting, setInteracting] = useState(false);\n    const handleCopy = useLineCopyHandler(props.song);\n    const handleLinePaste = useLinePasteHandler(props.song);\n\n    const interactionContextValue: InteractionSetter = {\n        startInteraction: () => {\n            setTimeout(() => {\n                setInteracting(true);\n            });\n        },\n        endInteraction: () => {\n            setTimeout(() => {\n                setInteracting(false);\n            });\n        },\n    };\n\n    const uninteractiveStyle = useUninteractiveStyle();\n\n    const handleAddLineToTop = () => {\n        const newLine: ChordLine = new ChordLine();\n        props.song.addBeginning(newLine);\n        notifySongChanged();\n    };\n\n    const handleAddLine = (id: IDable<ChordLine>) => {\n        const newLine: ChordLine = new ChordLine();\n        props.song.addAfter(id, newLine);\n        notifySongChanged();\n    };\n\n    const handleRemoveLine = (id: IDable<ChordLine>) => {\n        props.song.remove(id);\n        notifySongChanged();\n    };\n\n    const handleChangeLine = (id: IDable<ChordLine>) => {\n        notifySongChanged();\n    };\n\n    const handlePasteOverflow = (\n        id: IDable<ChordLine>,\n        overflowContent: string[]\n    ) => {\n        const newChordLines = overflowContent.map((newLyricLine: string) =>\n            ChordLine.fromLyrics(newLyricLine)\n        );\n        props.song.addAfter(id, ...newChordLines);\n        notifySongChanged();\n    };\n\n    const handleJSONPaste = (\n        id: IDable<ChordLine>,\n        jsonStr: string\n    ): boolean => {\n        const handled = handleLinePaste(id, jsonStr);\n        if (!handled) {\n            return false;\n        }\n\n        notifySongChanged();\n        return true;\n    };\n\n    const mergeWithPreviousLine = (id: IDable<ChordLine>): boolean => {\n        const didMerge = props.song.mergeLineWithPrevious(id);\n\n        if (didMerge) {\n            notifySongChanged();\n            return true;\n        }\n\n        return false;\n    };\n\n    const notifySongChanged = () => {\n        if (props.onSongChanged) {\n            props.onSongChanged(props.song);\n        }\n    };\n\n    const handleChordDND = (\n        destinationBlockID: IDable<ChordBlock>,\n        splitIndex: number,\n        newChord: string,\n        sourceBlockID: IDable<ChordBlock>\n    ) => {\n        // clearing the source block first allows handling of when the chord\n        // is dropped onto another token in the same block without special cases\n        const [sourceLine, sourceBlock] = props.song.findLineAndBlock(\n            sourceBlockID\n        );\n        sourceBlock.chord = \"\";\n\n        const [destinationLine, destinationBlock] = props.song.findLineAndBlock(\n            destinationBlockID\n        );\n        if (splitIndex !== 0) {\n            destinationLine.splitBlock(destinationBlockID, splitIndex);\n        }\n\n        destinationBlock.chord = newChord;\n\n        sourceLine.normalizeBlocks();\n        destinationLine.normalizeBlocks();\n\n        notifySongChanged();\n    };\n\n    const lines = () => {\n        const lines = props.song.chordLines.flatMap(\n            (line: ChordLine, index: number) => {\n                const addLineBelow = () => {\n                    handleAddLine(line);\n                };\n\n                return [\n                    <Line\n                        key={line.id}\n                        chordLine={line}\n                        data-lineid={line.id}\n                        onRemoveLine={handleRemoveLine}\n                        onChangeLine={handleChangeLine}\n                        onJSONPaste={handleJSONPaste}\n                        onPasteOverflow={handlePasteOverflow}\n                        onMergeWithPreviousLine={mergeWithPreviousLine}\n                        onChordDragAndDrop={handleChordDND}\n                        data-testid={`Line-${index}`}\n                    />,\n                    <NewLine\n                        key={\"NewLine-\" + line.id}\n                        onAdd={addLineBelow}\n                        data-testid={`NewLine-${index}`}\n                    />,\n                ];\n            }\n        );\n\n        const firstNewLine = (\n            <NewLine\n                key={\"NewLine-Top\"}\n                onAdd={handleAddLineToTop}\n                data-testid={\"NewLine-Top\"}\n            />\n        );\n        lines.splice(0, 0, firstNewLine);\n\n        return lines;\n    };\n\n    // prevent other interactions if currently interacting\n    const allowInteraction: boolean = !interacting;\n    const paperClassName = allowInteraction\n        ? undefined\n        : uninteractiveStyle.root;\n\n    return (\n        <DragAndDrop>\n            <InteractionContext.Provider value={interactionContextValue}>\n                <Paper\n                    onCopy={allowInteraction ? handleCopy : undefined}\n                    className={paperClassName}\n                    elevation={0}\n                >\n                    <Grid container justify=\"center\">\n                        <Grid item xs={10}>\n                            {lines()}\n                        </Grid>\n                    </Grid>\n                </Paper>\n            </InteractionContext.Provider>\n        </DragAndDrop>\n    );\n};\n\nexport default ChordPaperBody;\n","import {\n    Badge as UnstyledBadge,\n    Paper,\n    Theme,\n    withStyles,\n} from \"@material-ui/core\";\nimport UnstyledCheckCircleIcon from \"@material-ui/icons/CheckCircle\";\nimport React, { useState } from \"react\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport ChordPaperBody from \"../edit/ChordPaperBody\";\n\nconst CheckCircleIcon = withStyles((theme: Theme) => ({\n    root: {\n        color: theme.palette.success.main,\n    },\n}))(UnstyledCheckCircleIcon);\n\nconst Badge = withStyles({\n    root: {\n        display: \"inherit\",\n    },\n})(UnstyledBadge);\n\ninterface PlaygroundProps {\n    initialSong: ChordSong;\n    expectedSong?: ChordSong;\n}\n\nconst Playground: React.FC<PlaygroundProps> = (\n    props: PlaygroundProps\n): JSX.Element => {\n    const [song, setSong] = useState<ChordSong>(props.initialSong);\n    const [finish, setFinish] = useState(false);\n\n    const songChangeHandler = (updatedSong: ChordSong) => {\n        setSong(updatedSong.clone());\n        checkExpected(updatedSong);\n    };\n\n    const checkExpected = (updatedSong: ChordSong) => {\n        // don't undo the green check if it's already been passing\n        if (finish) {\n            return;\n        }\n\n        if (\n            props.expectedSong !== undefined &&\n            props.expectedSong.contentEquals(updatedSong)\n        ) {\n            setFinish(true);\n        }\n    };\n\n    return (\n        <Badge badgeContent={<CheckCircleIcon />} invisible={!finish}>\n            <Paper elevation={1}>\n                <ChordPaperBody song={song} onSongChanged={songChangeHandler} />\n            </Paper>\n        </Badge>\n    );\n};\n\nexport default Playground;\n","import { Either, isLeft, left, parseJSON, right } from \"fp-ts/lib/Either\";\nimport * as iots from \"io-ts\";\nimport lodash from \"lodash\";\nimport { ChordBlock } from \"./ChordBlock\";\nimport {\n    ChordLine,\n    ChordLineValidatedFields,\n    ChordLineValidator,\n} from \"./ChordLine\";\nimport { Collection, IDable } from \"./Collection\";\n\nconst SongMetadataValidator = iots.type({\n    title: iots.string,\n    composedBy: iots.string,\n    performedBy: iots.string,\n    asHeardFrom: iots.string,\n});\n\ntype SongMetadata = iots.TypeOf<typeof SongMetadataValidator>;\n\nconst ChordSongValidator = iots.type({\n    elements: iots.array(ChordLineValidator),\n    metadata: SongMetadataValidator,\n});\ntype ChordSongValidatedFields = iots.TypeOf<typeof ChordSongValidator>;\n\nexport class ChordSong extends Collection<ChordLine> {\n    metadata: SongMetadata;\n\n    constructor(elements?: ChordLine[], metadata?: SongMetadata) {\n        if (elements === undefined) {\n            elements = [new ChordLine()];\n        }\n\n        super(elements);\n\n        if (metadata !== undefined) {\n            this.metadata = metadata;\n        } else {\n            this.metadata = {\n                title: \"\",\n                composedBy: \"\",\n                performedBy: \"\",\n                asHeardFrom: \"\",\n            };\n        }\n    }\n\n    static fromValidatedFields(\n        validatedFields: ChordSongValidatedFields\n    ): ChordSong {\n        const chordLines: ChordLine[] = validatedFields.elements.map(\n            (chordLineValidatedFields: ChordLineValidatedFields) => {\n                return ChordLine.fromValidatedFields(chordLineValidatedFields);\n            }\n        );\n        return new ChordSong(chordLines, validatedFields.metadata);\n    }\n\n    static deserialize(jsonStr: string): Either<Error, ChordSong> {\n        const result: Either<Error, unknown> = parseJSON(\n            jsonStr,\n            () => new Error(\"Failed to parse json string\")\n        );\n\n        if (isLeft(result)) {\n            return result;\n        }\n\n        const jsonObj = result.right;\n        const validationResult = ChordSongValidator.decode(jsonObj);\n\n        if (isLeft(validationResult)) {\n            return left(new Error(\"Invalid Chord Song object\"));\n        }\n\n        return right(this.fromValidatedFields(validationResult.right));\n    }\n\n    static fromLyricsLines(lyricLines: string[]): ChordSong {\n        const chordLines: ChordLine[] = lyricLines.map((lyricLine: string) =>\n            ChordLine.fromLyrics(lyricLine)\n        );\n        return new ChordSong(chordLines);\n    }\n\n    get chordLines(): ChordLine[] {\n        return this.elements;\n    }\n\n    get title(): string {\n        return this.metadata.title;\n    }\n\n    set title(newTitle: string) {\n        this.metadata.title = newTitle;\n    }\n\n    get performedBy(): string {\n        return this.metadata.performedBy;\n    }\n\n    set performedBy(newPerformedBy: string) {\n        this.metadata.performedBy = newPerformedBy;\n    }\n\n    get composedBy(): string {\n        return this.metadata.composedBy;\n    }\n\n    set composedBy(newComposedBy: string) {\n        this.metadata.composedBy = newComposedBy;\n    }\n\n    get asHeardFrom(): string {\n        return this.metadata.asHeardFrom;\n    }\n\n    set asHeardFrom(newAsHeardFrom: string) {\n        this.metadata.asHeardFrom = newAsHeardFrom;\n    }\n\n    clone(): ChordSong {\n        return new ChordSong(this.elements, this.metadata);\n    }\n\n    toJSON(): object {\n        return this;\n    }\n\n    mergeLineWithPrevious(idable: IDable<ChordLine>): boolean {\n        const index = this.indexOf(idable.id);\n        // no previous line to merge with, just bail\n        if (index === 0) {\n            return false;\n        }\n\n        // the user experience usually would like a space between lines when they're merged\n        // e.g.\n        // Never Gonna\n        // Give You Up\n        // =>\n        // Never GonnaGive You Up is awkward\n        const prevLine = this.chordLines[index - 1];\n        const lastBlockIndex = prevLine.chordBlocks.length - 1;\n        prevLine.chordBlocks[lastBlockIndex].lyric += \" \";\n\n        const currLine = this.chordLines[index];\n        prevLine.chordBlocks.push(...currLine.chordBlocks);\n        prevLine.normalizeBlocks();\n\n        this.chordLines.splice(index, 1);\n\n        return true;\n    }\n\n    contentEquals(other: ChordSong): boolean {\n        if (this.chordLines.length !== other.chordLines.length) {\n            return false;\n        }\n\n        if (!lodash.isEqual(this.metadata, other.metadata)) {\n            return false;\n        }\n\n        const reducer = (\n            isEqual: boolean,\n            value: ChordLine,\n            index: number\n        ): boolean => {\n            if (!isEqual) {\n                return false;\n            }\n\n            const otherLine = other.chordLines[index];\n            if (!value.contentEquals(otherLine)) {\n                return false;\n            }\n\n            return true;\n        };\n\n        return this.chordLines.reduce(reducer, true);\n    }\n\n    findLineAndBlock(blockID: IDable<ChordBlock>): [ChordLine, ChordBlock] {\n        for (const line of this.chordLines) {\n            const block: ChordBlock | undefined = line.chordBlocks.find(\n                (block: ChordBlock) => block.id === blockID.id\n            );\n            if (block !== undefined) {\n                return [line, block];\n            }\n        }\n\n        throw new Error(\"BlockID can't be found in the entire song\");\n    }\n}\n","import { Theme, Typography } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React from \"react\";\nimport { inflatingWhitespace } from \"../../common/Whitespace\";\nexport const LyricsTypography = withStyles((theme: Theme) => ({\n    root: {\n        color: theme.palette.secondary.light,\n    },\n}))(Typography);\n\nexport const ChordTypography = withStyles((theme: Theme) => ({\n    root: {\n        color: theme.palette.primary.main,\n    },\n}))(Typography);\n\nexport const LineBreak = () => {\n    return <Typography>{inflatingWhitespace()}</Typography>;\n};\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { LineBreak } from \"./Common\";\n\nconst Header = () => {\n    return <Typography variant=\"h5\">Learning Chord Paper</Typography>;\n};\n\nconst Preamble = () => {\n    return (\n        <>\n            <Typography>\n                Chord Paper aims to be as intuitive and handy as possible, but\n                there could still be features that aren't obvious as we work out\n                the kinks. Let's walk through the basics together by making some\n                changes to chords and lyrics!\n            </Typography>\n            <LineBreak />\n            <Typography>\n                Since Chord Paper is still in early stages, some of these could\n                change in the future.\n            </Typography>\n        </>\n    );\n};\n\nconst Starting: React.FC<{}> = (): JSX.Element => {\n    return (\n        <>\n            <Header />\n            <LineBreak />\n            <Preamble />\n        </>\n    );\n};\n\nexport default Starting;\n","import { Fab as UnstyledFab, Paper, Theme } from \"@material-ui/core\";\nimport UnstyledPlayArrowIcon from \"@material-ui/icons/PlayArrow\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React from \"react\";\nimport { Link, Route } from \"react-router-dom\";\nimport ErrorPage from \"./edit/ErrorPage\";\nimport AddChord from \"./tutorial/AddChord\";\nimport AddLine from \"./tutorial/AddLine\";\nimport ChordPositioning from \"./tutorial/ChordPositioning\";\nimport CopyAndPaste from \"./tutorial/CopyAndPaste\";\nimport DragAndDropChord from \"./tutorial/DragAndDropChord\";\nimport EditChord from \"./tutorial/EditChord\";\nimport EditLyrics from \"./tutorial/EditLyrics\";\nimport Instrumental from \"./tutorial/Instrumental\";\nimport MergeLine from \"./tutorial/MergeLine\";\nimport PasteLyrics from \"./tutorial/PasteLyrics\";\nimport RemoveChord from \"./tutorial/RemoveChord\";\nimport RemoveLine from \"./tutorial/RemoveLine\";\nimport Starting from \"./tutorial/Start\";\n\ntype ExerciseEntry = {\n    title: string;\n    route: string;\n    component: React.FC<{}>;\n};\n\nexport type ExerciseRoute = {\n    title: string;\n    route: string;\n};\n\nconst allExercises: ExerciseEntry[] = [\n    {\n        title: \"Starting\",\n        route: \"/learn/start\",\n        component: Starting,\n    },\n    {\n        title: \"Edit a Chord\",\n        route: \"/learn/edit_chord\",\n        component: EditChord,\n    },\n    {\n        title: \"Remove a Chord\",\n        route: \"/learn/remove_chord\",\n        component: RemoveChord,\n    },\n    {\n        title: \"Add a Chord\",\n        route: \"/learn/add_chord\",\n        component: AddChord,\n    },\n    {\n        title: \"Drag and Drop Chords\",\n        route: \"/learn/drag_and_drop_chord\",\n        component: DragAndDropChord,\n    },\n    {\n        title: \"Edit Lyrics\",\n        route: \"/learn/edit_lyrics\",\n        component: EditLyrics,\n    },\n    {\n        title: \"Instrumentals\",\n        route: \"/learn/instrumentals\",\n        component: Instrumental,\n    },\n    {\n        title: \"Chord Positioning\",\n        route: \"/learn/chord_positioning\",\n        component: ChordPositioning,\n    },\n    {\n        title: \"Adding New Line\",\n        route: \"/learn/add_line\",\n        component: AddLine,\n    },\n    {\n        title: \"Removing a Line\",\n        route: \"/learn/remove_line\",\n        component: RemoveLine,\n    },\n    {\n        title: \"Pasting Lyrics\",\n        route: \"/learn/paste_lyrics\",\n        component: PasteLyrics,\n    },\n    {\n        title: \"Merging Lines\",\n        route: \"/learn/merge_lines\",\n        component: MergeLine,\n    },\n    {\n        title: \"Copying and Pasting Lines\",\n        route: \"/learn/copy_and_paste\",\n        component: CopyAndPaste,\n    },\n];\n\nexport const allExerciseRoutes = (): ExerciseRoute[] => {\n    return allExercises.map((entry: ExerciseEntry) => ({\n        title: entry.title,\n        route: entry.route,\n    }));\n};\n\nconst PlayArrowIcon = withStyles({\n    root: {\n        color: \"white\",\n    },\n})(UnstyledPlayArrowIcon);\n\nconst RootPaper = withStyles((theme: Theme) => ({\n    root: {\n        marginTop: theme.spacing(5),\n        marginBottom: theme.spacing(5),\n        padding: theme.spacing(5),\n        minHeight: theme.spacing(46),\n        width: theme.spacing(92),\n        position: \"relative\",\n    },\n}))(Paper);\n\nconst Fab = withStyles((theme: Theme) => ({\n    root: {\n        position: \"absolute\",\n        bottom: theme.spacing(2),\n        right: theme.spacing(2),\n    },\n}))(UnstyledFab);\n\ninterface TutorialProps {\n    route: string;\n}\n\nexport const TutorialSwitches = (): React.ReactElement[] => {\n    return allExercises.map((exerciseEntry: ExerciseEntry) => (\n        <Route key={exerciseEntry.route} exact path={exerciseEntry.route}>\n            <Tutorial route={exerciseEntry.route} />\n        </Route>\n    ));\n};\n\nconst Tutorial: React.FC<TutorialProps> = (\n    props: TutorialProps\n): JSX.Element => {\n    const matchEntry = (entry: ExerciseEntry): boolean => {\n        return entry.route === props.route;\n    };\n\n    const exerciseEntry: ExerciseEntry | undefined = allExercises.find(\n        matchEntry\n    );\n\n    if (exerciseEntry === undefined) {\n        return <ErrorPage />;\n    }\n\n    const exerciseIndex = allExercises.findIndex(matchEntry);\n\n    let nextButton: React.ReactElement | null = null;\n\n    if (exerciseIndex < allExercises.length - 1) {\n        const nextExercise = allExercises[exerciseIndex + 1];\n        nextButton = (\n            <Link to={nextExercise.route}>\n                <Fab color=\"primary\">\n                    <PlayArrowIcon />\n                </Fab>\n            </Link>\n        );\n    }\n\n    return (\n        <RootPaper>\n            <exerciseEntry.component />\n            {nextButton}\n        </RootPaper>\n    );\n};\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { ChordTypography, LineBreak, LyricsTypography } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst EditChord: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly \" }),\n            new ChordBlock({ chord: \"Bm\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Editing Chords</Typography>\n            <LineBreak />\n            <Typography>\n                Click on a chord to change it, then press enter to commit your\n                changes. Let's change the chord above{\" \"}\n                <LyricsTypography display=\"inline\">appear</LyricsTypography>{\" \"}\n                from <ChordTypography display=\"inline\">Bm</ChordTypography> to{\" \"}\n                <ChordTypography display=\"inline\">B7</ChordTypography>.\n            </Typography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default EditChord;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { ChordTypography, LineBreak } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst RemoveChord: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({\n                chord: \"C^\",\n                lyric: \"Why do birds suddenly appear?\",\n            }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Removing Chords</Typography>\n            <LineBreak />\n            <Typography>\n                Simply remove all the chord text when editing to clear the\n                chord. Let's remove the{\" \"}\n                <ChordTypography display=\"inline\">B7</ChordTypography>.\n            </Typography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default RemoveChord;\n","import React from \"react\";\nimport { Typography } from \"@material-ui/core\";\nimport Playground from \"./Playground\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { LineBreak, LyricsTypography, ChordTypography } from \"./Common\";\n\nconst AddChord: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({\n                chord: \"C^\",\n                lyric: \"Why do birds suddenly appear?\",\n            }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({\n                chord: \"C^\",\n                lyric: \"Why do birds suddenly \",\n            }),\n            new ChordBlock({ chord: \"B7\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Adding Chords</Typography>\n            <LineBreak />\n            <Typography>\n                Add a chord by hovering above a word, and clicking the outlined\n                box. Let's add{\" \"}\n                <ChordTypography display=\"inline\">B7</ChordTypography> back\n                above{\" \"}\n                <LyricsTypography display=\"inline\">appear</LyricsTypography>.\n            </Typography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default AddChord;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { ChordTypography, LineBreak, LyricsTypography } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst DragAndDropChord: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"suddenly appear?\" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Dragging and Dropping Chords</Typography>\n            <LineBreak />\n            <Typography>\n                It's also possible to drag and drop chords onto different parts\n                of the line when its initial placement wasn't quite correct.\n                Just drag a chord and drop it to the space above or on another\n                lyric.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                Let's move the{\" \"}\n                <ChordTypography display=\"inline\">B7</ChordTypography> above{\" \"}\n                <LyricsTypography display=\"inline\">suddenly</LyricsTypography>{\" \"}\n                to above{\" \"}\n                <LyricsTypography display=\"inline\">appear</LyricsTypography>.\n            </Typography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default DragAndDropChord;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { LineBreak, LyricsTypography } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst EditLyrics: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({\n                chord: \"C^\",\n                lyric: \"Why oh why do birds suddenly \",\n            }),\n            new ChordBlock({ chord: \"B7\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Editing Lyrics</Typography>\n            <LineBreak />\n            <Typography>\n                You can edit the lyrics by clicking anywhere along the lyrics.\n                Finish editing lyrics by pressing enter or clicking outside the\n                text edit box. Chord Paper will move chords along with lyrics\n                when you edit them. Let's change the lyrics to:\n            </Typography>\n            <LyricsTypography>\n                Why oh why do birds suddenly appear?\n            </LyricsTypography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default EditLyrics;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { LineBreak, LyricsTypography, ChordTypography } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst Instrumental: React.FC<{}> = (): JSX.Element => {\n    const tabExample = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"|\" }),\n            new ChordBlock({ chord: \"Bm\", lyric: \"\\t\" }),\n            new ChordBlock({ chord: \"A\", lyric: \"\\t|\" }),\n            new ChordBlock({ chord: \"E\", lyric: \"\\t\" }),\n            new ChordBlock({ chord: \"C#m7\", lyric: \"\\t|\" }),\n        ]),\n    ]);\n\n    const initialSong = new ChordSong();\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"|\" }),\n            new ChordBlock({ chord: \"Bm\", lyric: \"\\t\" }),\n            new ChordBlock({ chord: \"A\", lyric: \"\\t|\" }),\n            new ChordBlock({ chord: \"E\", lyric: \"\\t\" }),\n            new ChordBlock({ chord: \"C#m7\", lyric: \"\\t|\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Instrumental Sections</Typography>\n            <LineBreak />\n            <Typography>\n                One way to annotate chords that do not happen over lyrics is\n                using whitespace - notably{\" \"}\n                <LyricsTypography display=\"inline\">tab</LyricsTypography> or{\" \"}\n                <LyricsTypography display=\"inline\">space</LyricsTypography>.\n                Both will provide an empty lyric space to anchor chords to and\n                you should use either to get the formatting that you want.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                Tabs are good for providing a large width for long instrumental\n                sections. You can insert a{\" \"}\n                <LyricsTypography display=\"inline\">tab</LyricsTypography>{\" \"}\n                character by pressing tab when editing lyrics.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                This example demonstrates using tabs and the | (pipe) character\n                for annotating and organizing chords without lyrics.\n            </Typography>\n            <Playground initialSong={tabExample} />\n            <LineBreak />\n            <Typography>\n                Let's replicate the example from above using just the{\" \"}\n                <LyricsTypography display=\"inline\">tab</LyricsTypography> and{\" \"}\n                <LyricsTypography display=\"inline\">|</LyricsTypography>{\" \"}\n                characters. Insert 4 tabs by editing the lyrics, and pressing\n                tab 4 times. Then divide them with{\" \"}\n                <LyricsTypography display=\"inline\">|</LyricsTypography>, and add{\" \"}\n                <ChordTypography display=\"inline\">Bm</ChordTypography>,{\" \"}\n                <ChordTypography display=\"inline\">A</ChordTypography>,{\" \"}\n                <ChordTypography display=\"inline\">E</ChordTypography>,{\" \"}\n                <ChordTypography display=\"inline\">C#m7</ChordTypography>{\" \"}\n                respectively to each tab.\n            </Typography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default Instrumental;\n","import React from \"react\";\nimport { Typography } from \"@material-ui/core\";\nimport Playground from \"./Playground\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { LineBreak, LyricsTypography, ChordTypography } from \"./Common\";\n\nconst ChordPositioning: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly \" }),\n            new ChordBlock({ chord: \"\", lyric: \"appear?\" }),\n        ]),\n    ]);\n\n    const example = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly\" }),\n            new ChordBlock({ chord: \"F#7\", lyric: \" ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"\\t\" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly\" }),\n            new ChordBlock({ chord: \"F#7\", lyric: \" ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"\\t\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Chord Positioning</Typography>\n            <LineBreak />\n            <Typography>\n                Sometimes you want to emphasize a chord landing on a specific\n                syllable or between words. Without the overhead of standard\n                notation, we can do this by breaking up lyrics and annotating\n                spaces.\n            </Typography>\n            <LineBreak />\n\n            <Typography>Let's change the lyrics to:</Typography>\n            <LyricsTypography>Why do birds suddenly ap-pear?</LyricsTypography>\n            <Typography>\n                And add a tab after the{\" \"}\n                <LyricsTypography display=\"inline\">?</LyricsTypography>\n            </Typography>\n            <Typography>\n                Then add the chord{\" \"}\n                <ChordTypography display=\"inline\">F#7</ChordTypography> to the\n                space before{\" \"}\n                <LyricsTypography display=\"inline\">ap-</LyricsTypography>\n            </Typography>\n            <Typography>\n                Add the chord{\" \"}\n                <ChordTypography display=\"inline\">B7sus4</ChordTypography> to{\" \"}\n                <LyricsTypography display=\"inline\">pear</LyricsTypography>\n            </Typography>\n            <Typography>\n                Add the chord{\" \"}\n                <ChordTypography display=\"inline\">B7</ChordTypography> to the\n                tabbed space after{\" \"}\n            </Typography>\n            <Typography>It should look like this:</Typography>\n            <Playground initialSong={example} />\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default ChordPositioning;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { LineBreak, LyricsTypography } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst AddLine: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \" \" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \" \" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"Every time you are near\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Adding New Lines</Typography>\n            <LineBreak />\n            <Typography>\n                You can add more lines by hovering below (or above) and existing\n                line, and clicking the gray line or the add icon to the right.\n            </Typography>\n            <Typography>Let's add a line, and change the lyrics to:</Typography>\n            <LyricsTypography>Why do birds suddenly ap-pear?</LyricsTypography>\n            <LyricsTypography>Every time you are near</LyricsTypography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default AddLine;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { LineBreak } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst RemoveLine: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \" \" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"Every time you are near\" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \" \" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Removing Lines</Typography>\n            <LineBreak />\n            <Typography>\n                Similarly, you can remove a line by hovering over the line, and\n                clicking the red remove icon to the right. Let's remove the\n                second line of lyrics.\n            </Typography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default RemoveLine;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { LineBreak, LyricsTypography } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst PasteLyrics: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \" \" }),\n        ]),\n        new ChordLine(),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"C^\", lyric: \"Why do birds suddenly ap-\" }),\n            new ChordBlock({ chord: \"B7sus4\", lyric: \"pear?\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \" \" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"Every time you are near\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"Just like me, they long to be\",\n            }),\n        ]),\n        new ChordLine([new ChordBlock({ chord: \"\", lyric: \"Close to you\" })]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Pasting Lyrics</Typography>\n            <LineBreak />\n            <Typography>\n                It would be annoying to have to type out the lyrics. But we can\n                paste it in! Copy these lyrics, click into the second line, and\n                paste:\n            </Typography>\n            <LyricsTypography variantMapping={{ body1: \"div\" }}>\n                Every time you are near\n            </LyricsTypography>\n            <LyricsTypography variantMapping={{ body1: \"div\" }}>\n                Just like me, they long to be\n            </LyricsTypography>\n            <LyricsTypography variantMapping={{ body1: \"div\" }}>\n                Close to you\n            </LyricsTypography>\n\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default PasteLyrics;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { LineBreak } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst MergeLine: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({\n                chord: \"C^\",\n                lyric: \"Why do birds\",\n            }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"suddenly \",\n            }),\n            new ChordBlock({\n                chord: \"B7\",\n                lyric: \"appear?\",\n            }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({\n                chord: \"C^\",\n                lyric: \"Why do birds suddenly \",\n            }),\n            new ChordBlock({\n                chord: \"B7\",\n                lyric: \"appear?\",\n            }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Merging Lines</Typography>\n            <LineBreak />\n            <Typography>\n                Sometimes the lyrics that we paste in is not the division we\n                want. Let's merge the two lines. Click into the second line,\n                move the cursor to the beginning of the line, and press\n            </Typography>\n            <Typography>\n                (CTRL+Backspace : Windows | CMD+Backspace : Mac)\n            </Typography>\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default MergeLine;\n","import { Typography } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { LineBreak, LyricsTypography } from \"./Common\";\nimport Playground from \"./Playground\";\n\nconst CopyAndPaste: React.FC<{}> = (): JSX.Element => {\n    const initialSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"But I'm a \" }),\n            new ChordBlock({ chord: \"G\", lyric: \"creep, I'm a \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"weirdo\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"What the hell am doing \" }),\n            new ChordBlock({ chord: \"C\", lyric: \"here? I don't be-\" }),\n            new ChordBlock({ chord: \"Cm\", lyric: \"long here\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"I don't care if it \",\n            }),\n            new ChordBlock({ chord: \"G\", lyric: \"hurts, I wanna have con-\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"trol\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"I want a perfect \",\n            }),\n            new ChordBlock({ chord: \"C\", lyric: \"body, I want a perfect \" }),\n            new ChordBlock({ chord: \"Cm\", lyric: \"soul\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"I want you to \",\n            }),\n            new ChordBlock({ chord: \"G\", lyric: \"notice when I'm not a-\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"round\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"You're so fucking \",\n            }),\n            new ChordBlock({ chord: \"C\", lyric: \"special, I wish I was \" }),\n            new ChordBlock({ chord: \"Cm\", lyric: \"special\" }),\n        ]),\n    ]);\n\n    const expectedSong = new ChordSong([\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"But I'm a \" }),\n            new ChordBlock({ chord: \"G\", lyric: \"creep, I'm a \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"weirdo\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"What the hell am doing \" }),\n            new ChordBlock({ chord: \"C\", lyric: \"here? I don't be-\" }),\n            new ChordBlock({ chord: \"Cm\", lyric: \"long here\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"I don't care if it \",\n            }),\n            new ChordBlock({ chord: \"G\", lyric: \"hurts, I wanna have con-\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"trol\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"I want a perfect \",\n            }),\n            new ChordBlock({ chord: \"C\", lyric: \"body, I want a perfect \" }),\n            new ChordBlock({ chord: \"Cm\", lyric: \"soul\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"I want you to \",\n            }),\n            new ChordBlock({ chord: \"G\", lyric: \"notice when I'm not a-\" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"round\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({\n                chord: \"\",\n                lyric: \"You're so fucking \",\n            }),\n            new ChordBlock({ chord: \"C\", lyric: \"special, I wish I was \" }),\n            new ChordBlock({ chord: \"Cm\", lyric: \"special\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"But I'm a \" }),\n            new ChordBlock({ chord: \"G\", lyric: \"creep, I'm a \" }),\n            new ChordBlock({ chord: \"B7\", lyric: \"weirdo\" }),\n        ]),\n        new ChordLine([\n            new ChordBlock({ chord: \"\", lyric: \"What the hell am doing \" }),\n            new ChordBlock({ chord: \"C\", lyric: \"here? I don't be-\" }),\n            new ChordBlock({ chord: \"Cm\", lyric: \"long here\" }),\n        ]),\n    ]);\n\n    return (\n        <>\n            <Typography variant=\"h6\">Copying and Pasting Lines</Typography>\n            <LineBreak />\n            <Typography>\n                Sometimes you want to just repeat what's on the page without\n                entering it all over again - choruses with the same lyrics,\n                repeating instrumental sections. You can do this by copying and\n                pasting entire lines that you've already written out.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                The easiest way to copy is to drag down from some empty space on\n                the left of the line you wish to start copying from, then\n                pressing (CTRL or CMD) + C, or right click -> copy.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                To paste, click to edit a lyric line, and press (CTRL or CMD) +\n                V, or right click -> paste.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                Note that there's no partial copy - if any part of the line is\n                selected during the copy, the whole line is copied.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                If you have trouble selecting a line, try dragging your cursor\n                starting further left and above the line.\n            </Typography>\n            <LineBreak />\n            <Typography>\n                Let's try copying and pasting the repeated chorus:\n            </Typography>\n            <LyricsTypography variantMapping={{ body1: \"div\" }}>\n                But I'm a creep, I'm a weirdo\n            </LyricsTypography>\n            <LyricsTypography variantMapping={{ body1: \"div\" }}>\n                What the hell am I doing here? I don't belong here.\n            </LyricsTypography>\n            <LineBreak />\n            <Typography>\n                Copy those two lines, add a new line at the bottom, and paste it\n                there.\n            </Typography>\n\n            <LineBreak />\n            <Typography>Try it!</Typography>\n            <Playground initialSong={initialSong} expectedSong={expectedSong} />\n        </>\n    );\n};\n\nexport default CopyAndPaste;\n","import {\n    Collapse,\n    Divider,\n    Drawer,\n    Grid,\n    List,\n    ListItem,\n    ListItemIcon,\n    ListItemText,\n    Paper,\n    Theme,\n    Typography,\n} from \"@material-ui/core\";\nimport grey from \"@material-ui/core/colors/grey\";\nimport UnstyledCloseIcon from \"@material-ui/icons/Close\";\nimport ExpandLessIcon from \"@material-ui/icons/ExpandLess\";\nimport ExpandMoreIcon from \"@material-ui/icons/ExpandMore\";\nimport FreeBreakfastIcon from \"@material-ui/icons/FreeBreakfast\";\nimport UnstyledMenuIcon from \"@material-ui/icons/Menu\";\nimport MusicNoteIcon from \"@material-ui/icons/MusicNote\";\nimport PetsIcon from \"@material-ui/icons/Pets\";\nimport StoreIcon from \"@material-ui/icons/Store\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React, { useState } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { allExerciseRoutes, ExerciseRoute } from \"./Tutorial\";\n\nconst withPointerStyle = withStyles({\n    root: {\n        cursor: \"pointer\",\n    },\n});\n\nconst MenuIcon = withPointerStyle(UnstyledMenuIcon);\nconst CloseIcon = withPointerStyle(UnstyledCloseIcon);\n\nconst VerticalGridItem = withStyles({\n    root: {\n        maxWidth: \"none\",\n    },\n})(Grid);\n\nconst TitleGrid = withStyles((theme: Theme) => ({\n    root: {\n        padding: theme.spacing(3),\n    },\n}))(Grid);\n\nconst TitleName = withStyles({\n    root: {\n        color: grey[600],\n    },\n})(Typography);\n\nconst CollapsedMenuSurface = withStyles({\n    root: {\n        minWidth: \"24px\",\n        height: \"100vh\",\n    },\n})(Paper);\n\nconst FullHeightGrid = withStyles({\n    root: {\n        height: \"100%\",\n        width: \"100%\",\n    },\n})(Grid);\n\nconst SideMenu: React.FC<{}> = (): JSX.Element => {\n    const [expanded, setExpanded] = useState(false);\n    const [learnSubmenuOpen, setLearnSubMenuOpen] = useState(false);\n\n    const typographyProps = {\n        variant: \"h6\" as \"h6\",\n    };\n\n    const learnClickHandler = () => {\n        setLearnSubMenuOpen(!learnSubmenuOpen);\n    };\n\n    const tutorialMenu = () => {\n        const exerciseLinks = allExerciseRoutes().map(\n            (exerciseRoute: ExerciseRoute) => {\n                return (\n                    <Link\n                        key={exerciseRoute.route}\n                        to={exerciseRoute.route}\n                        style={linkStyle}\n                    >\n                        <ListItem button>\n                            <ListItemText inset primary={exerciseRoute.title} />\n                        </ListItem>\n                    </Link>\n                );\n            }\n        );\n\n        return (\n            <>\n                <ListItem key=\"Learn\" button onClick={learnClickHandler}>\n                    <ListItemIcon>\n                        <FreeBreakfastIcon />\n                    </ListItemIcon>\n                    <ListItemText\n                        primary=\"Learn\"\n                        primaryTypographyProps={typographyProps}\n                    />\n                    {learnSubmenuOpen ? <ExpandLessIcon /> : <ExpandMoreIcon />}\n                </ListItem>\n                <Collapse in={learnSubmenuOpen} timeout=\"auto\">\n                    <List>{exerciseLinks}</List>\n                </Collapse>\n            </>\n        );\n    };\n\n    const linkStyle = {\n        textDecoration: \"none\",\n        color: \"inherit\",\n    };\n\n    const collapsedMenu = (\n        <Drawer variant=\"persistent\" open={!expanded} anchor=\"left\">\n            <CollapsedMenuSurface>\n                <FullHeightGrid\n                    container\n                    direction=\"column\"\n                    alignContent=\"center\"\n                >\n                    <VerticalGridItem item xs={1}></VerticalGridItem>\n                    <VerticalGridItem item xs={1}>\n                        <MenuIcon onClick={() => setExpanded(true)} />\n                    </VerticalGridItem>\n                    <VerticalGridItem item xs={10}></VerticalGridItem>\n                </FullHeightGrid>\n            </CollapsedMenuSurface>\n        </Drawer>\n    );\n\n    const expandedMenu = (\n        <Drawer variant=\"persistent\" open={expanded} anchor=\"left\">\n            <TitleGrid container alignItems=\"center\" justify=\"space-between\">\n                <Grid item>\n                    <Link\n                        to=\"/\"\n                        style={linkStyle}\n                        data-testid=\"Menu-TitleButton\"\n                    >\n                        <TitleName variant=\"h5\" display=\"inline\">\n                            Chord Paper\n                        </TitleName>\n                    </Link>\n                </Grid>\n                <Grid item>\n                    <CloseIcon onClick={() => setExpanded(false)} />\n                </Grid>\n            </TitleGrid>\n\n            <Divider />\n            <List>\n                <Link\n                    key=\"/song\"\n                    to=\"/song\"\n                    style={linkStyle}\n                    data-testid=\"Menu-HomeButton\"\n                >\n                    <ListItem key=\"Song\" button>\n                        <ListItemIcon>\n                            <MusicNoteIcon />\n                        </ListItemIcon>\n                        <ListItemText\n                            primary=\"Song\"\n                            primaryTypographyProps={typographyProps}\n                        />\n                    </ListItem>\n                </Link>\n                <Link\n                    key=\"/demo\"\n                    to=\"/demo\"\n                    style={linkStyle}\n                    data-testid=\"Menu-DemoButton\"\n                >\n                    <ListItem key=\"Demo\" button>\n                        <ListItemIcon>\n                            <StoreIcon />\n                        </ListItemIcon>\n                        <ListItemText\n                            primary=\"Demo\"\n                            primaryTypographyProps={typographyProps}\n                        />\n                    </ListItem>\n                </Link>\n                {tutorialMenu()}\n                <Link\n                    key=\"/about\"\n                    to=\"/about\"\n                    style={linkStyle}\n                    data-testid=\"Menu-AboutButton\"\n                >\n                    <ListItem key=\"About\" button>\n                        <ListItemIcon>\n                            <PetsIcon />\n                        </ListItemIcon>\n                        <ListItemText\n                            primary=\"About\"\n                            primaryTypographyProps={typographyProps}\n                        />\n                    </ListItem>\n                </Link>\n            </List>\n        </Drawer>\n    );\n\n    return (\n        <>\n            {collapsedMenu}\n            {expandedMenu}\n        </>\n    );\n};\n\nexport default SideMenu;\n","import { Theme } from \"@material-ui/core\";\nimport FolderOpenIcon from \"@material-ui/icons/FolderOpen\";\nimport NoteAddIcon from \"@material-ui/icons/NoteAdd\";\nimport PlayIcon from \"@material-ui/icons/PlayArrow\";\nimport SaveIcon from \"@material-ui/icons/Save\";\nimport {\n    SpeedDial as UnstyledSpeedDial,\n    SpeedDialAction,\n    SpeedDialIcon,\n} from \"@material-ui/lab\";\nimport { withStyles } from \"@material-ui/styles\";\nimport { isLeft } from \"fp-ts/lib/Either\";\nimport { useSnackbar } from \"notistack\";\nimport React, { useState } from \"react\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\ninterface ChordPaperMenuProps {\n    song: ChordSong;\n    onLoad?: (loadedSong: ChordSong) => void;\n    onNewSong?: PlainFn;\n    onPlay?: PlainFn;\n}\n\nconst SpeedDial = withStyles((theme: Theme) => ({\n    root: {\n        position: \"fixed\",\n        bottom: theme.spacing(2),\n        right: theme.spacing(2),\n    },\n}))(UnstyledSpeedDial);\n\nconst ChordPaperMenu: React.FC<ChordPaperMenuProps> = (\n    props: ChordPaperMenuProps\n): JSX.Element => {\n    const [open, setOpen] = useState(false);\n    const { enqueueSnackbar } = useSnackbar();\n\n    const openMenu = () => {\n        setOpen(true);\n    };\n\n    const closeMenu = () => {\n        setOpen(false);\n    };\n\n    const saveAction = () => {\n        const jsonStr = JSON.stringify(props.song);\n\n        const blob = new Blob([jsonStr], {\n            type: \"application/json\",\n        });\n        const objectURL = URL.createObjectURL(blob);\n\n        const anchor = document.createElement(\"a\");\n\n        anchor.download = \"chord_paper_song.json\";\n        if (props.song.title !== \"\") {\n            anchor.download = props.song.title + \".json\";\n        }\n        anchor.href = objectURL;\n        anchor.click();\n\n        URL.revokeObjectURL(objectURL);\n    };\n\n    function pickFileHandler(this: HTMLInputElement) {\n        const fileList = this.files;\n        if (fileList === null) {\n            return;\n        }\n\n        if (fileList.length > 1) {\n            enqueueSnackbar(\"Multiple files selected, only one file expected\", {\n                variant: \"error\",\n            });\n            return;\n        }\n\n        const file = fileList.item(0);\n        if (file === null) {\n            enqueueSnackbar(\"Could not retrieve file from file dialog\", {\n                variant: \"error\",\n            });\n            return;\n        }\n\n        const fileReader = new FileReader();\n        fileReader.onload = (ev: ProgressEvent<FileReader>) => {\n            if (\n                ev.target === null ||\n                ev.target.result === null ||\n                ev.target.result instanceof ArrayBuffer\n            ) {\n                return;\n            }\n\n            const results = ChordSong.deserialize(ev.target.result);\n            if (isLeft(results)) {\n                enqueueSnackbar(\n                    \"Can't load file, Song file failed validation\",\n                    {\n                        variant: \"error\",\n                    }\n                );\n                return;\n            }\n\n            if (props.onLoad) {\n                props.onLoad(results.right);\n            }\n        };\n\n        fileReader.readAsText(file);\n    }\n\n    const loadAction = async () => {\n        const inputElem: HTMLInputElement = document.createElement(\"input\");\n        inputElem.type = \"file\";\n        inputElem.addEventListener(\"change\", pickFileHandler);\n\n        inputElem.click();\n    };\n\n    return (\n        <SpeedDial\n            icon={<SpeedDialIcon />}\n            open={open}\n            onOpen={openMenu}\n            onClose={closeMenu}\n            ariaLabel=\"SpeedDial\"\n        >\n            <SpeedDialAction\n                icon={<SaveIcon />}\n                tooltipTitle=\"Save\"\n                onClick={saveAction}\n            />\n            <SpeedDialAction\n                icon={<FolderOpenIcon />}\n                tooltipTitle=\"Load\"\n                onClick={loadAction}\n            />\n            <SpeedDialAction\n                icon={<NoteAddIcon />}\n                tooltipTitle=\"New Song\"\n                onClick={props.onNewSong}\n            />\n            <SpeedDialAction\n                icon={<PlayIcon />}\n                tooltipTitle=\"Play Mode\"\n                onClick={props.onPlay}\n            />\n        </SpeedDial>\n    );\n};\n\nexport default ChordPaperMenu;\n","import { Box, Grid, Theme, Typography } from \"@material-ui/core\";\nimport { useTheme } from \"@material-ui/styles\";\nimport React from \"react\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport EditableTypography from \"./EditableTypography\";\n\ninterface HeaderProps {\n    song: ChordSong;\n    onSongChanged?: (updatedSong: ChordSong) => void;\n}\n\nconst Header: React.FC<HeaderProps> = (props: HeaderProps): JSX.Element => {\n    const theme: Theme = useTheme();\n\n    const notifySongChanged = (): void => {\n        if (props.onSongChanged) {\n            props.onSongChanged(props.song);\n        }\n    };\n\n    const updateTitleHandler = (newTitle: string) => {\n        props.song.title = newTitle;\n        notifySongChanged();\n    };\n\n    const updateComposeHandler = (newComposer: string) => {\n        props.song.composedBy = newComposer;\n        notifySongChanged();\n    };\n\n    const updatePerformerHandler = (newPerformer: string) => {\n        props.song.performedBy = newPerformer;\n        notifySongChanged();\n    };\n\n    const updateHeardFrom = (newHeardFrom: string) => {\n        props.song.asHeardFrom = newHeardFrom;\n        notifySongChanged();\n    };\n\n    const title = (\n        <Box paddingBottom={theme.spacing(0.5)}>\n            <EditableTypography\n                variant=\"h4\"\n                align=\"center\"\n                data-testid=\"SongTitle\"\n                placeholder=\"Song Title\"\n                onValueChange={updateTitleHandler}\n            >\n                {props.song.title}\n            </EditableTypography>\n        </Box>\n    );\n\n    const details = (\n        <Grid container justify=\"center\">\n            <Grid container item xs={4} justify=\"center\">\n                <Grid item>\n                    <Typography display=\"block\" variant=\"caption\">\n                        Composed by:{\" \"}\n                    </Typography>\n\n                    <EditableTypography\n                        display=\"block\"\n                        variant=\"caption\"\n                        placeholder=\"Stock Aitken Waterman\"\n                        onValueChange={updateComposeHandler}\n                        data-testid=\"ComposedBy\"\n                    >\n                        {props.song.composedBy}\n                    </EditableTypography>\n                </Grid>\n            </Grid>\n            <Grid container item xs={4} justify=\"center\">\n                <Grid item>\n                    <Typography display=\"inline\" variant=\"caption\">\n                        Performed by:{\" \"}\n                    </Typography>\n\n                    <EditableTypography\n                        variant=\"caption\"\n                        placeholder=\"Rick Astley\"\n                        onValueChange={updatePerformerHandler}\n                        data-testid=\"PerformedBy\"\n                    >\n                        {props.song.performedBy}\n                    </EditableTypography>\n                </Grid>\n            </Grid>\n            <Grid container item xs={4} justify=\"center\">\n                <Grid item>\n                    <Typography display=\"inline\" variant=\"caption\">\n                        As heard from:{\" \"}\n                    </Typography>\n                    <EditableTypography\n                        variant=\"caption\"\n                        placeholder=\"https://www.youtube.com/watch?v=dM9zwZCOmjM\"\n                        onValueChange={updateHeardFrom}\n                        data-testid=\"AsHeardAt\"\n                    >\n                        {props.song.asHeardFrom}\n                    </EditableTypography>\n                </Grid>\n            </Grid>\n        </Grid>\n    );\n\n    return (\n        <Box\n            paddingTop={theme.spacing(1)}\n            paddingLeft={theme.spacing(0.5)}\n            paddingRight={theme.spacing(0.5)}\n            data-testid=\"Header\"\n        >\n            {title}\n            {details}\n        </Box>\n    );\n};\n\nexport default Header;\n","import { Paper, Theme, withStyles } from \"@material-ui/core\";\nimport React from \"react\";\nimport { Helmet } from \"react-helmet-async\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport ChordPaperBody from \"./ChordPaperBody\";\nimport ChordPaperMenu from \"./ChordPaperMenu\";\nimport Header from \"./Header\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\nconst RootPaper = withStyles((theme: Theme) => ({\n    root: {\n        margin: theme.spacing(5),\n        minHeight: theme.spacing(92),\n        minWidth: theme.spacing(92),\n    },\n}))(Paper);\n\ninterface ChordPaperProps {\n    song: ChordSong;\n    onSongChanged?: (song: ChordSong) => void;\n    onPlay?: PlainFn;\n}\n\nconst ChordPaper: React.FC<ChordPaperProps> = (\n    props: ChordPaperProps\n): JSX.Element => {\n    const songChangeHandler = (song: ChordSong) => {\n        props.onSongChanged?.(song);\n    };\n\n    const loadHandler = (loadedSong: ChordSong) => {\n        props.onSongChanged?.(loadedSong);\n    };\n\n    const newSongHandler = () => {\n        props.onSongChanged?.(new ChordSong());\n    };\n\n    return (\n        <>\n            <Helmet>\n                <title>\n                    {props.song.metadata.title !== \"\"\n                        ? props.song.metadata.title\n                        : \"New Song\"}\n                </title>\n            </Helmet>\n            <RootPaper elevation={3} data-testid=\"ChordPaper\">\n                <Header\n                    data-testid={\"Header\"}\n                    song={props.song}\n                    onSongChanged={songChangeHandler}\n                />\n                <ChordPaperBody\n                    song={props.song}\n                    onSongChanged={songChangeHandler}\n                />\n                <ChordPaperMenu\n                    song={props.song}\n                    onLoad={loadHandler}\n                    onNewSong={newSongHandler}\n                    onPlay={props.onPlay}\n                />\n            </RootPaper>\n        </>\n    );\n};\n\nexport default ChordPaper;\n","import { Box, Grid } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport ChordSymbol from \"../display/ChordSymbol\";\nimport Lyric from \"../display/Lyric\";\n\ninterface PlayBlockProps {\n    block: ChordBlock;\n}\n\nconst PlayBlock: React.FC<PlayBlockProps> = (\n    props: PlayBlockProps\n): JSX.Element => {\n    return (\n        <Box display=\"inline-block\">\n            <Grid container direction=\"column\" component=\"span\">\n                <Grid item>\n                    <ChordSymbol>{props.block.chord}</ChordSymbol>\n                </Grid>\n                <Grid item>\n                    <Lyric data-testid=\"lyric\">{props.block.lyric}</Lyric>\n                </Grid>\n            </Grid>\n        </Box>\n    );\n};\n\nexport default PlayBlock;\n","import { Box, Typography, Theme } from \"@material-ui/core\";\nimport React from \"react\";\nimport { ChordBlock } from \"../../common/ChordModel/ChordBlock\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport PlayBlock from \"./PlayBlock\";\nimport { withStyles } from \"@material-ui/styles\";\nimport {\n    sectionLabelStyle,\n    sectionTypographyVariant,\n} from \"../display/SectionLabel\";\n\nconst LabelTypography = withStyles(sectionLabelStyle)(Typography);\nconst TopMarginBox = withStyles((theme: Theme) => ({\n    root: {\n        marginTop: theme.spacing(1),\n    },\n}))(Box);\n\ninterface PlayLineProps {\n    chordLine: ChordLine;\n}\n\nconst PlayLine: React.FC<PlayLineProps> = (\n    props: PlayLineProps\n): JSX.Element => {\n    let lineComponent: React.ReactElement = (\n        <Box>\n            {props.chordLine.chordBlocks.map((block: ChordBlock) => (\n                <PlayBlock block={block}></PlayBlock>\n            ))}\n        </Box>\n    );\n\n    if (props.chordLine.label !== undefined && props.chordLine.label !== \"\") {\n        const label = (\n            <TopMarginBox>\n                <LabelTypography variant={sectionTypographyVariant}>\n                    {props.chordLine.label}\n                </LabelTypography>\n            </TopMarginBox>\n        );\n\n        lineComponent = (\n            <Box display=\"inline-block\">\n                {label}\n                {lineComponent}\n            </Box>\n        );\n    }\n\n    return lineComponent;\n};\n\nexport default PlayLine;\n","import { Box, Paper, RootRef } from \"@material-ui/core\";\nimport grey from \"@material-ui/core/colors/grey\";\nimport { withStyles } from \"@material-ui/styles\";\nimport { useWindowWidth } from \"@react-hook/window-size\";\nimport React, { useEffect } from \"react\";\nimport { ChordLine } from \"../../common/ChordModel/ChordLine\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport PlayLine from \"./PlayLine\";\n\nexport interface PlayFormatting {\n    numberOfColumns: number;\n    fontSize: number;\n    columnMargin: number;\n}\n\ninterface PlayContentProps {\n    song: ChordSong;\n    formatting: PlayFormatting;\n}\n\nconst PlayContent: React.FC<PlayContentProps> = (\n    props: PlayContentProps\n): JSX.Element => {\n    const ref = React.useRef<HTMLElement>();\n\n    const numberOfColumns =\n        props.formatting.numberOfColumns >= 1\n            ? props.formatting.numberOfColumns\n            : 1;\n    const columnMargin =\n        props.formatting.columnMargin >= 0 ? props.formatting.columnMargin : 0;\n\n    const windowWidth = useWindowWidth();\n    const columnWidth = windowWidth / numberOfColumns;\n    const snapThreshold = columnWidth / 2;\n\n    const scrollPage = (forward: boolean) => {\n        const currentPos = window.scrollX;\n        const delta = forward ? windowWidth : -windowWidth;\n\n        let nextPos = currentPos + delta;\n\n        const distanceFromLastColumn = nextPos % columnWidth;\n\n        if (distanceFromLastColumn < snapThreshold) {\n            nextPos -= distanceFromLastColumn;\n        } else {\n            const remainingDistance = columnWidth - distanceFromLastColumn;\n            nextPos += remainingDistance;\n        }\n\n        window.scrollTo({\n            left: nextPos,\n            top: 0,\n            behavior: \"smooth\",\n        });\n    };\n\n    const scrollForward = () => scrollPage(true);\n    const scrollBackward = () => scrollPage(false);\n\n    const handleKey = (event: React.KeyboardEvent<HTMLDivElement>) => {\n        // only three keys ever go backwards, everything else goes forwards\n        if (\n            event.key === \"ArrowLeft\" ||\n            event.key === \"ArrowUp\" ||\n            event.key === \"Backspace\"\n        ) {\n            scrollBackward();\n        } else {\n            scrollForward();\n        }\n\n        event.preventDefault();\n    };\n\n    const handleClick = (\n        event: React.MouseEvent<HTMLDivElement, MouseEvent>\n    ) => {\n        const handlers: ((\n            event: React.MouseEvent<HTMLDivElement, MouseEvent>\n        ) => boolean)[] = [handleLeftClick, handleRightClick];\n\n        for (const handler of handlers) {\n            const handled: boolean = handler(event);\n            if (handled) {\n                event.preventDefault();\n                return;\n            }\n        }\n    };\n\n    const handleLeftClick = (\n        event: React.MouseEvent<HTMLDivElement, MouseEvent>\n    ): boolean => {\n        // left click\n        if (event.button !== 0) {\n            return false;\n        }\n\n        scrollForward();\n        return true;\n    };\n\n    const handleRightClick = (\n        event: React.MouseEvent<HTMLDivElement, MouseEvent>\n    ): boolean => {\n        // right click\n        if (event.button !== 2) {\n            return false;\n        }\n\n        scrollBackward();\n        return true;\n    };\n\n    // sorry, preventing context menu from showing up to make the right mouse click\n    // experience less annoying\n    const cancelContextMenu = (\n        event: React.MouseEvent<HTMLDivElement, MouseEvent>\n    ) => {\n        event.preventDefault();\n    };\n\n    const ColumnedPaper = withStyles({\n        root: {\n            columnGap: \"0px\",\n            columnRuleWidth: \"2px\",\n            columnRuleStyle: \"solid\",\n            columnRuleColor: grey[300],\n            columns: numberOfColumns,\n            height: \"100vh\",\n            width: \"100%\",\n        },\n    })(Paper);\n\n    // using margins instead of column-gap, CSS columns force the rightmost column\n    // up against the edge of the viewport and doesn't strictly respect column width\n    //\n    // making 0 gap columns with margins makes the math a lot simpler for each column\n    const MarginBox = withStyles({\n        root: {\n            marginLeft: `${columnMargin}px`,\n            marginRight: `${columnMargin}px`,\n        },\n    })(Box);\n\n    const lines = props.song.chordLines.map((chordLine: ChordLine) => {\n        return <PlayLine chordLine={chordLine} />;\n    });\n\n    useEffect(() => {\n        ref.current?.focus();\n    });\n\n    return (\n        <RootRef rootRef={ref}>\n            <ColumnedPaper\n                onMouseDown={handleClick}\n                onContextMenu={cancelContextMenu}\n                tabIndex={0}\n                onKeyDown={handleKey}\n            >\n                <MarginBox>{lines}</MarginBox>\n            </ColumnedPaper>\n        </RootRef>\n    );\n};\n\nexport default PlayContent;\n","import {\n    Box as UnstyledBox,\n    Button,\n    Dialog,\n    DialogActions,\n    DialogContent,\n    DialogTitle,\n    InputAdornment,\n    TextField,\n    TextFieldProps as TextFieldPropsWithVariant,\n    Theme,\n} from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport { Either, isLeft, left, right } from \"fp-ts/lib/Either\";\nimport React, { ChangeEvent, useState } from \"react\";\nimport { isWhitespace } from \"../../common/Whitespace\";\nimport { PlayFormatting } from \"./PlayContent\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\ntype TextFieldProps = Omit<Partial<TextFieldPropsWithVariant>, \"variant\">;\n\ninterface TextSettings {\n    numberOfColumns: string;\n    fontSize: string;\n    columnMargin: string;\n}\n\ninterface InputFieldSpecification {\n    label: string;\n    field: keyof TextSettings;\n    adornment: string | null;\n    validationErrorPropsFn: (strValue: string) => Either<Error, number>;\n}\n\ninterface DisplaySettingsProps {\n    open: boolean;\n    onClose?: PlainFn;\n    defaultSettings: PlayFormatting;\n    onSubmit?: (formatting: PlayFormatting) => void;\n}\n\nconst Box = withStyles((theme: Theme) => ({\n    root: {\n        margin: theme.spacing(1),\n    },\n}))(UnstyledBox);\n\nconst DisplaySettings: React.FC<DisplaySettingsProps> = (\n    props: DisplaySettingsProps\n): JSX.Element => {\n    const [settings, setSettings] = useState<TextSettings>({\n        numberOfColumns: props.defaultSettings.numberOfColumns.toString(),\n        fontSize: props.defaultSettings.fontSize.toString(),\n        columnMargin: props.defaultSettings.columnMargin.toString(),\n    });\n\n    const validateNumber = (strValue: string): Either<Error, number> => {\n        if (strValue === \"\" || isWhitespace(strValue)) {\n            return left(new Error(\"A value is required\"));\n        }\n\n        const convertedNumber = Number(strValue);\n        if (isNaN(convertedNumber)) {\n            return left(new Error(\"Only numbers are allowed\"));\n        }\n\n        if (convertedNumber <= 0) {\n            return left(new Error(\"Only positive numbers are allowed\"));\n        }\n\n        return right(convertedNumber);\n    };\n\n    const validateInt = (strValue: string): Either<Error, number> => {\n        const result = validateNumber(strValue);\n\n        if (isLeft(result)) {\n            return result;\n        }\n\n        const convertedNumber = result.right;\n\n        const convertedInteger = Math.floor(convertedNumber);\n        if (convertedNumber !== convertedInteger) {\n            return left(new Error(\"Only integers are allowed\"));\n        }\n\n        return right(convertedInteger);\n    };\n\n    const validatedSettings = (): Either<Error, PlayFormatting> => {\n        const numberOfColumnsResults = validateInt(settings.numberOfColumns);\n        const fontSizeResults = validateNumber(settings.fontSize);\n        const columnMarginResults = validateNumber(settings.columnMargin);\n\n        if (isLeft(numberOfColumnsResults)) {\n            return numberOfColumnsResults;\n        }\n\n        if (isLeft(fontSizeResults)) {\n            return fontSizeResults;\n        }\n\n        if (isLeft(columnMarginResults)) {\n            return columnMarginResults;\n        }\n\n        const formatting: PlayFormatting = {\n            numberOfColumns: numberOfColumnsResults.right,\n            fontSize: fontSizeResults.right,\n            columnMargin: columnMarginResults.right,\n        };\n\n        return right(formatting);\n    };\n\n    const hasValidationErrors = (): boolean => {\n        return isLeft(validatedSettings());\n    };\n\n    const handleSubmit = () => {\n        const settings = validatedSettings();\n\n        if (isLeft(settings)) {\n            return;\n        }\n\n        props.onSubmit?.({\n            numberOfColumns: settings.right.numberOfColumns,\n            fontSize: settings.right.fontSize,\n            columnMargin: settings.right.columnMargin,\n        });\n    };\n\n    const settingChangeHandler = (field: keyof TextSettings) => {\n        return (event: ChangeEvent<HTMLInputElement | HTMLTextAreaElement>) => {\n            const newValue = event.target.value;\n            const newSettings: TextSettings = { ...settings };\n            newSettings[field] = newValue;\n            setSettings(newSettings);\n        };\n    };\n\n    const validationErrorProps = (\n        result: Either<Error, number>\n    ): TextFieldProps => {\n        return {\n            error: isLeft(result) ? true : undefined,\n            helperText: isLeft(result) ? result.left.message : undefined,\n        };\n    };\n\n    const inputSpecs: InputFieldSpecification[] = [\n        {\n            label: \"number of columns\",\n            field: \"numberOfColumns\",\n            adornment: null,\n            validationErrorPropsFn: (val: string) => validateInt(val),\n        },\n        {\n            label: \"font size\",\n            field: \"fontSize\",\n            adornment: \"px\",\n            validationErrorPropsFn: (val: string) => validateNumber(val),\n        },\n        {\n            label: \"column margin\",\n            field: \"columnMargin\",\n            adornment: \"px\",\n            validationErrorPropsFn: (val: string) => validateNumber(val),\n        },\n    ];\n\n    const makeInput = (spec: InputFieldSpecification) => {\n        const textFieldProps: TextFieldProps = {\n            label: spec.label,\n            defaultValue: settings[spec.field],\n            onChange: settingChangeHandler(spec.field),\n            ...validationErrorProps(\n                spec.validationErrorPropsFn(settings[spec.field])\n            ),\n        };\n\n        if (spec.adornment !== null) {\n            textFieldProps.InputProps = {\n                endAdornment: (\n                    <InputAdornment position=\"end\">\n                        {spec.adornment}\n                    </InputAdornment>\n                ),\n            };\n        }\n\n        return (\n            <Box>\n                <TextField {...textFieldProps} />\n            </Box>\n        );\n    };\n\n    return (\n        <Dialog open={props.open} onClose={props.onClose}>\n            <DialogTitle>Display Settings</DialogTitle>\n            <DialogContent>\n                {inputSpecs.map((spec: InputFieldSpecification) =>\n                    makeInput(spec)\n                )}\n            </DialogContent>\n            <DialogActions>\n                <Button onClick={props.onClose}>Cancel</Button>\n                <Button disabled={hasValidationErrors()} onClick={handleSubmit}>\n                    OK\n                </Button>\n            </DialogActions>\n        </Dialog>\n    );\n};\n\nexport default DisplaySettings;\n","import { Theme } from \"@material-ui/core\";\nimport grey from \"@material-ui/core/colors/grey\";\nimport ExitToAppIcon from \"@material-ui/icons/ExitToApp\";\nimport TuneIcon from \"@material-ui/icons/Tune\";\n\nimport UnstyledMenuIcon from \"@material-ui/icons/Menu\";\nimport {\n    SpeedDial as UnstyledSpeedDial,\n    SpeedDialAction,\n} from \"@material-ui/lab\";\nimport { withStyles } from \"@material-ui/styles\";\nimport React, { useState } from \"react\";\nimport DisplaySettings from \"./DisplaySettings\";\nimport { PlayFormatting } from \"./PlayContent\";\nimport { PlainFn } from \"../../common/PlainFn\";\n\ninterface PlayMenuProps {\n    formatting: PlayFormatting;\n    onFormattingChange?: (formatting: PlayFormatting) => void;\n    onExit?: PlainFn;\n}\n\nconst MenuIcon = withStyles({\n    root: {\n        backgroundColor: \"transparent\",\n    },\n})(UnstyledMenuIcon);\n\nconst SpeedDial = withStyles((theme: Theme) => ({\n    root: {\n        position: \"fixed\",\n        top: theme.spacing(2),\n        right: theme.spacing(2),\n        \"& .MuiSpeedDial-fab\": {\n            backgroundColor: \"transparent\",\n            color: grey[500],\n        },\n    },\n}))(UnstyledSpeedDial);\n\nconst PlayMenu: React.FC<PlayMenuProps> = (\n    props: PlayMenuProps\n): JSX.Element => {\n    const [open, setOpen] = useState(false);\n    const [displaySettingsOpen, setDisplaySettingsOpen] = useState(false);\n\n    const openMenu = () => {\n        setOpen(true);\n    };\n\n    const closeMenu = () => {\n        setOpen(false);\n    };\n\n    const handleExit = (\n        event: React.MouseEvent<HTMLDivElement, MouseEvent>\n    ) => {\n        props.onExit?.();\n        event.stopPropagation();\n    };\n\n    const handleFormattingChange = (settings: PlayFormatting) => {\n        props.onFormattingChange?.(settings);\n        setDisplaySettingsOpen(false);\n    };\n\n    // returning this instead of shoving it in the same fragment because\n    // returning speed dial in a fragment somehow causes some layout changes\n    if (displaySettingsOpen) {\n        return (\n            <DisplaySettings\n                open\n                onClose={() => setDisplaySettingsOpen(false)}\n                defaultSettings={props.formatting}\n                onSubmit={handleFormattingChange}\n            />\n        );\n    }\n\n    return (\n        <SpeedDial\n            icon={<MenuIcon />}\n            direction=\"down\"\n            open={open}\n            onOpen={openMenu}\n            onClose={closeMenu}\n            ariaLabel=\"SpeedDial\"\n            FabProps={{\n                color: \"inherit\",\n            }}\n        >\n            <SpeedDialAction\n                icon={<TuneIcon />}\n                tooltipTitle=\"Display Settings\"\n                onMouseDownCapture={() => setDisplaySettingsOpen(true)}\n            />\n            <SpeedDialAction\n                icon={<ExitToAppIcon />}\n                tooltipTitle=\"Exit Play Mode\"\n                onMouseDownCapture={handleExit}\n            />\n        </SpeedDial>\n    );\n};\n\nexport default PlayMenu;\n","import { createMuiTheme, Theme, ThemeProvider } from \"@material-ui/core\";\nimport React, { useState } from \"react\";\nimport { Helmet } from \"react-helmet-async\";\nimport { ChordSong } from \"../../common/ChordModel/ChordSong\";\nimport { PlainFn } from \"../../common/PlainFn\";\nimport PlayContent, { PlayFormatting } from \"./PlayContent\";\nimport PlayMenu from \"./PlayMenu\";\n\ninterface PlayProps {\n    song: ChordSong;\n    onEdit?: PlainFn;\n}\n\nconst Play: React.FC<PlayProps> = (props: PlayProps): JSX.Element => {\n    const [formatting, setFormatting] = useState<PlayFormatting>({\n        numberOfColumns: 2,\n        fontSize: 14,\n        columnMargin: 20,\n    });\n\n    const playTheme = (theme: Theme): Theme => {\n        return createMuiTheme({\n            ...theme,\n            typography: {\n                fontFamily: theme.typography.fontFamily,\n                fontWeightRegular: theme.typography.fontWeightRegular,\n                fontSize: formatting.fontSize,\n            },\n        });\n    };\n\n    return (\n        <>\n            <Helmet>\n                <title>\n                    {props.song.metadata.title !== \"\"\n                        ? props.song.metadata.title\n                        : \"New Song\"}\n                </title>\n            </Helmet>\n            <PlayMenu\n                formatting={formatting}\n                onFormattingChange={setFormatting}\n                onExit={props.onEdit}\n            />\n            <ThemeProvider theme={playTheme}>\n                <PlayContent song={props.song} formatting={formatting} />\n            </ThemeProvider>\n        </>\n    );\n};\n\nexport default Play;\n","import React from \"react\";\nimport { Route, useHistory } from \"react-router-dom\";\nimport { ChordSong } from \"../common/ChordModel/ChordSong\";\nimport ChordPaper from \"./edit/ChordPaper\";\nimport Play from \"./play/Play\";\n\ninterface SongRouterProps {\n    basePath: string;\n    song: ChordSong;\n    onSongChanged?: (song: ChordSong) => void;\n}\n\nconst SongRouter: React.FC<SongRouterProps> = (\n    props: SongRouterProps\n): JSX.Element => {\n    const history = useHistory();\n\n    const editPath = `${props.basePath}/edit`;\n    const playPath = `${props.basePath}/play`;\n\n    const switchToEdit = () => {\n        history.push(editPath);\n    };\n\n    const switchToPlay = () => {\n        history.push(playPath);\n    };\n\n    return (\n        <>\n            <Route key={editPath} path={editPath}>\n                <ChordPaper\n                    song={props.song}\n                    onSongChanged={props.onSongChanged}\n                    onPlay={switchToPlay}\n                />\n            </Route>\n            <Route key={playPath} path={playPath}>\n                <Play song={props.song} onEdit={switchToEdit} />\n            </Route>\n        </>\n    );\n};\n\nexport default SongRouter;\n","import React from \"react\";\nimport { Typography, Theme } from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport grey from \"@material-ui/core/colors/grey\";\n\nconst PaddedTypography = withStyles((theme: Theme) => ({\n    root: {\n        position: \"absolute\",\n        top: 0,\n        right: 0,\n        padding: theme.spacing(1),\n        color: grey[600],\n    },\n}))(Typography);\n\nconst Version: React.FC<{}> = (): JSX.Element => {\n    const version: string = process.env.REACT_APP_VERSION ?? \"dev-build\";\n\n    return <PaddedTypography variant=\"subtitle2\">{version}</PaddedTypography>;\n};\n\nexport default Version;\n","import React, { useState } from \"react\";\nimport { ChordSong } from \"../common/ChordModel/ChordSong\";\n\ninterface SongProps {\n    song: ChordSong;\n    onSongChanged?: (song: ChordSong) => void;\n}\n\nexport const withSongContext = <P extends SongProps>(\n    OriginalComponent: React.FC<P>\n): React.FC<P> => {\n    return (props: P): JSX.Element => {\n        const [song, setSong] = useState<ChordSong>(props.song);\n\n        const handleSongChanged = (song: ChordSong) => {\n            setSong(song.clone());\n            props.onSongChanged?.(song);\n        };\n\n        const { song: throwawaySong, ...propsWithoutInitialSong } = props;\n\n        // https://github.com/microsoft/TypeScript/issues/35858\n        const originalComponentProps = {\n            ...propsWithoutInitialSong,\n            song: song,\n            onSongChanged: handleSongChanged,\n        } as P;\n\n        return <OriginalComponent {...originalComponentProps} />;\n    };\n};\n","import { tokenize } from \"./common/LyricTokenizer\";\nimport { ChordSong } from \"./common/ChordModel/ChordSong\";\nimport { ChordLine } from \"./common/ChordModel/ChordLine\";\nimport { ChordBlock } from \"./common/ChordModel/ChordBlock\";\n\nconst lyrics = [\n    \"We're no strangers to love\",\n    \"You know the rules and so do I\",\n    \"A full commitment's what I'm thinking of\",\n    \"You wouldn't get this from any other guy\",\n    \"I just wanna tell you how I'm feeling\",\n    \"Gotta make you understand\",\n    \"Never gonna give you up\",\n    \"Never gonna let you down\",\n    \"Never gonna run around and desert you\",\n    \"Never gonna make you cry\",\n    \"Never gonna say goodbye\",\n    \"Never gonna tell a lie and hurt you\",\n];\n\nconst chords = [\"A\", \"Bb7\", \"Cm\", \"D/C#\", \"Em7\", \"Fmaj7\", \"G^\"];\n\nconst randomChord = (): string => {\n    return chords[Math.floor(Math.random() * chords.length)];\n};\n\nconst chunk = (arr: string, tokenSize: number): string[] => {\n    const tokens = tokenize(arr);\n    const results: string[] = [];\n\n    for (let i = 0; i < tokens.length; i += tokenSize) {\n        const subArr = tokens.slice(i, i + tokenSize);\n        results.push(subArr.join(\"\"));\n    }\n\n    return results;\n};\n\nexport const NeverGonnaGiveYouUp = (): ChordSong => {\n    const chordLines: ChordLine[] = lyrics.map((lyricLine: string) =>\n        assembleLine(lyricLine)\n    );\n\n    return new ChordSong(chordLines, {\n        title: \"Never Gonna Give You Up\",\n        performedBy: \"Rick Astley\",\n        composedBy: \"Stock Aitken Waterman\",\n        asHeardFrom: \"https://www.youtube.com/watch?v=dM9zwZCOmjM\",\n    });\n};\n\nconst assembleLine = (lyrics: string): ChordLine => {\n    const lyricChunks = chunk(lyrics, 4);\n\n    const chordBlocks: ChordBlock[] = lyricChunks.map((lyricChunk: string) => {\n        return new ChordBlock({\n            chord: randomChord(),\n            lyric: lyricChunk,\n        });\n    });\n\n    return new ChordLine(chordBlocks);\n};\n","import {\n    createMuiTheme,\n    Grid,\n    PaletteColorOptions,\n    Theme,\n    ThemeProvider,\n} from \"@material-ui/core\";\nimport { withStyles } from \"@material-ui/styles\";\nimport { SnackbarProvider as UnstyledSnackbarProvider } from \"notistack\";\nimport React from \"react\";\nimport { Helmet, HelmetProvider } from \"react-helmet-async\";\nimport {\n    HashRouter,\n    Redirect,\n    Route,\n    Switch,\n    useLocation,\n} from \"react-router-dom\";\nimport WoodBackground from \"./assets/img/symphony.png\";\nimport About from \"./components/about/About\";\nimport SideMenu from \"./components/SideMenu\";\nimport SongRouter from \"./components/SongRouter\";\nimport { TutorialSwitches } from \"./components/Tutorial\";\nimport Version from \"./components/Version\";\nimport { withAutoSave } from \"./components/WithAutoSave\";\nimport { withSongContext } from \"./components/WithSongContext\";\nimport { NeverGonnaGiveYouUp } from \"./NeverGonnaGiveYouUp\";\n\nconst createTheme = (): Theme => {\n    const lightBlue: PaletteColorOptions = {\n        main: \"#4fc3f7\",\n        light: \"#8bf6ff\",\n        dark: \"#0093c4\",\n        contrastText: \"#000000\",\n    };\n\n    const purple: PaletteColorOptions = {\n        main: \"#844ffc\",\n        light: \"#bb7eff\",\n        dark: \"#4a1fc8\",\n        contrastText: \"#ffffff\",\n    };\n\n    const green: PaletteColorOptions = {\n        main: \"#00c853\",\n        light: \"#5efc82\",\n        dark: \"#009624\",\n        contrastText: \"#000000\",\n    };\n\n    return createMuiTheme({\n        palette: {\n            primary: lightBlue,\n            secondary: purple,\n            success: green,\n        },\n        typography: {\n            fontFamily: \"Merriweather\",\n            fontWeightRegular: 300,\n        },\n    });\n};\n\nconst theme: Theme = createTheme();\n\nconst SnackbarProvider = withStyles((theme: Theme) => ({\n    variantSuccess: {\n        backgroundColor: theme.palette.success.main,\n    },\n}))(UnstyledSnackbarProvider);\n\nconst AppLayout = withStyles({\n    root: {\n        backgroundImage: `url(${WoodBackground})`,\n        minHeight: \"100vh\",\n    },\n})(Grid);\n\nconst shouldShowMenu = (path: string): boolean => {\n    return ![\"/song/play\", \"/demo/play\"].includes(path);\n};\n\nconst MainSong = withAutoSave(withSongContext(SongRouter));\nconst DemoSong = withSongContext(SongRouter);\n\nconst AppContent: React.FC<{}> = (): JSX.Element => {\n    const location = useLocation();\n\n    const routes = (\n        <Switch>\n            <Redirect from=\"/\" to=\"/song\" exact />\n\n            <Redirect from=\"/song\" to=\"/song/edit\" exact />\n            <Route key=\"/song\" path=\"/song\">\n                <MainSong basePath=\"/song\" />\n            </Route>\n\n            <Redirect from=\"/demo\" to=\"/demo/edit\" exact />\n            <Route key=\"/demo\" path=\"/demo\">\n                <DemoSong basePath=\"/demo\" song={NeverGonnaGiveYouUp()} />\n            </Route>\n\n            {TutorialSwitches()}\n            <Route key=\"/about\" exact path=\"/about\">\n                <About />\n            </Route>\n            <Redirect to=\"/\" />\n        </Switch>\n    );\n\n    return (\n        <>\n            {shouldShowMenu(location.pathname) && <SideMenu />}\n            <AppLayout container>\n                <Grid item container justify=\"center\">\n                    {routes}\n                </Grid>\n            </AppLayout>\n            <Version />\n        </>\n    );\n};\n\nfunction App() {\n    return (\n        <HelmetProvider>\n            <ThemeProvider theme={theme}>\n                <Helmet\n                    titleTemplate=\"%s - Chord Paper\"\n                    defaultTitle=\"Chord Paper\"\n                />\n                <SnackbarProvider>\n                    <HashRouter>\n                        <AppContent />\n                    </HashRouter>\n                </SnackbarProvider>\n            </ThemeProvider>\n        </HelmetProvider>\n    );\n}\n\nexport default App;\n","import { ChordSong } from \"./ChordModel/ChordSong\";\nimport { Either, right } from \"fp-ts/lib/Either\";\n\nconst lastSavedKey = \"last-auto-saved-song\";\n\nexport const saveSong = (song: ChordSong) => {\n    const localStorage = window.localStorage;\n    const jsonStr = JSON.stringify(song);\n\n    localStorage.setItem(lastSavedKey, jsonStr);\n};\n\nexport const loadSong = (): Either<Error, ChordSong | null> => {\n    const localStorage = window.localStorage;\n\n    const jsonSong = localStorage.getItem(lastSavedKey);\n    if (jsonSong === null) {\n        return right(null);\n    }\n\n    return ChordSong.deserialize(jsonSong);\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      process.env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' }\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}