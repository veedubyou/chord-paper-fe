(this["webpackJsonpchord-paper-fe"]=this["webpackJsonpchord-paper-fe"]||[]).push([[0],{183:function(e,t,n){e.exports=n.p+"static/media/symphony.4ca23f9c.png"},185:function(e){e.exports=JSON.parse('{"id":"","owner":"","lastSavedAt":null,"elements":[{"elements":[{"chord":"G^","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"\ue100"},"type":"ChordBlock"},{"chord":"Em7","lyric":{"serializedLyric":"\ue100|"},"type":"ChordBlock"},{"chord":"Bm7b13/D","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"C13","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"}],"type":"ChordLine","label":"Intro"},{"elements":[{"chord":"G^","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"},{"chord":"B7","lyric":{"serializedLyric":"\ue400|"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"We\'re no strangers to "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"love"},"type":"ChordBlock"}],"type":"ChordLine","label":"Verse"},{"elements":[{"chord":"F#m7","lyric":{"serializedLyric":"You know the rules and "},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"so do I"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"A full commitment\'s what I\'m "},"type":"ChordBlock"},{"chord":"C7","lyric":{"serializedLyric":"thinking of"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Bm7","lyric":{"serializedLyric":"You wouldn\'t get this from "},"type":"ChordBlock"},{"chord":"E7","lyric":{"serializedLyric":"any other guy"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"I just wanna "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"tell you how I\'m feeling"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Gotta make you "},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"understand"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"Em9","lyric":{"serializedLyric":"give you up"},"type":"ChordBlock"}],"type":"ChordLine","label":"Chorus"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"let you down"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"run around and de-"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"sert you"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"Em9","lyric":{"serializedLyric":"make you cry"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"say goodbye"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"tell a lie and "},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"hurt you"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"We\'ve known each other"},"type":"ChordBlock"},{"chord":"C7","lyric":{"serializedLyric":" for so long"},"type":"ChordBlock"}],"type":"ChordLine","label":"Verse"},{"elements":[{"chord":"Bm7","lyric":{"serializedLyric":"Your heart\'s been aching but "},"type":"ChordBlock"},{"chord":"E7","lyric":{"serializedLyric":"you\'re too shy to say it"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"Inside we both know what\'s been "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"going on"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Bm7","lyric":{"serializedLyric":"We know the game and we\'re"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":" gon-"},"type":"ChordBlock"},{"chord":"A7/C#","lyric":{"serializedLyric":"na "},"type":"ChordBlock"},{"chord":"D7","lyric":{"serializedLyric":"play it"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"G","lyric":{"serializedLyric":"And if you "},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":"ask me how I\'m feeling"},"type":"ChordBlock"},{"chord":"G","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Don\'t tell me you\'re too "},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":"blind to see"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"C#m11","lyric":{"serializedLyric":"give you "},"type":"ChordBlock"},{"chord":"F#7","lyric":{"serializedLyric":"up"},"type":"ChordBlock"}],"type":"ChordLine","label":"Chorus"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"let you down"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"G","lyric":{"serializedLyric":"run a-"},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":"round and de-"},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"sert you"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"G^","lyric":{"serializedLyric":"run a-"},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"round and de-"},"type":"ChordBlock"},{"chord":"B7","lyric":{"serializedLyric":"sert you"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"C7","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"},{"chord":"E7","lyric":{"serializedLyric":"\ue200|"},"type":"ChordBlock"}],"type":"ChordLine","label":"Guitar Solo"},{"elements":[{"chord":"Em7","lyric":{"serializedLyric":"Never gonna give, never gonna give"},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"Bm7","lyric":{"serializedLyric":"Never gonna give, never gonna give"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"\ue100"},"type":"ChordBlock"},{"chord":"A7/C#","lyric":{"serializedLyric":"\ue100"},"type":"ChordBlock"},{"chord":"D7","lyric":{"serializedLyric":"\ue100"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"G","lyric":{"serializedLyric":"We\'ve known each other "},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":"for so long"},"type":"ChordBlock"}],"type":"ChordLine","label":"Verse"},{"elements":[{"chord":"G","lyric":{"serializedLyric":"Your heart\'s been aching but "},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":"you\'re too shy to say it"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"C#m7","lyric":{"serializedLyric":"Inside we "},"type":"ChordBlock"},{"chord":"F#7","lyric":{"serializedLyric":"both know what\'s been"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":" going on"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"G","lyric":{"serializedLyric":"We know the "},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":"game and we\'re"},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":" gonna "},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"play it"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"G","lyric":{"serializedLyric":"I just wanna "},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":"tell you how I\'m feeling"},"type":"ChordBlock"},{"chord":"G","lyric":{"serializedLyric":"\ue200"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Gotta make you"},"type":"ChordBlock"},{"chord":"A","lyric":{"serializedLyric":" understand"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"G^","lyric":{"serializedLyric":"give you "},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"up and de-"},"type":"ChordBlock"},{"chord":"B7","lyric":{"serializedLyric":"sert you"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"Em9","lyric":{"serializedLyric":"give you up"},"type":"ChordBlock"}],"type":"ChordLine","label":"Outro"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"let you down"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"run around and de-"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"sert you"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"Em9","lyric":{"serializedLyric":"make you cry"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"say goodbye"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"tell a lie and "},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"hurt you"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"Em9","lyric":{"serializedLyric":"give you up"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"let you down"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"run around and de-"},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"sert you"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"Em9","lyric":{"serializedLyric":"make you cry"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"A7","lyric":{"serializedLyric":"say goodbye"},"type":"ChordBlock"}],"type":"ChordLine"},{"elements":[{"chord":"","lyric":{"serializedLyric":"Never gonna "},"type":"ChordBlock"},{"chord":"F#m7","lyric":{"serializedLyric":"tell a lie and "},"type":"ChordBlock"},{"chord":"Bm7","lyric":{"serializedLyric":"hurt you..."},"type":"ChordBlock"}],"type":"ChordLine"}],"metadata":{"title":"Never Gonna Give You Up x Plastic Love","composedBy":"Stock Aitken Waterman x Mariya Takeuchi","performedBy":"Rick Astley  x Mariya Takeuchi"}}')},198:function(e,t,n){e.exports=n.p+"static/media/error.c3a3f87e.jpeg"},211:function(e,t,n){e.exports=n.p+"static/media/google_signin.c386978e.svg"},248:function(e,t,n){e.exports=n(310)},255:function(e,t,n){},310:function(e,t,n){"use strict";n.r(t);var r,a,o,i=n(0),l=n.n(i),c=n(36),u=n.n(c),s=(n(255),n(11)),d=n(220),h=n(361),m=n(385),f=n(312),p=n(50),y=n(85),v=n(43),b=n(55),g=n(183),k=n.n(g),E=n(16),w=n(98),C=n(3),O=n(4),j=n(8),L=n(1),S=n(2),B=n(21),T=n(184),x=n(23),D=n(360),I=n(51),F=n.n(I),P=n(79),A=n.n(P),z=n(19),R=n(40),N=n(30),_=n(359),M=n(107),U=n.n(M);!function(e){e[e.SmallTab=0]="SmallTab",e[e.MediumTab=1]="MediumTab",e[e.LargeTab=2]="LargeTab"}(o||(o={}));var K=[Object(N.a)({sizedTab:o.SmallTab,serializedStr:"\ue100"},"data-lyrictabtype","1"),Object(N.a)({sizedTab:o.MediumTab,serializedStr:"\ue200"},"data-lyrictabtype","2"),Object(N.a)({sizedTab:o.LargeTab,serializedStr:"\ue400"},"data-lyrictabtype","4")],V=function findTabType(e,t){var n=K.find((function(n){return n[e]===t}));if(void 0===n)throw new Error("Unexpectedly can't find tab type by ".concat(e));return n},W=function isValidTabValue(e,t){return void 0!==K.find((function(n){return n[e]===t}))},G=function lyricTabTypeOfDOMNode(e){if(e instanceof HTMLElement&&"span"===e.tagName.toLowerCase()){var t=e.dataset.lyrictabtype;if(W("data-lyrictabtype",t))return V("data-lyrictabtype",t).sizedTab}return null},J=function sizeStyleFn(e){return{root:{display:"inline-block",width:"".concat(1.5*e,"em")}}},H=function makeSizeStyle(e){return Object(_.a)(J(e))},q=(r={},Object(N.a)(r,o.SmallTab,H(1)),Object(N.a)(r,o.MediumTab,H(2)),Object(N.a)(r,o.LargeTab,H(4)),r),Y=function makeEditingSizeStyle(e){var t=J(e);return Object(_.a)({root:Object(j.a)({backgroundColor:U.a[100],"&:before":{content:'"\\a0"'},margin:"0.05em"},t.root)})},$=(a={},Object(N.a)(a,o.SmallTab,Y(1)),Object(N.a)(a,o.MediumTab,Y(2)),Object(N.a)(a,o.LargeTab,Y(4)),a),X=function useEditingSizeMap(){var e;return e={},Object(N.a)(e,o.SmallTab,$[o.SmallTab]()),Object(N.a)(e,o.MediumTab,$[o.MediumTab]()),Object(N.a)(e,o.LargeTab,$[o.LargeTab]()),e},Q=function Tab(e){var t=function useSizeMap(){var e;return e={},Object(N.a)(e,o.SmallTab,q[o.SmallTab]()),Object(N.a)(e,o.MediumTab,q[o.MediumTab]()),Object(N.a)(e,o.LargeTab,q[o.LargeTab]()),e}(),n=X(),r=e.edit?n:t,a=V("sizedTab",e.type);return l.a.createElement("span",{className:r[e.type].root,contentEditable:"false","data-lyrictabtype":a["data-lyrictabtype"]})},Z=function isWhitespace(e){return/^\s+$/.test(e)},ee=function inflateIfEmpty(e){return Z(e)?"\xa0":e},te=x.k({serializedLyric:x.i}),ne=function(){var e,t="",n=Object(z.a)(K);try{for(n.s();!(e=n.n()).done;){var r=e.value;t+="(".concat(r.serializedStr,")|")}}catch(a){n.e(a)}finally{n.f()}return t="(".concat(t+="(\\w|')+|[^w]",")"),new RegExp(t,"g")}(),re=function(){function Lyric(e){Object(L.a)(this,Lyric),this.serializedLyric=void 0,this.serializedLyric=e}return Object(S.a)(Lyric,[{key:"get",value:function get(e){return e(this.serializedLyric)}},{key:"tokenize",value:function tokenize(){var e=this.serializedLyric.match(ne);if(null===e)return Object(R.a)();var t=e.map((function(e){return new Lyric(e)}));return Object(R.a)(t)}},{key:"append",value:function append(e){return new Lyric("string"===typeof e?this.serializedLyric+e:this.serializedLyric+e.serializedLyric)}},{key:"isEmpty",value:function isEmpty(){return""===this.serializedLyric}},{key:"isEntirelySpace",value:function isEntirelySpace(){return Z(this.serializedLyric)||W("serializedStr",this.serializedLyric)}},{key:"isEqual",value:function isEqual(e){return this.serializedLyric===e.serializedLyric}}],[{key:"join",value:function join(e,t){return new Lyric(e.map((function(e){return e.serializedLyric})).join(t))}},{key:"fromValidatedFields",value:function fromValidatedFields(e){return new Lyric(e.serializedLyric)}}]),Lyric}(),ae=x.k({chord:x.i,lyric:te,type:x.e("ChordBlock")}),oe={id:"",chord:"",lyric:new re(""),type:"ChordBlock"},ie=Object(R.b)(oe),le=function(){function ChordBlock(e){if(Object(L.a)(this,ChordBlock),this.record=void 0,ChordBlock.isChordBlockRecord(e))this.record=e;else{var t=e.chord,n=e.lyric;this.record=new ie({id:A.a.generate(),chord:t,lyric:n,type:"ChordBlock"})}}return Object(S.a)(ChordBlock,[{key:"new",value:function _new(e){return e===this.record?this:new ChordBlock(e)}},{key:"set",value:function set(e,t){var n=this.record.set(e,t);return this.new(n)}},{key:"update",value:function update(e,t){var n=this.record.update(e,t);return this.new(n)}},{key:"toJSON",value:function toJSON(){var e=this.record.toJS();return F.a.omit(e,"id")}},{key:"splitByTokenIndex",value:function splitByTokenIndex(e){if(0===e)throw new Error("Split index can't be zero");var t=this.lyricTokens,n=t.slice(0,e),r=t.slice(e);return[new ChordBlock({chord:this.chord,lyric:re.join(n,"")}),this.set("chord","").set("lyric",re.join(r,""))]}},{key:"splitByCharIndex",value:function splitByCharIndex(e){if(0===e)return[new ChordBlock({chord:"",lyric:new re("")}),this];var t=this.lyric.get((function(e){return e})),n=new re(t.slice(0,e)),r=new re(t.slice(e));return[new ChordBlock({chord:this.chord,lyric:n}),this.set("chord","").set("lyric",r)]}},{key:"contentEquals",value:function contentEquals(e){return this.chord===e.chord&&this.lyric.isEqual(e.lyric)}},{key:"isEmpty",value:function isEmpty(){return""===this.chord&&this.lyric.isEmpty()}},{key:"lyricLength",value:function lyricLength(){return this.lyric.get((function(e){return e})).length}},{key:"id",get:function get(){return this.record.id}},{key:"lyric",get:function get(){return this.record.lyric}},{key:"chord",get:function get(){return this.record.chord}},{key:"type",get:function get(){return this.record.type}},{key:"lyricTokens",get:function get(){return this.lyric.tokenize()}}],[{key:"isChordBlockRecord",value:function isChordBlockRecord(e){return R.b.isRecord(e)}},{key:"fromValidatedFields",value:function fromValidatedFields(e){var t=e.lyric,n=re.fromValidatedFields(t);return new ChordBlock({chord:e.chord,lyric:n})}},{key:"deserialize",value:function deserialize(e){var t=Object(B.parseJSON)(e,(function(){return new Error("Failed to parse json string")}));if(Object(B.isLeft)(t))return t;var n=t.right,r=ae.decode(n);if(Object(B.isLeft)(r))return Object(B.left)(new Error("Invalid Chord Block object"));var a=r.right.lyric,o=re.fromValidatedFields(a);return Object(B.right)(new ChordBlock({chord:r.right.chord,lyric:o}))}}]),ChordBlock}(),ce=n(111),ue=function(){function CollectionMethods(){Object(L.a)(this,CollectionMethods)}return Object(S.a)(CollectionMethods,[{key:"getElement",value:function getElement(){var e;return(e=this.elements).get.apply(e,arguments)}},{key:"getElementAtIndex",value:function getElementAtIndex(){var e;return(e=this.elements).getAtIndex.apply(e,arguments)}},{key:"setElement",value:function setElement(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.set.apply(e,t)}))}},{key:"replaceElement",value:function replaceElement(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.replace.apply(e,t)}))}},{key:"removeElement",value:function removeElement(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.remove.apply(e,t)}))}},{key:"removeMultipleElements",value:function removeMultipleElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.removeMultiple.apply(e,t)}))}},{key:"updateElement",value:function updateElement(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.update.apply(e,t)}))}},{key:"updateAllElements",value:function updateAllElements(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.updateAll.apply(e,t)}))}},{key:"addBeginning",value:function addBeginning(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.addBeginning.apply(e,t)}))}},{key:"addAfter",value:function addAfter(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.updateCollection((function(e){return e.addAfter.apply(e,t)}))}}]),CollectionMethods}(),se=function(){function Collection(e){Object(L.a)(this,Collection),this.list=void 0,void 0!==e?R.a.isList(e)?this.list=e:this.list=R.a.of.apply(R.a,Object(E.a)(e)):this.list=Object(R.a)()}return Object(S.a)(Collection,[{key:"toJSON",value:function toJSON(){return this.list.toJSON()}},{key:"new",value:function _new(e){return e===this.list?this:new Collection(e)}},{key:"toArray",value:function toArray(){return this.list.toArray()}},{key:"transform",value:function transform(e){var t=e(this.list);return this.new(t)}},{key:"indexOf",value:function indexOf(e){return Collection.indexOf(this.list,e)}},{key:"multiIndexOf",value:function multiIndexOf(e){return e.map(this.indexOf)}},{key:"set",value:function set(){var e,t=(e=this.list).set.apply(e,arguments);return this.new(t)}},{key:"update",value:function update(e,t){var n=this.list.update(e,(function wrappedUpdater(e){if(void 0===e)throw new Error("Can't have undefined indices");return t(e)}));return this.new(n)}},{key:"updateAll",value:function updateAll(e){var t=this.list.withMutations((function(t){for(var n=function _loop(n){t.update(n,(function(t){return function wrappedUpdater(t,n){if(void 0===t)throw new Error("Can't have undefined indices");return e(t,n)}(t,n)}))},r=0;r<t.size;r++)n(r)}));return this.new(t)}},{key:"addAfter",value:function addAfter(e){for(var t,n=this.indexOf(e.id),r=arguments.length,a=new Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];var i=(t=this.list).splice.apply(t,[n+1,0].concat(a));return this.new(i)}},{key:"addBeginning",value:function addBeginning(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=(e=this.list).splice.apply(e,[0,0].concat(n));return this.new(a)}},{key:"remove",value:function remove(e){var t=this.indexOf(e.id),n=this.list.splice(t,1);return this.new(n)}},{key:"removeMultiple",value:function removeMultiple(e){var t=this.list;return e.forEach((function(e){var n=Collection.indexOf(t,e.id);t=t.delete(n)})),this.new(t)}},{key:"splice",value:function splice(e,t){for(var n,r=this.indexOf(e.id),a=arguments.length,o=new Array(a>2?a-2:0),i=2;i<a;i++)o[i-2]=arguments[i];var l=(n=this.list).splice.apply(n,[r,t].concat(o));return this.new(l)}},{key:"replace",value:function replace(e,t){var n=this.indexOf(e.id),r=this.list.update(n,(function updater(e){if(void 0===e)throw new Error("Item can't be undefined because index is valid");return t(e)}));return this.new(r)}},{key:"forEach",value:function forEach(){var e;(e=this.list).forEach.apply(e,arguments)}},{key:"get",value:function get(e){var t=this.indexOf(e.id),n=this.list.get(t);if(void 0===n)throw new Error("Index found but item not in list");return n}},{key:"getAtIndex",value:function getAtIndex(e){var t=this.list.get(e);if(void 0===t)throw new Error("Item not in list");return t}},{key:"length",get:function get(){return this.list.size}}],[{key:"indexOf",value:function indexOf(e,t){var n=e.findIndex((function(e){return e.id===t}));if(n<0)throw new Error("Can't find element inside collection");return n}}]),Collection}(),de=function(){var e=new ce.DiffMatchPatch;return e.diffTimeout=0,e.matchThreshold=0,e}(),he=function rawStringGetter(e){return e},me=function(){function ChordLineIterator(e){Object(L.a)(this,ChordLineIterator),this.chordLine=void 0,this.currBlockIndex=void 0,this.currCharIndex=void 0,this.blockBuffer=void 0,this.prependLyrics=void 0,this.chordLine=e,this.currBlockIndex=0,this.currCharIndex=0,this.blockBuffer=e.chordBlocks.list.map((function(){return""})).toArray(),this.prependLyrics=""}return Object(S.a)(ChordLineIterator,[{key:"atBlockBoundary",value:function atBlockBoundary(){return 0===this.currCharIndex}},{key:"currentBlock",value:function currentBlock(){return this.chordLine.getElementAtIndex(this.currBlockIndex)}},{key:"currentRawLyrics",value:function currentRawLyrics(){return this.currentBlock().lyric.get(he)}},{key:"currentChar",value:function currentChar(){return this.currentRawLyrics().charAt(this.currCharIndex)}},{key:"nextChar",value:function nextChar(){this.currCharIndex+=1,this.currCharIndex>=this.currentRawLyrics().length&&(this.currBlockIndex+=1,this.currCharIndex=0)}},{key:"skip",value:function skip(e){if(this.currentChar()!==e)throw new Error("Mismatched characters when skipping");this.blockBuffer[this.currBlockIndex]+=e,this.nextChar()}},{key:"insert",value:function insert(e){if(this.atBlockBoundary()){var t=this.currBlockIndex-1;t>=0?this.blockBuffer[t]+=e:this.prependLyrics+=e}else this.blockBuffer[this.currBlockIndex]+=e}},{key:"delete",value:function _delete(e){if(this.currentChar()!==e)throw new Error("Mismatched characters when deleting");this.nextChar()}},{key:"finish",value:function finish(){var e=this;return this.chordLine=this.chordLine.updateAllElements((function(t,n){var r=new re(e.blockBuffer[n]);return t.set("lyric",r)})),""!==this.prependLyrics&&(this.chordLine=this.chordLine.addBeginning(new le({chord:"",lyric:new re(this.prependLyrics)}))),this.chordLine.normalizeBlocks()}}]),ChordLineIterator}(),fe=V("sizedTab",o.SmallTab).serializedStr,pe=function replaceChordLineLyrics(e,t){var n=e.lyrics.get(he),r=t.get(he),a=de.diff_main(n,r);de.diff_cleanupSemanticLossless(a);var o,i=new me(e),l=Object(z.a)(a);try{for(l.s();!(o=l.n()).done;){var c,u=o.value,s=u[0],d=Object(z.a)(u[1]);try{for(d.s();!(c=d.n()).done;){var h=c.value;switch(s){case ce.DiffOperation.DIFF_EQUAL:i.skip(h);break;case ce.DiffOperation.DIFF_INSERT:i.insert(h);break;case ce.DiffOperation.DIFF_DELETE:i.delete(h)}}}catch(m){d.e(m)}finally{d.f()}}}catch(m){l.e(m)}finally{l.f()}return e=function addTabsToOrphanedBlocks(e){return e.updateAllElements((function orphanTabBlockIfEmpty(e){return e.lyric.isEmpty()?e.set("lyric",new re(fe)):e}))}(e=function removeOrphanedBlocksWithNoChords(e){var t,n=[],r=Object(z.a)(e.chordBlocks.toArray());try{for(r.s();!(t=r.n()).done;){var a=t.value;a.lyric.isEmpty()&&""===a.chord||n.push(a)}}catch(m){r.e(m)}finally{r.f()}return e.updateCollection((function(){return new se(n)}))}(e=i.finish()))},ye=x.k({elements:x.b(ae),type:x.e("ChordLine")}),ve=x.k({type:x.e("label"),name:x.i}),be=x.k({type:x.e("time"),name:x.i,time:x.g}),ge=x.l([ve,be]),ke=x.h({label:x.i,section:ge}),Ee=x.d([ye,ke]),we=function timeSectionSortFn(e,t){return e.time<t.time?-1:e.time>t.time?1:0},Ce={id:"",section:void 0,elements:new se,type:"ChordLine"},Oe=Object(R.b)(Ce),je=function(e){Object(C.a)(ChordLine,e);var t=Object(O.a)(ChordLine);function ChordLine(e){var n,r;return Object(L.a)(this,ChordLine),(n=t.call(this)).record=void 0,ChordLine.isChordLineRecord(e)?(n.record=e,Object(w.a)(n)):(r=void 0===e.blocks?new se([new le({chord:"",lyric:new re("")})]):e.blocks instanceof se?e.blocks:new se(e.blocks),n.record=Oe({id:A.a.generate(),type:"ChordLine",section:e.section,elements:r}),n)}return Object(S.a)(ChordLine,[{key:"toJSON",value:function toJSON(){var e=this.record.toJSON();return F.a.omit(e,"id")}},{key:"forCopying",value:function forCopying(){return this.set("section",void 0)}},{key:"new",value:function _new(e){return e===this.record?this:new ChordLine(e)}},{key:"updateCollection",value:function updateCollection(e){return this.update("elements",e)}},{key:"set",value:function set(e,t){var n=this.record.set(e,t);return this.new(n)}},{key:"update",value:function update(e,t){var n=this.record.update(e,t);return this.new(n)}},{key:"replaceLyrics",value:function replaceLyrics(e){return this.lyrics.isEqual(e)?this:pe(this,e)}},{key:"setChord",value:function setChord(e,t){return this.replaceElement(e,(function(e){return e.set("chord",t)})).normalizeBlocks()}},{key:"removeSectionName",value:function removeSectionName(){return void 0===this.section?[this,!1]:[this.set("section",void 0),!0]}},{key:"setSectionName",value:function setSectionName(e){return""===e?this.removeSectionName():void 0===this.section?[this.set("section",{type:"label",name:e}),!0]:[this.update("section",(function(t){if(void 0===t)throw new Error("Impossible");return Object(j.a)(Object(j.a)({},t),{},{name:e})})),!0]}},{key:"removeSectionTime",value:function removeSectionTime(){return void 0===this.section?[this,!1]:[this.set("section",{type:"label",name:this.section.name}),!0]}},{key:"setSectionTime",value:function setSectionTime(e){if(null===e)return this.removeSectionTime();var t=void 0!==this.section?this.section.name:"";return[this.set("section",{type:"time",name:t,time:e}),!0]}},{key:"splitBlock",value:function splitBlock(e,t){var n=this.elements.get(e).splitByTokenIndex(t),r=Object(s.a)(n,2),a=r[0],o=r[1];return this.updateCollection((function(t){return t.splice(e,1,a,o)}))}},{key:"splitByCharIndex",value:function splitByCharIndex(e){var t=this;if(0===e){var n=new ChordLine({blocks:this.chordBlocks});return[this.updateCollection((function(){return new se([new le({chord:"",lyric:new re("")})])})),n]}var r=this.lyrics.get((function(e){return e})).length;if(e>=r)return[this,new ChordLine({})];var a=function(){for(var n=e,r=0;r<t.elements.length;r++){var a=t.elements.getAtIndex(r).lyricLength();if(!(n-a>=0))return[n,r];n-=a}throw new Error("Unexpected: shouldn't have walked this many characters")}(),o=Object(s.a)(a,2),i=o[0],l=o[1],c=this.elements.transform((function(e){return e.slice(0,l)})),u=new se;if(i>0){var d=this.elements.getAtIndex(l).splitByCharIndex(i),h=Object(s.a)(d,2),m=h[0],f=h[1];c=c.transform((function(e){return e.push(m)})),u=u.transform((function(e){return e.push(f)}));var p=this.elements.transform((function(e){return e.slice(l+1)}));u=u.transform((function(e){return e.push.apply(e,Object(E.a)(p.toArray()))}))}else u=this.elements.transform((function(e){return e.slice(l)}));return[this.set("elements",c),new ChordLine({blocks:u})]}},{key:"normalizeBlocks",value:function normalizeBlocks(){var e=[];return this.elements.forEach((function(t){var n=e.length>0;if(""===t.chord&&n){var r=e.length-1;e[r]=e[r].update("lyric",(function(e){return e.append(t.lyric)}))}else e.push(t)})),e.length===this.elements.length?this:this.set("elements",new se(e))}},{key:"contentEquals",value:function contentEquals(e){if(this.chordBlocks.length!==e.chordBlocks.length)return!1;if(!F.a.isEqual(this.section,e.section))return!1;var t=!0;return this.chordBlocks.forEach((function(n,r){var a=e.chordBlocks.getAtIndex(r);if(!n.contentEquals(a))return t=!1,!1})),t}},{key:"isEmpty",value:function isEmpty(){return!(this.chordBlocks.length>1)&&(0===this.chordBlocks.length||this.chordBlocks.getAtIndex(0).isEmpty())}},{key:"id",get:function get(){return this.record.id}},{key:"type",get:function get(){return this.record.type}},{key:"section",get:function get(){return this.record.section}},{key:"elements",get:function get(){return this.record.elements}},{key:"chordBlocks",get:function get(){return this.elements}},{key:"lyrics",get:function get(){var e=this.chordBlocks.list.map((function(e){return e.lyric}));return re.join(e,"")}}],[{key:"isChordLineRecord",value:function isChordLineRecord(e){return R.b.isRecord(e)}},{key:"sectionFromLabel",value:function sectionFromLabel(e){if(void 0!==e)return{type:"label",name:e}}},{key:"fromValidatedFields",value:function fromValidatedFields(e){var t=e.elements.map((function(e){return le.fromValidatedFields(e)})),n=e.section;return void 0===n&&(n=this.sectionFromLabel(e.label)),new ChordLine({blocks:new se(t),section:n})}},{key:"deserialize",value:function deserialize(e){var t=Object(B.parseJSON)(e,(function(){return new Error("Failed to parse json string")}));if(Object(B.isLeft)(t))return t;var n=t.right,r=Ee.decode(n);return Object(B.isLeft)(r)?Object(B.left)(new Error("Invalid Chord Line object")):Object(B.right)(this.fromValidatedFields(r.right))}},{key:"fromLyrics",value:function fromLyrics(e){var t=new le({chord:"",lyric:e});return new ChordLine({blocks:new se([t])})}}]),ChordLine}(ue);function mapObjectKey(e,t){return mapObject(e,(function(e,n){return t(n)}))}function mapObject(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){var a=e[r];n[r]=t(a,r)}return n}var Le,Se=function assertFound(e){if(-1===e)throw new Error("Thing that should be found is not found")},Be=function checkWholeNumber(e){if(e%1!==0)throw new Error("input isn't a whole number!")},Te=function modulo(e,t){return(e%t+t)%t},xe=function asSemitone(e){return Be(e),Te(e,12)},De={C:void 0,Cb:void 0,"C#":void 0,D:void 0,Db:void 0,"D#":void 0,E:void 0,Eb:void 0,"E#":void 0,F:void 0,Fb:void 0,"F#":void 0,G:void 0,Gb:void 0,"G#":void 0,A:void 0,Ab:void 0,"A#":void 0,B:void 0,Bb:void 0,"B#":void 0},Ie=["C","D","E","F","G","A","B"],Fe=[["C","B#"],["Db","C#"],["D"],["Eb","D#"],["E","Fb"],["F","E#"],["Gb","F#"],["G"],["Ab","G#"],["A"],["Bb","A#"],["B","Cb"]],Pe=function getNoteLetter(e){var t=e.charAt(0);if(!Ie.includes(t))throw new Error("Note letter reduction function failed");return t},Ae=function(){function NoteUtility(e){var t=this;Object(L.a)(this,NoteUtility),this.note=void 0,this.chromaticNoteIndex=void 0,this.noteLetter=void 0,this.noteLetterIndex=void 0,this.note=e;var n=Fe.findIndex((function(e){return e.includes(t.note)}));Se(n),this.chromaticNoteIndex=n,this.noteLetter=Pe(e);var r=Ie.findIndex((function(e){return e===t.noteLetter}));Se(r),this.noteLetterIndex=r}return Object(S.a)(NoteUtility,[{key:"semitonesUp",value:function semitonesUp(e){var t=(this.chromaticNoteIndex+e)%Fe.length;return Fe[t]}},{key:"semitonesBetween",value:function semitonesBetween(e){var t=Fe.findIndex((function(t){return t.includes(e)}));return Se(t),xe(t-this.chromaticNoteIndex)}},{key:"isEnharmonicTo",value:function isEnharmonicTo(e){return 0===this.semitonesBetween(e)}},{key:"noteNameFrom",value:function noteNameFrom(e){var t=(this.noteLetterIndex+e)%Ie.length;return Ie[t]}},{key:"degreesBetween",value:function degreesBetween(e){var t=Pe(e),n=Ie.findIndex((function(e){return e===t}));return Se(n),function asDegree(e){return Be(e),Te(e,7)}(n-this.noteLetterIndex)}}]),NoteUtility}(),ze=mapObjectKey(De,(function(e){return new Ae(e)})),Re=function(){function IntervalUtility(e){Object(L.a)(this,IntervalUtility),this.interval=void 0,this.interval=e}return Object(S.a)(IntervalUtility,[{key:"semitones",get:function get(){var e=Ye(this.interval),t=Ne[e];return Xe.minor(this.interval)?t-=1:Xe.augmented(this.interval)?t+=1:Xe.doubleAugmented(this.interval)?t+=2:Xe.tripleAugmented(this.interval)?t+=3:Xe.diminished(this.interval)?t-=2:Xe.doubleDiminished(this.interval)&&(t-=3),xe(t)}},{key:"degree",get:function get(){var e=Ye(this.interval);return Me[e]}}]),IntervalUtility}(),Ne={1:0,2:2,3:4,4:5,5:7,6:9,7:11},_e=function findNaturalIntervalByDegree(e){var t;for(t in Me)if(Me[t]===e)return t;throw new Error("Invalid number distance passed in")},Me={1:0,2:1,3:2,4:3,5:4,6:5,7:6},Ue={1:void 0,2:void 0,3:void 0,4:void 0,5:void 0,6:void 0,7:void 0},Ke={b1:void 0,b2:void 0,b3:void 0,b4:void 0,b5:void 0,b6:void 0,b7:void 0},Ve={"#1":void 0,"#2":void 0,"#3":void 0,"#4":void 0,"#5":void 0,"#6":void 0,"#7":void 0},We={"##1":void 0,"##2":void 0,"##3":void 0,"##4":void 0,"##5":void 0,"##6":void 0,"##7":void 0},Ge={"###4":void 0},Je={bb1:void 0,bb2:void 0,bb3:void 0,bb4:void 0,bb5:void 0,bb6:void 0,bb7:void 0},He={bbb2:void 0,bbb3:void 0,bbb5:void 0,bbb6:void 0,bbb7:void 0},qe=Object(j.a)(Object(j.a)(Object(j.a)(Object(j.a)(Object(j.a)(Object(j.a)(Object(j.a)({},Ue),Ke),Ve),Je),We),He),Ge),Ye=(mapObjectKey(qe,(function(e){return new Re(e)})),function unqualifiedInterval(e){return e.charAt(e.length-1)}),$e=function checkIntervalType(e,t){for(var n in t)if(n===e)return!0;return!1},Xe={minor:function minor(e){return $e(e,Ke)},augmented:function augmented(e){return $e(e,Ve)},diminished:function diminished(e){return $e(e,Je)},doubleAugmented:function doubleAugmented(e){return $e(e,We)},doubleDiminished:function doubleDiminished(e){return $e(e,He)},tripleAugmented:function tripleAugmented(e){return $e(e,Ge)}},Qe=function intervalToNote(e,t){var n,r=new Re(t),a=r.semitones,o=r.degree,i=ze[e],l=i.semitonesUp(a),c=i.noteNameFrom(o),u=Object(z.a)(l);try{for(u.s();!(n=u.n()).done;){var s=n.value;if(Pe(s)===c)return s}}catch(d){u.e(d)}finally{u.f()}return l[0]},Ze=function noteToInterval(e,t){var n=ze[e];return function findInterval(e,t){var n=_e(t),r=Ne[n],a=xe(e-r);if(a===xe(0))return n;if(a===xe(1))return"#".concat(n);if(a===xe(2))return"##".concat(n);if("4"===n&&a===xe(3))return"###".concat(n);if(a===xe(-1))return"b".concat(n);if(a===xe(-2))return"bb".concat(n);if(("2"===n||"3"===n||"5"===n||"6"===n||"7"===n)&&a===xe(-3))return"bbb".concat(n);throw new Error("No matching interval for semitone and number distance")}(n.semitonesBetween(t),n.degreesBetween(t))},et=mapObjectKey(De,(function(e){return function intervalsToNotesOfRootNote(e){return mapObjectKey(qe,(function(t){return Qe(e,t)}))}(e)})),tt=mapObjectKey(De,(function(e){return function notesToIntervalsOfRootNote(e){return mapObjectKey(De,(function(t){return Ze(e,t)}))}(e)})),nt=function transposeSymbol(e,t,n){var r,a=[];for(r in De)e.startsWith(r)&&a.push(r);if(0===a.length)return e;for(var o=a[0],i=0,l=a;i<l.length;i++){var c=l[i];c.length>o.length&&(o=c)}var u=function transposeNote(e,t,n){var r=tt[t][e];return et[n][r]}(o,t,n);return e.replace(o,u)},rt=function transposeSong(e,t,n){var r=function transposeBlock(e){return""===e.chord?e:e.update("chord",(function(e){return function transposeChord(e,t,n){var r=null,a=e;if(e.includes("/")){var o=e.split("/");a=o[0],r=o.slice(1).join("/")}return a=nt(a,t,n),null===r?a:a+"/"+(r=nt(r,t,n))}(e,t,n)}))};return e.updateAllElements((function(e){return e.updateAllElements((function(e){return r(e)}))}))},at=x.k({title:x.i,composedBy:x.i,performedBy:x.i}),ot={id:x.i,owner:x.i,lastSavedAt:x.l([D.a,x.f]),metadata:at},it=x.k(ot),lt=x.b(it),ct=function(){function SongSummary(e){if(Object(L.a)(this,SongSummary),this.id=void 0,this.owner=void 0,this.lastSavedAt=void 0,this.metadata=void 0,void 0===e)return this.id="",this.owner="",this.metadata={title:"",composedBy:"",performedBy:""},void(this.lastSavedAt=null);this.id=e.id,this.owner=e.owner,this.metadata=e.metadata,this.lastSavedAt=e.lastSavedAt}return Object(S.a)(SongSummary,null,[{key:"fromJSONObject",value:function fromJSONObject(e){var t=it.decode(e);return Object(B.isLeft)(t)?Object(B.left)(new Error("Invalid Song Summary object")):Object(B.right)(new SongSummary(Object(j.a)({},t.right)))}},{key:"fromJSONList",value:function fromJSONList(e){var t=lt.decode(e);if(Object(B.isLeft)(t))return Object(B.left)(new Error("Invalid Song Summary list"));var n=t.right.map((function(e){return new SongSummary(Object(j.a)({},e))}));return Object(B.right)(n)}}]),SongSummary}(),ut=x.k(Object(j.a)(Object(j.a)({},ot),{},{elements:x.b(Ee)})),st={id:"",owner:"",lastSavedAt:null,metadata:{title:"",composedBy:"",performedBy:""},elements:new se},dt=Object(R.b)(st),ht=function(e){Object(C.a)(ChordSong,e);var t=Object(O.a)(ChordSong);function ChordSong(e){var n;if(Object(L.a)(this,ChordSong),(n=t.call(this)).record=void 0,ChordSong.isChordSongRecord(e))return n.record=e,Object(w.a)(n);var r=Object(j.a)(Object(j.a)({},st),{},{metadata:Object(j.a)({},st.metadata)});return void 0===e.lines?r.elements=new se([new je({})]):e.lines instanceof se?r.elements=e.lines:r.elements=new se(e.lines),void 0!==e.fields&&(r.id=e.fields.id,r.owner=e.fields.owner,r.metadata=e.fields.metadata,r.lastSavedAt=e.fields.lastSavedAt),n.record=dt(r),n}return Object(S.a)(ChordSong,[{key:"toJSON",value:function toJSON(){return this.record.toJSON()}},{key:"new",value:function _new(e){return e===this.record?this:new ChordSong(e)}},{key:"updateCollection",value:function updateCollection(e){return this.update("elements",e)}},{key:"set",value:function set(e,t){var n=this.record.set(e,t);return this.new(n)}},{key:"update",value:function update(e,t){var n=this.record.update(e,t);return this.new(n)}},{key:"get",value:function get(e){return this.chordLines.get(e)}},{key:"fork",value:function fork(){return this.set("id","").set("owner","").set("lastSavedAt",null)}},{key:"isUnsaved",value:function isUnsaved(){return""===this.id}},{key:"isOwner",value:function isOwner(e){return""!==this.owner&&(null!==e&&this.owner===e.userID)}},{key:"mergeLineWithPrevious",value:function mergeLineWithPrevious(e){var t=this.chordLines.indexOf(e.id);if(!(t>0))return[this,!1];var n=function mergeLines(e,t){return e=(e=function appendLineToPrev(e,t){return e.updateCollection((function(e){return e.transform((function(e){return e.push.apply(e,Object(E.a)(t.chordBlocks.toArray()))}))}))}(e=function addSpaceToEndOfLine(e){var t=e.chordBlocks.length-1;return e.updateElement(t,(function(e){return e.update("lyric",(function(e){return e.append(" ")}))}))}(e),t)).normalizeBlocks()};return[this.updateCollection((function(e){var r=e.getAtIndex(t);return e=(e=e.update(t-1,(function(e){return n(e,r)}))).remove(r)})),!0]}},{key:"splitLine",value:function splitLine(e,t){var n=this.chordLines.get(e),r=n.splitByCharIndex(t),a=Object(s.a)(r,2),o=a[0],i=a[1];return[this.updateCollection((function(e){return e.splice(n,1,o,i)})),!0]}},{key:"contentEquals",value:function contentEquals(e){if(this.chordLines.length!==e.chordLines.length)return!1;if(!F.a.isEqual(this.metadata,e.metadata))return!1;var t=!0;return this.chordLines.forEach((function(n,r){var a=e.chordLines.getAtIndex(r);if(!n.contentEquals(a))return t=!1,!1})),t}},{key:"findLineWithBlock",value:function findLineWithBlock(e){var t=this.chordLines.list.find((function(t){return void 0!==t.chordBlocks.list.find((function(t){return t.id===e.id}))}));if(void 0===t)throw new Error("BlockID can't be found in the entire song");return t}},{key:"transpose",value:function transpose(e,t){return rt(this,e,t)}},{key:"id",get:function get(){return this.record.id}},{key:"owner",get:function get(){return this.record.owner}},{key:"metadata",get:function get(){return this.record.metadata}},{key:"lastSavedAt",get:function get(){return this.record.lastSavedAt}},{key:"elements",get:function get(){return this.record.elements}},{key:"chordLines",get:function get(){return this.elements}},{key:"timeSections",get:function get(){var e=[];return this.chordLines.forEach((function(t){var n;"time"===(null===(n=t.section)||void 0===n?void 0:n.type)&&e.push(t.section)})),e.sort(we),Object(R.a)(e)}},{key:"title",get:function get(){return this.metadata.title},set:function set(e){this.metadata.title=e}},{key:"performedBy",get:function get(){return this.metadata.performedBy},set:function set(e){this.metadata.performedBy=e}},{key:"composedBy",get:function get(){return this.metadata.composedBy},set:function set(e){this.metadata.composedBy=e}}],[{key:"isChordSongRecord",value:function isChordSongRecord(e){return R.b.isRecord(e)}},{key:"fromValidatedFields",value:function fromValidatedFields(e){var t=e.elements.map((function(e){return je.fromValidatedFields(e)}));return new ChordSong({lines:new se(t),fields:e})}},{key:"deserialize",value:function deserialize(e){var t=Object(T.a)(e);if(Object(B.isLeft)(t))return Object(B.left)(new Error(JSON.stringify(t.left)));var n=t.right;return ChordSong.fromJSONObject(n)}},{key:"fromJSONObject",value:function fromJSONObject(e){var t=ut.decode(e);return Object(B.isLeft)(t)?Object(B.left)(new Error("Invalid Chord Song object")):Object(B.right)(this.fromValidatedFields(t.right))}},{key:"fromLyricsLines",value:function fromLyricsLines(e){var t=e.map((function(e){return je.fromLyrics(e)}));return new ChordSong({lines:new se(t)})}}]),ChordSong}(ue),mt=function(){function RootPath(){Object(L.a)(this,RootPath)}return Object(S.a)(RootPath,[{key:"URL",value:function URL(){return"/"}}]),RootPath}(),ft=new mt,pt=function(){function AboutPath(){Object(L.a)(this,AboutPath)}return Object(S.a)(AboutPath,[{key:"URL",value:function URL(){return"/about"}}]),AboutPath}(),yt=new pt,vt=function(){function GuitarDemoPath(){Object(L.a)(this,GuitarDemoPath)}return Object(S.a)(GuitarDemoPath,[{key:"URL",value:function URL(){return"/guitar-demo"}}]),GuitarDemoPath}(),bt=new vt,gt=function(){function SongPath(){Object(L.a)(this,SongPath)}return Object(S.a)(SongPath,[{key:"URL",value:function URL(){return"/song"}},{key:"withID",value:function withID(e){return new Et(e)}},{key:"withNew",value:function withNew(){return new Et("new")}}]),SongPath}(),kt=new gt,Et=function(){function SongIDPath(e){Object(L.a)(this,SongIDPath),this.id=void 0,this.id=e}return Object(S.a)(SongIDPath,[{key:"URL",value:function URL(){return"/song/".concat(this.id)}},{key:"isNew",value:function isNew(){return"new"===this.id}},{key:"withMode",value:function withMode(e){return new Ct(this.id,e)}},{key:"parent",value:function parent(){return kt}}]),SongIDPath}(),wt=kt.withNew(),Ct=function(){function SongIDModePath(e,t){Object(L.a)(this,SongIDModePath),this.id=void 0,this.mode=void 0,this.id=e,this.mode=t}return Object(S.a)(SongIDModePath,[{key:"URL",value:function URL(){return"/song/".concat(this.id,"/").concat(this.mode)}},{key:"parent",value:function parent(){return new Et(this.id)}}],[{key:"isPlayMode",value:function isPlayMode(e){return null!==e.match(/\/song\/.+\/play/i)}},{key:"isEditMode",value:function isEditMode(e){return null!==e.match(/\/song\/.+\/edit/i)}}]),SongIDModePath}(),Ot=function(){function DemoPath(){Object(L.a)(this,DemoPath)}return Object(S.a)(DemoPath,[{key:"URL",value:function URL(){return"/demo"}},{key:"withMode",value:function withMode(e){return new Lt(e)}}]),DemoPath}(),jt=new Ot,Lt=function(){function DemoModePath(e){Object(L.a)(this,DemoModePath),this.mode=void 0,this.mode=e}return Object(S.a)(DemoModePath,[{key:"URL",value:function URL(){return"/demo/".concat(this.mode)}},{key:"parent",value:function parent(){return jt}}],[{key:"isPlayMode",value:function isPlayMode(e){return e===new DemoModePath("play").URL()}}]),DemoModePath}(),St=n(226),Bt=n(91),Tt=Object(f.a)((function(e){return{root:{margin:e.spacing(5),padding:e.spacing(5),minHeight:e.spacing(46),minWidth:e.spacing(92)}}}))(St.a),xt=function About(){return l.a.createElement(h.a,{container:!0,"data-testid":"About"},l.a.createElement(h.a,{item:!0,xs:3}),l.a.createElement(h.a,{item:!0,xs:6},l.a.createElement(Tt,null,l.a.createElement(Bt.a,{variant:"h6"},"About Chord Paper"),l.a.createElement(Bt.a,{variant:"h6"},"\xa0"),l.a.createElement(Bt.a,null,"Chord Paper makes writing and reading chord sheets easier than the traditional monospace font formatting. It's a passion project born out of frustration at the clunkiness of writing chords on a computer."),l.a.createElement(Bt.a,null,"\xa0"),l.a.createElement(Bt.a,null,"Hope you will find that Chord Paper helps you focus more of your musical time on playing and listening, and less on formatting."))),l.a.createElement(h.a,{item:!0,xs:3}))},Dt=n(185),It=Object(f.a)((function(e){return{root:{margin:e.spacing(5),padding:e.spacing(5),minHeight:e.spacing(46),minWidth:e.spacing(92),position:"relative"}}}))(St.a),Ft=function ErrorPage(){return l.a.createElement(h.a,{container:!0,"data-testid":"Tutorial"},l.a.createElement(h.a,{item:!0,xs:3}),l.a.createElement(h.a,{item:!0,xs:6},l.a.createElement(It,null,l.a.createElement(Bt.a,null,"An Error Occurred Oh No"))),l.a.createElement(h.a,{item:!0,xs:3}))},Pt=n(15),At=n(229),zt=l.a.createContext(Object(i.createRef)()),Rt=function PlayerTimeProvider(e){var t=Object(i.useRef)(null);return l.a.createElement(zt.Provider,{value:t},e.children)},Nt=n(396),_t=n(368),Mt=n(369),Ut=n(370),Kt=n(317),Vt=n(223),Wt=n(371),Gt=n(372),Jt=n(367),Ht=n(373),qt=n(186),Yt=n.n(qt),$t=n(97),Xt=n.n($t),Qt=function validateValue(e){return""!==e.trim()},Zt=x.k({id:x.i,label:x.i}),en=x.d([Zt,x.k({track_type:x.e("single"),url:x.i})]),tn=function(e){Object(C.a)(SingleTrack,e);var t=Object(O.a)(SingleTrack);function SingleTrack(e,n,r){return Object(L.a)(this,SingleTrack),t.call(this,{id:e,track_type:"single",label:n,url:r})}return Object(S.a)(SingleTrack,[{key:"validate",value:function validate(){return Qt(this.label)&&Qt(this.url)}}],[{key:"fromValidatedFields",value:function fromValidatedFields(e){return new SingleTrack(e.id,e.label,e.url)}}]),SingleTrack}(Object(R.b)({id:"",track_type:"single",label:"",url:""})),nn=function makeStemTrackValidator(e,t){var n=mapObject(e,(function(){return x.i}));return x.d([Zt,x.k({track_type:x.e(t),stem_urls:x.k(n)})])},rn=function(){function StemTrack(e,t,n){Object(L.a)(this,StemTrack),this.id=void 0,this.label=void 0,this.stem_urls=void 0,this.id=e,this.label=t,this.stem_urls=n}return Object(S.a)(StemTrack,[{key:"validate",value:function validate(){if(!Qt(this.label))return!1;var e;for(e in this.stem_urls)if(!Qt(this.stem_urls[e]))return!1;return!0}}]),StemTrack}(),an={accompaniment:void 0,vocals:void 0},on=nn(an,"2stems"),ln=function(e){Object(C.a)(TwoStemTrack,e);var t=Object(O.a)(TwoStemTrack);function TwoStemTrack(e,n,r){var a;return Object(L.a)(this,TwoStemTrack),(a=t.call(this,e,n,r)).track_type=void 0,a.track_type="2stems",a}return Object(S.a)(TwoStemTrack,[{key:"keyObject",value:function keyObject(){return an}},{key:"setLabel",value:function setLabel(e){return new TwoStemTrack(this.id,e,this.stem_urls)}}],[{key:"fromValidatedFields",value:function fromValidatedFields(e){return new TwoStemTrack(e.id,e.label,e.stem_urls)}}]),TwoStemTrack}(rn),cn={bass:void 0,drums:void 0,other:void 0,vocals:void 0},un=nn(cn,"4stems"),sn=function(e){Object(C.a)(FourStemTrack,e);var t=Object(O.a)(FourStemTrack);function FourStemTrack(e,n,r){var a;return Object(L.a)(this,FourStemTrack),(a=t.call(this,e,n,r)).track_type=void 0,a.track_type="4stems",a}return Object(S.a)(FourStemTrack,[{key:"keyObject",value:function keyObject(){return cn}},{key:"setLabel",value:function setLabel(e){return new FourStemTrack(this.id,e,this.stem_urls)}}],[{key:"fromValidatedFields",value:function fromValidatedFields(e){return new FourStemTrack(e.id,e.label,e.stem_urls)}}]),FourStemTrack}(rn),dn={bass:void 0,drums:void 0,other:void 0,piano:void 0,vocals:void 0},hn=nn(dn,"5stems"),mn=function(e){Object(C.a)(FiveStemTrack,e);var t=Object(O.a)(FiveStemTrack);function FiveStemTrack(e,n,r){var a;return Object(L.a)(this,FiveStemTrack),(a=t.call(this,e,n,r)).track_type=void 0,a.track_type="5stems",a}return Object(S.a)(FiveStemTrack,[{key:"keyObject",value:function keyObject(){return dn}},{key:"setLabel",value:function setLabel(e){return new FiveStemTrack(this.id,e,this.stem_urls)}}],[{key:"fromValidatedFields",value:function fromValidatedFields(e){return new FiveStemTrack(e.id,e.label,e.stem_urls)}}]),FiveStemTrack}(rn),fn=n(96),pn=n.n(fn),yn=n(405),vn=function textFieldValidation(e){var t=function validateValue(e){return""!==e.trim()}(e);return{error:!t||void 0,helperText:t?void 0:"Can't be empty"}},bn=function LabelField(e){return l.a.createElement(yn.a,Object.assign({label:"Track Label",variant:"outlined",value:e.value,onChange:function labelChangeHandler(t){e.onChange(t.target.value)}},vn(e.value)))},gn=new RegExp(".*drive.google.com/.*?.+"),kn=new RegExp(".*drive.google.com/file/d/(.+)/.*"),En=function ensureGoogleDriveCacheBusted(e,t){return function isGoogleDriveExportLink(e){return null!==e.match(gn)}(e)?e+"&cacheBuster="+t:e},wn=function URLField(e){return l.a.createElement(yn.a,Object.assign({label:e.labelText,variant:"outlined",value:e.value,onChange:function handleChange(t){e.onChange(t.target.value)},onKeyDown:function handleKey(t){if((t.metaKey||t.ctrlKey)&&("g"===t.key||"G"===t.key)){var n=function convertViewLinkToExportLink(e){var t=e.match(kn);return null===t||t.length<2?null:"https://drive.google.com/uc?export=download&id="+t[1]}(e.value);null!==n&&(e.onChange(n),t.preventDefault())}},disabled:e.disabled},vn(e.value)))},Cn=Object(f.a)((function(e){return{root:{margin:e.spacing(2)}}}))(h.a),On=function SingleTrackRow(e){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Cn,{container:!0,alignItems:"center"},l.a.createElement(h.a,{xs:5,item:!0},l.a.createElement(bn,{value:e.track.label,onChange:function handleLabelChange(t){var n=e.track.set("label",t);e.onChange(n)}})),l.a.createElement(h.a,{xs:5,item:!0},l.a.createElement(wn,{labelText:"Track URL",value:e.track.url,onChange:function handleURLChange(t){var n=e.track.set("url",t);e.onChange(n)}})),l.a.createElement(h.a,{xs:2,item:!0},l.a.createElement(Kt.a,{onClick:e.onRemove},l.a.createElement(pn.a,null)))),l.a.createElement(Jt.a,null))},jn=Object(f.a)((function(e){return{root:{margin:e.spacing(2)}}}))(h.a),Ln=function StemTrackRow(e){var t=function handleLabelChange(t){var n=e.track.setLabel(t);e.onChange(n)},n=mapObject(e.track.stem_urls,(function makeURLField(t,n){var r=function(){var t=e.urlFieldLabels.find((function(e){return e.key===n}));return void 0===t?"File URL":t.label}();return l.a.createElement(wn,{labelText:r,value:t,onChange:function handleChange(t){var r=F.a.clone(e.track);r.stem_urls[n]=t,e.onChange(r)}})})),r=e.urlFieldLabels.map((function(r,a){return 0===a?function createFirstRow(r){return l.a.createElement(jn,{key:r,container:!0,alignItems:"center"},l.a.createElement(h.a,{xs:5,item:!0},l.a.createElement(bn,{value:e.track.label,onChange:t})),l.a.createElement(h.a,{xs:5,item:!0},n[r]),l.a.createElement(h.a,{xs:2,item:!0},l.a.createElement(Kt.a,{onClick:e.onRemove},l.a.createElement(pn.a,null))))}(r.key):function createSubsequentRows(e){return l.a.createElement(jn,{key:e,container:!0,alignItems:"center"},l.a.createElement(h.a,{xs:5,item:!0}),l.a.createElement(h.a,{xs:5,item:!0},n[e]),l.a.createElement(h.a,{xs:2,item:!0}))}(r.key)}));return l.a.createElement(l.a.Fragment,null,r,l.a.createElement(Jt.a,null))},Sn=Object(f.a)((function(e){return{root:{margin:e.spacing(2)}}}))(h.a),Bn=function SplitStemTrackRow(e){var t=""!==e.track.id,n=function(){if(t)return"Processing track...";switch(e.track.track_type){case"split_2stems":return"Track URL to be split into 2 stems";case"split_4stems":return"Track URL to be split into 4 stems";case"split_5stems":return"Track URL to be split into 5 stems"}}();return l.a.createElement(l.a.Fragment,null,l.a.createElement(Sn,{container:!0,alignItems:"center"},l.a.createElement(h.a,{xs:5,item:!0},l.a.createElement(bn,{value:e.track.label,onChange:function handleLabelChange(t){var n=e.track.set("label",t);e.onChange(n)}})),l.a.createElement(h.a,{xs:5,item:!0},l.a.createElement(wn,{labelText:n,value:e.track.original_url,onChange:function handleURLChange(t){var n=e.track.set("original_url",t);e.onChange(n)},disabled:t})),l.a.createElement(h.a,{xs:2,item:!0},l.a.createElement(Kt.a,{onClick:e.onRemove},l.a.createElement(pn.a,null)))),l.a.createElement(Jt.a,null))},Tn=x.d([Zt,x.k({track_type:x.l([x.e("split_2stems"),x.e("split_4stems"),x.e("split_5stems")]),original_url:x.i})]),xn=function(e){Object(C.a)(SplitStemTrack,e);var t=Object(O.a)(SplitStemTrack);function SplitStemTrack(e,n,r,a){return Object(L.a)(this,SplitStemTrack),t.call(this,{id:e,track_type:r,label:n,original_url:a})}return Object(S.a)(SplitStemTrack,[{key:"validate",value:function validate(){return Qt(this.label)&&Qt(this.original_url)}}],[{key:"fromValidatedFields",value:function fromValidatedFields(e){return new SplitStemTrack(e.id,e.label,e.track_type,e.original_url)}}]),SplitStemTrack}(Object(R.b)({id:"",track_type:"split_2stems",label:"",original_url:""})),Dn=Object(f.a)((function(e){return{root:{display:"flex",padding:e.spacing(5),alignItems:"center",justifyItems:"center"}}}))(Nt.a),In=Object(f.a)({root:{display:"inline-block"}})(Nt.a),Fn=Object(f.a)((function(e){return{root:{cursor:"pointer",display:"flex",alignItems:"center",marginTop:e.spacing(1),marginBottom:e.spacing(1)}}}))(Nt.a),Pn=Object(f.a)((function(e){return{root:{marginLeft:e.spacing(2),marginBottom:e.spacing(1)}}}))(Bt.a),An=function LoadedTrackListEditDialog(e){var t=function(){var t=F.a.cloneDeep(e.trackList);return 0===t.tracks.length&&t.tracks.push(function emptySingleTrack(){return new tn("","","")}()),t}(),n=Object(i.useState)(t),r=Object(s.a)(n,2),a=r[0],o=r[1],c=Object(i.useState)(0),u=Object(s.a)(c,2),d=u[0],h=u[1],m=Object(i.useState)(null),f=Object(s.a)(m,2),p=f[0],y=f[1],v=function bumpVersion(){return h(d+1)},b=function cloneTrackList(){return F.a.cloneDeep(a)},g=function handleAddTrackMenu(e){y(e.currentTarget)},k=function handleCloseAddTrackMenu(){y(null)},E=function handleAddSingleTrack(){L(new tn("","",""))},w=function handleAddTwoStemTrack(){L(new ln("","",{vocals:"",accompaniment:""}))},C=function handleAddFourStemTrack(){L(new sn("","",{vocals:"",other:"",bass:"",drums:""}))},O=function handleAddFiveStemTrack(){L(new mn("","",{vocals:"",other:"",piano:"",bass:"",drums:""}))},j=function handleAddSplitStemTrack(e){L(new xn("","",e,""))},L=function handleAddTrack(e){S(e),k()},S=function appendTrack(e){var t=b();t.tracks.push(e),v(),o(t)},B=function removeTrack(e){var t=b();t.tracks.splice(e,1),v(),o(t)},T=function(){var e,t=Object(z.a)(a.tracks);try{for(t.s();!(e=t.n()).done;){if(!e.value.validate())return!0}}catch(n){t.e(n)}finally{t.f()}return!1}(),x=function trackChangeHandler(e){return function(t){!function updateTrack(e,t){var n=b();n.tracks.splice(e,1,t),o(n)}(e,t)}},D=function(){var e=a.tracks.map((function(e,t){var n="".concat(d,"-").concat(t);switch(e.track_type){case"single":return l.a.createElement(On,{key:n,track:e,onChange:x(t),onRemove:function onRemove(){return B(t)}});case"2stems":return l.a.createElement(Ln,{key:n,track:e,urlFieldLabels:[{key:"vocals",label:"Vocals File URL"},{key:"accompaniment",label:"Accompaniment File URL"}],onChange:x(t),onRemove:function onRemove(){return B(t)}});case"4stems":return l.a.createElement(Ln,{key:n,track:e,urlFieldLabels:[{key:"vocals",label:"Vocals File URL"},{key:"other",label:"Other File URL"},{key:"bass",label:"Bass File URL"},{key:"drums",label:"Drums File URL"}],onChange:x(t),onRemove:function onRemove(){return B(t)}});case"5stems":return l.a.createElement(Ln,{key:n,track:e,urlFieldLabels:[{key:"vocals",label:"Vocals File URL"},{key:"other",label:"Other File URL"},{key:"piano",label:"Piano File URL"},{key:"bass",label:"Bass File URL"},{key:"drums",label:"Drums File URL"}],onChange:x(t),onRemove:function onRemove(){return B(t)}});case"split_2stems":case"split_4stems":case"split_5stems":return l.a.createElement(Bn,{key:n,track:e,onChange:x(t),onRemove:function onRemove(){return B(t)}})}})),t=null!==p;return e.push(l.a.createElement(l.a.Fragment,{key:"append"},l.a.createElement(In,null,l.a.createElement(Fn,{key:"append-action",onClick:g},l.a.createElement(Yt.a,null),l.a.createElement(Pn,null,"Add a new track"))),l.a.createElement(Vt.a,{open:t,anchorEl:p,onClose:k},l.a.createElement(Wt.a,{onClick:E},"Single Track"),l.a.createElement(Wt.a,{onClick:w},"2 Stem Track"),l.a.createElement(Wt.a,{onClick:C},"4 Stem Track"),l.a.createElement(Wt.a,{onClick:O},"5 Stem Track"),l.a.createElement(Wt.a,{onClick:function onClick(){return j("split_2stems")}},"Split Track into 2 Stems"),l.a.createElement(Wt.a,{onClick:function onClick(){return j("split_4stems")}},"Split Track into 4 Stems"),l.a.createElement(Wt.a,{onClick:function onClick(){return j("split_5stems")}},"Split Track into 5 Stems")))),e}();return l.a.createElement(l.a.Fragment,null,l.a.createElement(Gt.a,null,l.a.createElement(Pn,{variant:"body2",variantMapping:{body2:"div"}},l.a.createElement(Nt.a,null,"Add URLs for the audio track this song."),l.a.createElement(Nt.a,null,"This can be your own hosted files, or Youtube, etc.")),l.a.createElement(Pn,{variant:"body2",variantMapping:{body2:"div"}},l.a.createElement(Nt.a,null,"This player works best if every track is a version of the same song,"),l.a.createElement(Nt.a,null,"e.g. the original recording, just the accompaniment, only drums + bass.")),l.a.createElement(Jt.a,null),D),l.a.createElement(Ht.a,null,l.a.createElement(Kt.a,{onClick:e.onClose},"Cancel"),l.a.createElement(Kt.a,{disabled:T,onClick:function handleSubmit(){var t;T||null===(t=e.onSubmit)||void 0===t||t.call(e,a)}},"OK")))},zn=function TrackListEditDialog(e){var t="loading"===e.trackListLoad.state?l.a.createElement(Dn,null,l.a.createElement(_t.a,{size:"15rem"})):l.a.createElement(An,{trackList:e.trackListLoad.tracklist,onSubmit:e.onSubmit,onClose:e.onClose});return l.a.createElement(Mt.a,{open:e.open,onClose:e.onClose,maxWidth:!1},l.a.createElement(Ut.a,null,l.a.createElement(Kt.a,{onClick:e.onRefresh},l.a.createElement(Xt.a,null)),"Edit Track List"),t)},Rn=n(87),Nn=function voidFn(){},_n={playerRef:new(function(){function NoopMutableRef(){Object(L.a)(this,NoopMutableRef),this._current=void 0,this._current=void 0}return Object(S.a)(NoopMutableRef,[{key:"current",set:function set(e){},get:function get(){}}]),NoopMutableRef}()),playing:!1,togglePlay:Nn,jumpBack:Nn,jumpForward:Nn,goToBeginning:Nn,skipBack:{action:Nn,enabled:!1},skipForward:{action:Nn,enabled:!1},currentTime:0,currentTimeFormatted:"0:00",onProgress:Nn,onPlay:Nn,onPause:Nn,currentSectionLabel:"",playrate:{percentage:100,onChange:Nn}},Mn=function getSection(e,t){var n=e.get(t);if(void 0===n)throw new Error("Section index is out of range, unexpected");return n},Un=function usePlayerControls(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(0),l=Object(s.a)(o,2),c=l[0],u=l[1],d=Object(i.useRef)(),h=Object(i.useState)(100),m=Object(s.a)(h,2),f=m[0],p=m[1],y=Object(i.useRef)(c);y.current=c;var v=Object(i.useContext)(zt),b=function getCurrentTime(){return y.current};Object(i.useEffect)((function(){v.current=b}),[v,b]);var g=function seekTo(e){var t;e<0&&(e=0),null===(t=d.current)||void 0===t||t.seekTo(e,"seconds")},k=function pauseAction(){a(!1),function outOfSyncWorkaround(){setTimeout((function(){g(y.current)}),200)}()},E=function(){if(0===e.size)return null;var t=null;return e.forEach((function(n,r){c>=n.time&&(null===t||n.time>Mn(e,t).time)&&(t=r)})),t}(),w=null!=E?Mn(e,E):null,C=null!==w?w.name:"",O={action:function action(){if(null!==w){var t=null===E||0===E?null:Mn(e,E-1);null!==t&&c<=w.time+2?g(t.time-1):g(w.time-1)}},enabled:null!==w},j=function(){var t=function findNextSectionIndex(t){return 0===e.size?null:null===t?0:t===e.size-1?null:t+1},n=t(E),r=function(){if(null===n)return null;var r=Mn(e,n);if(c<r.time-2)return r;var a=t(n);return null===a?null:Mn(e,a)}();return{action:function action(){null!==r&&g(r.time-1)},enabled:null!==r}}(),L=Rn.Duration.fromMillis(1e3*c).toFormat("m:ss");return{playerRef:d,playing:r,togglePlay:function togglePlayAction(){r?k():function playAction(){a(!0)}()},skipBack:O,skipForward:j,jumpBack:function jumpBackAction(){var e=c-5;e<0&&(e=0),g(e)},jumpForward:function jumpForwardAction(){g(c+5)},goToBeginning:function goToBeginningAction(){g(0)},currentTime:c,currentTimeFormatted:L,onProgress:function handleProgress(e){u(e.playedSeconds)},onPlay:function handlePlayState(){a(!0)},onPause:function handlePauseState(){a(!1)},currentSectionLabel:C,playrate:{percentage:f,onChange:p}}},Kn=n(311),Vn=n(319),Wn=n(187),Gn=n.n(Wn),Jn=l.a.createContext([function(){},function(){},function(){}]),Hn=function useRegisterTopKeyListener(){var e=Object(i.useContext)(Jn),t=Object(s.a)(e,3);return[t[1],t[2]]},qn=function GlobalKeyListenerProvider(e){var t=Object(i.useRef)([]),n=function wrapListener(e){return function(t){t.target instanceof HTMLElement&&("INPUT"===t.target.tagName||"TEXTAREA"===t.target.tagName||t.target.isContentEditable)||(e(t),t.defaultPrevented&&t.stopImmediatePropagation())}};return l.a.createElement(Jn.Provider,{value:[function registerKeyListener(e){var r=n(e);t.current.push({original:e,wrapped:r}),window.addEventListener("keydown",r,!0)},function registerTopKeyListener(e){var r=n(e);!function removeAll(){var e,n=Object(z.a)(t.current);try{for(n.s();!(e=n.n()).done;){var r=e.value;window.removeEventListener("keydown",r.wrapped,!0)}}catch(a){n.e(a)}finally{n.f()}}(),t.current.unshift({original:e,wrapped:r}),function addAll(){var e,n=Object(z.a)(t.current);try{for(n.s();!(e=n.n()).done;){var r=e.value;window.addEventListener("keydown",r.wrapped,!0)}}catch(a){n.e(a)}finally{n.f()}}()},function unregisterKeyListener(e){var n=t.current.findIndex((function(t){return t.original===e}));if(-1!==n){var r=t.current[n];window.removeEventListener("keydown",r.wrapped,!0),t.current.splice(n,1)}}]},e.children)},Yn=n(374),$n=n(137),Xn=function roundedTopCornersStyle(e){return{borderTopLeftRadius:e.spacing(1.5),borderTopRightRadius:e.spacing(1.5)}},Qn=function roundedCornersStyle(e){return{borderRadius:e.spacing(1.5)}},Zn={backgroundColor:Yn.a[50],display:"flex",alignItems:"center"},er=function widthOfString(e,t,n){var r=e.typography[t],a=function(){if(void 0!==r.fontFamily&&void 0!==r.fontSize)return"".concat(r.fontSize," ").concat(r.fontFamily)}();if(void 0!==a){var o=document.createElement("canvas").getContext("2d");if(null!==o){o.font=a;var i=o.measureText(n);return"".concat(i.width,"px")}}},tr=$n.a[700],nr=Object(f.a)((function(e){return{root:Object(j.a)({position:"fixed",bottom:0,right:e.spacing(2)},Xn(e))}}))(Nt.a),rr=function withBottomRightBox(e){return l.a.createElement(nr,{boxShadow:4},e)},ar=(Object(f.a)((function(e){return{root:Object(j.a)({position:"fixed",bottom:0,left:e.spacing(2)},Xn(e))}}))(Nt.a),Object(f.a)((function(e){return{root:Object(j.a)({width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"},Xn(e))}}))(Nt.a)),or=n(69),ir=n.n(or),lr=n(127),cr=n.n(lr),ur=n(188),sr=n.n(ur),dr=n(189),hr=n.n(dr),mr=Object(f.a)((function(e){return{root:{color:e.palette.primary.main}}}))(ir.a),fr=Object(f.a)((function(e){return{root:{color:e.palette.secondary.main}}}))(cr.a),pr=Object(f.a)((function(e){return{root:Object(j.a)({},Xn(e))}}))(Kt.a),yr=function MicroPlayer(e){var t=Hn(),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(null),c=Object(s.a)(o,2),u=c[0],d=c[1],h=e.playerControls.togglePlay,m=e.playerControls.jumpBack,f=e.playerControls.jumpForward,p=e.onClick,y=e.show;Object(i.useEffect)((function(){if(y){var e=function handleKey(e){if("Slash"===e.code&&(p(),e.preventDefault()),e.ctrlKey||e.metaKey)switch(e.code){case"Enter":case"Space":h(),e.preventDefault();break;case"ArrowLeft":m(),d("back"),e.preventDefault();break;case"ArrowRight":f(),d("forward"),e.preventDefault()}};return r(e),function(){return a(e)}}}),[r,a,y,p,h,m,f,d]),Object(i.useEffect)((function(){null!==u&&setTimeout((function(){return d(null)}),1e3)}),[u,d]);var v=e.playersLoaded?"back"===u?l.a.createElement(sr.a,null):"forward"===u?l.a.createElement(hr.a,null):e.playerControls.playing?l.a.createElement(mr,null):l.a.createElement(fr,null):l.a.createElement(Gn.a,null);return l.a.createElement(Kn.a,{in:e.show,direction:"up"},rr(l.a.createElement(Vn.a,{title:e.tooltipMessage},l.a.createElement("span",null,l.a.createElement(pr,{className:e.className,onClick:e.onClick,disabled:e.disabled},v)))))},vr=n(400),br=n(197),gr=n.n(br),kr=n(128),Er=n.n(kr),wr=n(379),Cr=n(357),Or=n(46),jr=n.n(Or),Lr=n(191),Sr=n.n(Lr),Br=n(148),Tr=n.n(Br),xr=n(149),Dr=n.n(xr),Ir=n(192),Fr=n.n(Ir),Pr=n(194),Ar=n.n(Pr),zr=n(193),Rr=n.n(zr),Nr=n(122),_r=function BeginningIcon(e){return l.a.createElement(Nr.a,e,l.a.createElement("path",{d:"M6 6h2v12h-2z m1.5 6l8 6V6z m7 0 l8 6V6z"}))},Mr=function ForwardIcon(e){return l.a.createElement(Nr.a,e,l.a.createElement("path",{d:"M18,13c0,3.31-2.69,6-6,6s-6-2.69-6-6s2.69-6,6-6v4l5-5l-5-5v4c-4.42,0-8,3.58-8,8c0,4.42,3.58,8,8,8c4.42,0,8-3.58,8-8 H18z"}))},Ur=Object(f.a)((function(e){return{root:Object(j.a)({minWidth:0},Qn(e))}}))(Kt.a),Kr=Object(f.a)((function(e){return{root:{color:e.palette.primary.main}}}))(Ur),Vr=Object(f.a)((function(e){return{root:{color:e.palette.secondary.main}}}))(Ur),Wr=function makeControlButton(e,t,n,r){var a="primary"===r?Kr:Vr;return function(r){return l.a.createElement(Vn.a,{key:t,title:n},l.a.createElement("span",null,l.a.createElement(a,Object.assign({},r,{size:"large"}),e)))}},Gr={Play:Wr(l.a.createElement(ir.a,null),"play-button","Play the damn song","primary"),Pause:Wr(l.a.createElement(cr.a,null),"pause-button","Pause","secondary"),JumpBack:Wr(l.a.createElement(Fr.a,null),"jump-back-buttonn","Jump Back","primary"),JumpForward:Wr(l.a.createElement(Mr,null),"jump-forward-button","Jump Forward","primary"),SkipBack:Wr(l.a.createElement(Rr.a,null),"skip-back-button","Go back a section","primary"),SkipForward:Wr(l.a.createElement(Ar.a,null),"skip-back-button","Go forward a section","primary"),Beginning:Wr(l.a.createElement(_r,null),"beginning-button","Go to Beginning","primary"),DecreasePlayrate:Wr(l.a.createElement(Tr.a,null),"decrease-playrate-button","Play slower","primary"),IncreasePlayrate:Wr(l.a.createElement(Dr.a,null),"increase-playrate-button","Play faster","primary"),TransposeDown:Wr(l.a.createElement(Tr.a,null),"transpose-down-button","Transpose down half step","primary"),TransposeUp:Wr(l.a.createElement(Dr.a,null),"transpose-up-button","Transpose up half step","primary")},Jr=Object(f.a)({root:{display:"flex",alignContent:"center",flexShrink:0,flexGrow:0}})(Nt.a),Hr=Object(f.a)((function(e){return{root:{marginLeft:0,marginRight:0,marginTop:e.spacing(1.5),marginBottom:e.spacing(1.5)}}}))(Jt.a),qr=function ControlGroup(e){var t=e.children.filter((function isRealNode(e){return null!==e&&void 0!==e})).map((function(t,n){var r=l.a.createElement(Hr,{key:"divider-".concat(n),orientation:"vertical",flexItem:!0}),a="right"===e.dividers?[t,r]:[r,t];return l.a.createElement(l.a.Fragment,{key:n},a)}));return l.a.createElement(Jr,null,t)},Yr=Object(f.a)({root:{justifyContent:"space-between"}})(Jr),$r=Object(f.a)((function(e){return{root:{color:tr,minWidth:er(e,"h6","200%"),display:"flex",justifyContent:"center"}}}))(Bt.a),Xr=function PlayrateControl(e){var t=Math.round(e.playratePercentage),n="".concat(t,"%"),r=t-5<50,a=t+5>100;return l.a.createElement(Yr,null,l.a.createElement(Gr.DecreasePlayrate,{onClick:function onDecrease(){return e.onChange(t-5)},disabled:r}),l.a.createElement(Vn.a,{title:"Playback speed"},l.a.createElement($r,{variant:"h6"},l.a.createElement(Nt.a,null,n))),l.a.createElement(Gr.IncreasePlayrate,{onClick:function onIncrease(){return e.onChange(t+5)},disabled:a}))},Qr=Object(f.a)((function(e){return{root:{marginLeft:e.spacing(1.5),marginRight:e.spacing(1.5),color:tr,flexShrink:1,flexGrow:1,display:"flex",justifyContent:"center"}}}))(Nt.a),Zr=function SectionLabel(e){return""===e.value?null:l.a.createElement(Qr,null,l.a.createElement(Bt.a,{variant:"body1"},e.value))},ea=Object(f.a)({root:{justifyContent:"space-between"}})(Jr),ta=Object(f.a)((function(e){return{root:{color:tr,display:"flex",justifyContent:"center"}}}))(Bt.a),na=function TransposeControl(e){var t=Math.round(e.transposeLevel),n=t-1<-12,r=t+1>12,a=e.transposeLevel>0?"\u266f".concat(e.transposeLevel):e.transposeLevel<0?"\u266d".concat(-e.transposeLevel):"\u266e0";return l.a.createElement(ea,null,l.a.createElement(Gr.TransposeDown,{onClick:function onDecrease(){return e.onChange(t-1)},disabled:n}),l.a.createElement(Vn.a,{title:"Transposition"},l.a.createElement(ta,{variant:"h6"},l.a.createElement(Nt.a,null,a))),l.a.createElement(Gr.TransposeUp,{onClick:function onIncrease(){return e.onChange(t+1)},disabled:r}))},ra=Object(f.a)((function(e){var t=e.spacing(5);return{root:Object(j.a)(Object(j.a)({},Zn),{},{justifyContent:"space-between",flexWrap:"wrap",overflow:"hidden",maxHeight:t})}}))(Nt.a),aa=function ControlPane(e){var t=Hn(),n=Object(s.a)(t,2),r=n[0],a=n[1],o=e.playing?l.a.createElement(Gr.Pause,{onClick:e.onTogglePlay}):l.a.createElement(Gr.Play,{onClick:e.onTogglePlay});Object(i.useEffect)((function(){if(e.show){var t=function handleKey(t){switch(t.code){case"Space":e.onTogglePlay(),t.preventDefault();break;case"ArrowLeft":t.ctrlKey||t.metaKey?e.onSkipBack.action():e.onJumpBack(),t.preventDefault();break;case"ArrowRight":return t.ctrlKey||t.metaKey?e.onSkipForward.action():e.onJumpForward(),void t.preventDefault()}};return r(t),function(){a(t)}}}),[e,r,a]);var c=void 0===e.transpose?null:l.a.createElement(qr,{dividers:"left"},[l.a.createElement(na,{transposeLevel:e.transpose.level,onChange:e.transpose.onChange})]);return l.a.createElement(ra,null,l.a.createElement(qr,{dividers:"right"},l.a.createElement(Gr.Beginning,{onClick:e.onGoToBeginning}),l.a.createElement(Gr.SkipBack,{disabled:!e.onSkipBack.enabled,onClick:e.onSkipBack.action}),l.a.createElement(Gr.JumpBack,{onClick:e.onJumpBack}),o,l.a.createElement(Gr.JumpForward,{onClick:e.onJumpForward}),l.a.createElement(Gr.SkipForward,{disabled:!e.onSkipForward.enabled,onClick:e.onSkipForward.action})),l.a.createElement(Zr,{value:e.sectionLabel}),c,l.a.createElement(qr,{dividers:"left"},[l.a.createElement(Xr,{playratePercentage:e.playrate.percentage,onChange:e.playrate.onChange})]))},oa=function makeBasePlayerProps(e){return{ref:e.playerRef,playing:e.playing,controls:!0,playbackRate:e.playrate.percentage/100,onPlay:e.onPlay,onPause:e.onPause,onProgress:e.onProgress,progressInterval:500,height:"auto",width:"unset",onKeyUp:function onKeyUp(e){return e.preventDefault()}}},ia=function SingleTrackPlayer(e){var t=Object(i.useMemo)((function(){return En(e.track.url,A.a.generate())}),[e.track.url]),n=function makeReactPlayerProps(e){var t=oa(e);return Object(j.a)(Object(j.a)({},t),{},{config:{file:{forceAudio:!0}}})}(e.playerControls);return Object(i.useEffect)((function(){!e.currentTrack&&e.playerControls.playing&&e.playerControls.onPause()}),[e.currentTrack,e.playerControls]),l.a.createElement(Nt.a,null,l.a.createElement(Nt.a,null,l.a.createElement(Sr.a,Object.assign({},n,{url:t}))),l.a.createElement(aa,{show:e.focused,playing:e.playerControls.playing,sectionLabel:e.playerControls.currentSectionLabel,onTogglePlay:e.playerControls.togglePlay,onJumpBack:e.playerControls.jumpBack,onJumpForward:e.playerControls.jumpForward,onSkipBack:e.playerControls.skipBack,onSkipForward:e.playerControls.skipForward,onGoToBeginning:e.playerControls.goToBeginning,playrate:e.playerControls.playrate}))},la=n(9),ca=n.n(la),ua=n(18),sa=n(65),da=n(150),ha=n.n(da),ma=null,fa=function getAudioCtx(){return null===ma&&(ma=new window.AudioContext),ma},pa=n(195),ya=n.n(pa),va=n(196),ba=n.n(va),ga=n(73),ka=n(407),Ea=n(138),wa=n(375),Ca=n(376),Oa=n(377),ja=n(378),La=Object(f.a)((function(e){return{root:{width:"100%",paddingLeft:e.spacing(1.5),paddingRight:e.spacing(1.5)}}}))(Nt.a),Sa=Object(f.a)({root:{color:Yn.a[400]}})(ka.a),Ba=function withColoredButtonStyle(e){return Object(f.a)((function(t){return{root:{backgroundColor:e,width:"100%",height:"100%",color:$n.a[700],padding:t.spacing(.5),textTransform:"none","&:hover":{opacity:.6,backgroundColor:e}}}}))},Ta=Ba($n.a[300])(Kt.a),xa={white:Ba("white")(Kt.a),pink:Ba(Ea.a[200])(Kt.a),yellow:Ba(wa.a[200])(Kt.a),purple:Ba(Ca.a[100])(Kt.a),lightBlue:Ba(Oa.a[200])(Kt.a),lightGreen:Ba(ja.a[100])(Kt.a)},Da=function StemTrackControlPane(e){var t=e.stemControls.map((function makeButton(e){var t=e.enabled?xa[e.buttonColour]:Ta;return l.a.createElement(h.a,{item:!0,xs:!0},l.a.createElement(t,{variant:"contained",onClick:function handleClick(){e.onEnabledChanged(!e.enabled)}},l.a.createElement(La,null,l.a.createElement(Bt.a,{variant:"body1"},e.label),l.a.createElement(Nt.a,{onClick:function preventClickBubble(e){e.preventDefault(),e.stopPropagation()}},l.a.createElement(Sa,{value:e.volume,onChange:function handleVolumeChange(t,n){"number"===typeof n&&e.onVolumeChanged(n)},min:0,max:200,step:10,valueLabelDisplay:"auto"})))))}));return l.a.createElement(h.a,{container:!0},t)},Ia=function createToneNodes(e){var t=new ga.c,n=new ga.a({url:e.audioBuffer,grainSize:.1,overlap:.1});return n.chain(t),{label:e.label,volumeNode:t,playerNode:n,endNode:t}},Fa=function LoadedStemTrackPlayer(e){var t=Object(p.b)().enqueueSnackbar,n=Object(i.useMemo)((function(){return e.stems.map(Ia)}),[e.stems]),r={masterVolumePercentage:100,masterPitchShift:0,stems:e.stems.map((function(e){return{key:e.label,muted:!1,volumePercentage:100}}))},a=Object(i.useState)(r),o=Object(s.a)(a,2),c=o[0],u=o[1],d=Object(i.useRef)(c);d.current=c;var h=Object(i.useMemo)((function(){return 0===e.stems.length?"":function createEmptySongURL(e){var t=fa(),n=t.createBuffer(2,t.sampleRate*e,t.sampleRate),r=ya()(n),a=new window.Blob([r]);return URL.createObjectURL(a)}(e.stems[0].audioBuffer.duration)}),[e.stems]),m=function makeFilePlayerProps(e,t,n){var r=function(){if(void 0!==n)return{onVolumeChange:n}}(),a=oa(e);return Object(j.a)(Object(j.a)({},a),{},{volume:t/100,config:{forceAudio:!0,attributes:r}})}(e.playerControls,c.masterVolumePercentage,(function handleMasterVolumeChange(e){var t=F.a.cloneDeep(d.current);t.masterVolumePercentage=100*e.currentTarget.volume,u(t)}));Object(i.useEffect)((function(){var n,r=null,a=null,o=Object(z.a)(e.stems);try{for(o.s();!(n=o.n()).done;){var i=n.value.audioBuffer;(null===r||i.duration<r)&&(r=i.duration),(null===a||i.duration>a)&&(a=i.duration)}}catch(l){o.e(l)}finally{o.f()}null!==a&&null!==r&&a-r>1&&t("Mismatch in length of tracks loaded, try refreshing",{variant:"warning"})}),[t,e.stems]),Object(i.useEffect)((function(){e.playerControls.playing&&"started"!==ga.b.state?ga.b.start():e.playerControls.playing||"paused"===ga.b.state||"stopped"===ga.b.state||ga.b.pause();var t=e.playerControls.playrate.percentage/100,n=ga.b.seconds*t;Math.abs(e.playerControls.currentTime-n)>1&&(ga.b.seconds=e.playerControls.currentTime/t)}),[e.playerControls.playing,e.playerControls.currentTime,e.playerControls.playrate.percentage]),Object(i.useEffect)((function(){c.stems.forEach((function(t,r){var a=n[r],o=t.volumePercentage/100*(c.masterVolumePercentage/100);if(o>0){var i=20*Math.log10(o);a.volumeNode.volume.value=i}a.endNode.mute=t.muted||0===o,a.playerNode.playbackRate=e.playerControls.playrate.percentage/100}))}),[n,c,e.playerControls.playrate.percentage]),Object(i.useEffect)((function(){c.stems.forEach((function(e,t){var r=n[t];"drums"!==r.label&&(r.playerNode.detune=100*c.masterPitchShift)}))}),[n,c]),Object(i.useEffect)((function(){if(e.currentTrack)return n.forEach((function(e){e.playerNode.sync().start(0),e.endNode.toDestination()})),function(){n.forEach((function(e){e.playerNode.unsync(),e.endNode.disconnect()}))}}),[e.currentTrack,n]),Object(i.useEffect)((function(){!e.currentTrack&&e.playerControls.playing&&e.playerControls.onPause()}),[e.currentTrack,e.playerControls]),Object(i.useEffect)((function(){return function(){n.forEach((function(e){e.volumeNode.dispose(),e.playerNode.dispose()}))}}),[n]);var f=function(){var t=c.stems.map((function makeStemControl(t,n){var r=function(){var n=e.stems.find((function(e){return e.label===t.key}));return void 0===n?"white":n.buttonColour}();return{label:t.key,buttonColour:r,enabled:!t.muted,onEnabledChanged:function onEnabledChanged(e){var t=F.a.cloneDeep(c);t.stems[n].muted=!e,u(t)},volume:t.volumePercentage,onVolumeChanged:function onVolumeChanged(e){var t=F.a.cloneDeep(c);t.stems[n].volumePercentage=e,u(t)}}}));return l.a.createElement(Da,{stemControls:t})}();return l.a.createElement(Nt.a,null,l.a.createElement(Nt.a,null,l.a.createElement(ba.a,Object.assign({},m,{url:h}))),f,l.a.createElement(aa,{show:e.focused,playing:e.playerControls.playing,sectionLabel:e.playerControls.currentSectionLabel,onTogglePlay:e.playerControls.togglePlay,onJumpBack:e.playerControls.jumpBack,onJumpForward:e.playerControls.jumpForward,onSkipBack:e.playerControls.skipBack,onSkipForward:e.playerControls.skipForward,onGoToBeginning:e.playerControls.goToBeginning,playrate:e.playerControls.playrate,transpose:{level:c.masterPitchShift,onChange:function handlePitchShift(e){u(Object(j.a)(Object(j.a)({},c),{},{masterPitchShift:e}))}}}))},Pa=Object(f.a)((function(e){return{root:{padding:e.spacing(2),backgroundColor:$n.a[100]}}}))(Nt.a),Aa=function StemTrackPlayer(e){var t=Object(i.useState)({state:"not-started"}),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useRef)(r);o.current=r;var c=function(){var e=Object(ua.a)(ca.a.mark((function _callee(e,t){var n;return ca.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,sa.a.get(e,{timeout:!1,onDownloadProgress:t}).arrayBuffer();case 2:return n=r.sent,r.next=5,fa().decodeAudioData(n);case 5:return r.abrupt("return",r.sent);case 6:case"end":return r.stop()}}),_callee)})));return function fetchAudioBuffer(t,n){return e.apply(this,arguments)}}();if(Object(i.useEffect)((function(){var t=function fetchAudioBufferWithProgress(e,t){return c(e,(function handleProgress(e){var n=o.current;if("loading"===n.state){var r=F.a.clone(n);r.details[t].loadedBytes=e.transferredBytes,r.details[t].totalBytes=0!==e.totalBytes?e.totalBytes:"unknown",a(r)}})).then((function(e){return{audioBuffer:e,stemKey:t}}))},n=function(){var n=Object(ua.a)(ca.a.mark((function _callee2(){var n,r,o,i,l,c;return ca.a.wrap((function _callee2$(u){for(;;)switch(u.prev=u.next){case 0:for(r in u.prev=0,n=[],e.track.stem_urls)o=t(e.track.stem_urls[r],r),n.push(o);return u.next=5,Promise.all(n);case 5:if(i=u.sent,l=!1,c=e.buttonSpecs.map((function(e){var t,n=i.find((function(t){return t.stemKey===e.label}));return void 0===n?(l=!0,t=new AudioBuffer({length:0,sampleRate:1})):t=n.audioBuffer,{label:e.label,audioBuffer:t,buttonColour:e.buttonColour}})),!l){u.next=11;break}return a({state:"error",error:new Error("Could not find stem key in audio buffer array to object mapping")}),u.abrupt("return");case 11:a({state:"loaded",item:c}),u.next=18;break;case 14:return u.prev=14,u.t0=u.catch(0),a({state:"error",error:u.t0}),u.abrupt("return");case 18:case"end":return u.stop()}}),_callee2,null,[[0,14]])})));return function loadPlayers(){return n.apply(this,arguments)}}();"not-started"===r.state&&(n(),a({state:"loading",details:mapObject(e.track.keyObject(),(function(){return{loadedBytes:0,totalBytes:"initial"}}))}))}),[r,a,e.track,e.buttonSpecs]),"not-started"===r.state)return l.a.createElement(Pa,null,l.a.createElement(Bt.a,{variant:"body1"},"Tracks have not started loading..."));if("loading"===r.state){var u=function(){var e,t=0;for(e in r.details){var n=r.details[e].totalBytes;switch(n){case"unknown":return"unknown";case"initial":return"initial";default:t+=n}}return t}(),d=function(){var e,t=0;for(e in r.details)t+=r.details[e].loadedBytes;return t}(),h=ha()(d);"unknown"!==u&&"initial"!==u&&(h+="/"+ha()(u));var m=function(){if("unknown"===u)return l.a.createElement(wr.a,null);var e=function(){if("initial"===u){return d/1e8*100}return d/u*100}();return l.a.createElement(wr.a,{variant:"determinate",value:e})}(),f=d===u?"Processing track...":"Loading track...";return l.a.createElement(Pa,null,l.a.createElement(Bt.a,{variant:"body1"},f,"(",h,")"),m)}if("error"===r.state){console.error(r.error);return l.a.createElement(Pa,{display:"flex",alignItems:"center"},l.a.createElement(Kt.a,{onClick:function refresh(){a({state:"not-started"})}},l.a.createElement(Xt.a,null)),l.a.createElement(Bt.a,{variant:"body1"},"Failed to load tracks"))}return l.a.createElement(Fa,{focused:e.focused,currentTrack:e.currentTrack,stems:r.item,playerControls:e.playerControls})},za=Object(f.a)((function(e){return{root:{padding:e.spacing(2),backgroundColor:jr.a[100]}}}))(Nt.a),Ra=function TrackPlayer(e){var t=function(){switch(e.track.track_type){case"single":return l.a.createElement(ia,{focused:e.focused,currentTrack:e.currentTrack,track:e.track,playerControls:e.playerControls});case"2stems":return l.a.createElement(Aa,{focused:e.focused,currentTrack:e.currentTrack,track:e.track,buttonSpecs:[{label:"vocals",buttonColour:"lightBlue"},{label:"accompaniment",buttonColour:"purple"}],playerControls:e.playerControls});case"4stems":return l.a.createElement(Aa,{focused:e.focused,currentTrack:e.currentTrack,track:e.track,buttonSpecs:[{label:"vocals",buttonColour:"lightBlue"},{label:"other",buttonColour:"purple"},{label:"bass",buttonColour:"pink"},{label:"drums",buttonColour:"yellow"}],playerControls:e.playerControls});case"5stems":return l.a.createElement(Aa,{focused:e.focused,currentTrack:e.currentTrack,track:e.track,buttonSpecs:[{label:"vocals",buttonColour:"lightBlue"},{label:"other",buttonColour:"purple"},{label:"piano",buttonColour:"lightGreen"},{label:"bass",buttonColour:"pink"},{label:"drums",buttonColour:"yellow"}],playerControls:e.playerControls});case"split_2stems":case"split_4stems":case"split_5stems":return l.a.createElement(za,null,l.a.createElement(Bt.a,{variant:"body1"},"Processing track. Refresh to check progress."),l.a.createElement(wr.a,null))}}();return l.a.createElement(Cr.a,{in:e.focused},t)},Na=Object(f.a)((function(e){return{root:{display:"flex",alignItems:"center",margin:e.spacing(.5)}}}))(Nt.a),_a=Object(f.a)((function(e){return{root:{display:"flex",justifyContent:"center",margin:e.spacing(.5)}}}))(Nt.a),Ma=Object(f.a)((function(e){return{root:Object(j.a)({minWidth:0},Qn(e))}}))(Kt.a),Ua=Object(At.a)((function(e){return{root:{"& .MuiSelect-select":{paddingLeft:e.spacing(2)}}}})),Ka=Object(f.a)((function(e){return{root:{minWidth:e.spacing(30)}}}))(vr.a),Va=Object(f.a)((function(e){var t=e.spacing(36);return{root:Object(j.a)({backgroundColor:"white",minWidth:"50vw",maxWidth:t},Xn(e))}}))(Nt.a),Wa=function MultiTrackPlayer(e){var t=Ua(),n=Hn(),r=Object(s.a)(n,2),a=r[0],o=r[1],c=e.show,u=e.onMinimize;Object(i.useEffect)((function(){if(c){var e=function handleKey(e){"Slash"===e.code&&(u(),e.preventDefault())};return a(e),function(){return o(e)}}}),[a,o,u,c]);var d=void 0!==e.onOpenTrackEditDialog&&l.a.createElement(Ma,{onClick:e.onOpenTrackEditDialog},l.a.createElement(gr.a,null)),h=l.a.createElement(Ma,{onClick:e.onRefresh},l.a.createElement(Xt.a,null)),m=function trackChangeHandler(t){var n=t.target.value;"number"===typeof n?e.onSelectCurrentTrack(n):console.error("Unexpected! Selected value in full size player selector is not a number type")},f=function(){var n=function(){if("loaded"===e.tracklistLoad.state)return e.tracklistLoad.tracklist.tracks.map((function(e,t){return l.a.createElement(Wt.a,{key:"".concat(t,"-").concat(e.label),value:t},e.label)}))}();return l.a.createElement(Ka,{className:t.root,disableUnderline:!0,value:e.currentTrackIndex,onChange:m},n)}(),p=l.a.createElement(ar,null,l.a.createElement(Nt.a,null),l.a.createElement(Na,null,h,d,f),l.a.createElement(Nt.a,null,l.a.createElement(Ma,{onClick:e.onMinimize},l.a.createElement(Er.a,null)))),y=function(){if("loading"===e.tracklistLoad.state)return l.a.createElement(_a,null,l.a.createElement(_t.a,null));return e.tracklistLoad.tracklist.tracks.map((function makePlayer(t,n){var r=n===e.currentTrackIndex,a=r&&e.show,o=r?e.playerControls:_n;return l.a.createElement(Ra,{key:"".concat(n,"-").concat(t.id),focused:a,currentTrack:r,track:t,playerControls:o})}))}();return l.a.createElement(Kn.a,{in:e.show,direction:"up"},rr(l.a.createElement(Va,null,p,l.a.createElement(Jt.a,null),y)))},Ga=function JamStation(e){var t=Object(i.useState)("minimized"),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)({open:!1,randomID:""}),c=Object(s.a)(o,2),u=c[0],d=c[1],h=Object(i.useState)(!1),m=Object(s.a)(h,2),f=m[0],p=m[1],y=Object(i.useState)(0),v=Object(s.a)(y,2),b=v[0],g=v[1],k=Un(e.timeSections),E="loaded"===e.tracklistLoad.state&&0===e.tracklistLoad.tracklist.tracks.length,w=function collapsedButtonFn(t,n,a){return l.a.createElement(yr,{className:e.collapsedButtonClassName,show:"minimized"===r,playersLoaded:f,playerControls:k,tooltipMessage:a,disabled:t,onClick:n})},C=function openTrackEditDialog(){d({open:!0,randomID:A.a.generate()})},O=function closeTrackEditDialog(){d({open:!1,randomID:""})},j=u.open&&l.a.createElement(zn,{key:u.randomID,open:u.open,trackListLoad:e.tracklistLoad,onSubmit:function handleTrackListChange(t){var n;O(),null===(n=e.onTrackListChanged)||void 0===n||n.call(e,t)},onClose:O,onRefresh:e.onRefresh}),L=Object(i.useCallback)((function(){f||p(!0),a("full")}),[f,p,a]),S=Object(i.useCallback)((function(){a("minimized")}),[a]);if(E)return l.a.createElement(l.a.Fragment,null,w(!1,C,"Show Player"),j);if(!f)return w(!1,L,"Show Player");var B=f&&l.a.createElement(Wa,{show:"full"===r,tracklistLoad:e.tracklistLoad,playerControls:k,currentTrackIndex:b,onSelectCurrentTrack:g,onMinimize:S,onRefresh:e.onRefresh,onOpenTrackEditDialog:C});return l.a.createElement(l.a.Fragment,null,w(!1,L,"Show Player"),B,j)},Ja=n(67),Ha=function validateError(e){return"object"===typeof e&&(null!==e&&void 0!==e&&("code"in e&&"msg"in e))},qa=function useErrorMessage(){var e=Object(p.b)().enqueueSnackbar,t=function showErrorMsg(t){e(t,{variant:"error"})};return function(){var e=Object(ua.a)(ca.a.mark((function _callee(e){var n,r,a;return ca.a.wrap((function _callee$(o){for(;;)switch(o.prev=o.next){case 0:if(n=function showGenericErrorMsg(){console.error(e),t("An unknown error has occurred - please check the console for more details")},e instanceof sa.a.HTTPError){o.next=4;break}return n(),o.abrupt("return");case 4:return r=e.response.clone(),o.next=7,r.json();case 7:if(a=o.sent,Ha(a)){o.next=11;break}return n(),o.abrupt("return");case 11:console.error(a.msg),o.t0=a.code,o.next="create_song_exists"===o.t0?15:"update_song_overwrite"===o.t0?17:"song_not_found"===o.t0?19:"failed_google_verification"===o.t0?21:"get_songs_for_user_not_allowed"===o.t0?23:"update_song_owner_not_allowed"===o.t0?25:"update_song_wrong_id"===o.t0?27:"datastore_error"===o.t0?29:31;break;case 15:return t("Save failed: The song already exists and can't be created again!"),o.abrupt("break",33);case 17:return t("Autosave failed: This song has been updated recently and saving now will clobber previously saved results. Please try to load the song in another tab and copy your work over to save it"),o.abrupt("break",33);case 19:return t("Not found: A song of this ID cannot be found"),o.abrupt("break",33);case 21:return t("Google verification failed: Please try to refresh and login again"),o.abrupt("break",33);case 23:return t("Loading songs failed: You don't have permission to see this user's songs"),o.abrupt("break",33);case 25:return t("Autosave failed: You don't have permission to update this user's songs"),o.abrupt("break",33);case 27:return t("Autosave failed: There is a mismatch of song IDs. Please refresh and try again"),o.abrupt("break",33);case 29:return t("The data operation was not successful - please check the console for more details"),o.abrupt("break",33);case 31:return t("An unknown error has occurred - please check the console for more details"),o.abrupt("break",33);case 33:case"end":return o.stop()}}),_callee)})));return function(t){return e.apply(this,arguments)}}()},Ya=function(){return"https://chord-be.philipwong.pw"}(),$a=function(){var e=Object(ua.a)(ca.a.mark((function _callee(e){var t;return ca.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,sa.a.post("".concat(Ya,"/login"),{headers:{Authorization:"Bearer "+e}}).json();case 3:t=n.sent,n.next=9;break;case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",Object(B.left)(n.t0));case 9:return n.abrupt("return",Object(B.right)(t));case 10:case"end":return n.stop()}}),_callee,null,[[0,6]])})));return function login(t){return e.apply(this,arguments)}}(),Xa=function(){var e=Object(ua.a)(ca.a.mark((function _callee2(e){var t;return ca.a.wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,sa.a.get("".concat(Ya,"/songs/").concat(e)).json();case 3:t=n.sent,n.next=9;break;case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",Object(B.left)(n.t0));case 9:return n.abrupt("return",Object(B.right)(t));case 10:case"end":return n.stop()}}),_callee2,null,[[0,6]])})));return function getSong(t){return e.apply(this,arguments)}}(),Qa=function(){var e=Object(ua.a)(ca.a.mark((function _callee3(e){var t;return ca.a.wrap((function _callee3$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,sa.a.get("".concat(Ya,"/songs/").concat(e,"/tracklist"),{timeout:!1}).json();case 3:t=n.sent,n.next=9;break;case 6:return n.prev=6,n.t0=n.catch(0),n.abrupt("return",Object(B.left)(n.t0));case 9:return n.abrupt("return",Object(B.right)(t));case 10:case"end":return n.stop()}}),_callee3,null,[[0,6]])})));return function getTrackList(t){return e.apply(this,arguments)}}(),Za=function(){var e=Object(ua.a)(ca.a.mark((function _callee4(e,t){var n;return ca.a.wrap((function _callee4$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,sa.a.get("".concat(Ya,"/users/").concat(e,"/songs"),{headers:{Authorization:"Bearer "+t}}).json();case 3:n=r.sent,r.next=9;break;case 6:return r.prev=6,r.t0=r.catch(0),r.abrupt("return",Object(B.left)(r.t0));case 9:return r.abrupt("return",Object(B.right)(n));case 10:case"end":return r.stop()}}),_callee4,null,[[0,6]])})));return function getSongsForUser(t,n){return e.apply(this,arguments)}}(),eo=function(){var e=Object(ua.a)(ca.a.mark((function _callee5(e,t){var n;return ca.a.wrap((function _callee5$(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,sa.a.post("".concat(Ya,"/songs"),{json:e,headers:{Authorization:"Bearer "+t}}).json();case 3:n=r.sent,r.next=9;break;case 6:return r.prev=6,r.t0=r.catch(0),r.abrupt("return",Object(B.left)(r.t0));case 9:return r.abrupt("return",Object(B.right)(n));case 10:case"end":return r.stop()}}),_callee5,null,[[0,6]])})));return function createSong(t,n){return e.apply(this,arguments)}}(),to=function(){var e=Object(ua.a)(ca.a.mark((function _callee6(e,t){var n;return ca.a.wrap((function _callee6$(r){for(;;)switch(r.prev=r.next){case 0:if(!e.isUnsaved()){r.next=2;break}return r.abrupt("return",Object(B.left)(new Error("A song that hasn't been created can't be updated")));case 2:return r.prev=2,r.next=5,sa.a.put("".concat(Ya,"/songs/").concat(e.id),{json:e,headers:{Authorization:"Bearer "+t}}).json();case 5:n=r.sent,r.next=11;break;case 8:return r.prev=8,r.t0=r.catch(2),r.abrupt("return",Object(B.left)(r.t0));case 11:return r.abrupt("return",Object(B.right)(n));case 12:case"end":return r.stop()}}),_callee6,null,[[2,8]])})));return function updateSong(t,n){return e.apply(this,arguments)}}(),no=function(){var e=Object(ua.a)(ca.a.mark((function _callee7(e,t){var n;return ca.a.wrap((function _callee7$(r){for(;;)switch(r.prev=r.next){case 0:if(""!==e.song_id){r.next=2;break}return r.abrupt("return",Object(B.left)(new Error("No song ID on the tracklist")));case 2:return r.prev=2,r.next=5,sa.a.put("".concat(Ya,"/songs/").concat(e.song_id,"/tracklist"),{json:e,headers:{Authorization:"Bearer "+t}}).json();case 5:n=r.sent,r.next=11;break;case 8:return r.prev=8,r.t0=r.catch(2),r.abrupt("return",Object(B.left)(r.t0));case 11:return r.abrupt("return",Object(B.right)(n));case 12:case"end":return r.stop()}}),_callee7,null,[[2,8]])})));return function updateTrackList(t,n){return e.apply(this,arguments)}}(),ro=x.l([en,on,un,hn,Tn]),ao=x.k({song_id:x.i,tracks:x.b(ro)}),oo=function(){function TrackList(e,t){Object(L.a)(this,TrackList),this.song_id=void 0,this.tracks=void 0,this.song_id=e,this.tracks=t}return Object(S.a)(TrackList,null,[{key:"fromValidatedFields",value:function fromValidatedFields(e){var t=e.tracks.map((function deserializeTrack(e){switch(e.track_type){case"single":return tn.fromValidatedFields(e);case"2stems":return ln.fromValidatedFields(e);case"4stems":return sn.fromValidatedFields(e);case"5stems":return mn.fromValidatedFields(e);case"split_2stems":case"split_4stems":case"split_5stems":return xn.fromValidatedFields(e)}}));return new TrackList(e.song_id,t)}},{key:"fromJSONObject",value:function fromJSONObject(e){var t=ao.decode(e);return Object(B.isLeft)(t)?Object(B.left)(new Error("Invalid Chord Song object")):Object(B.right)(this.fromValidatedFields(t.right))}}]),TrackList}(),io=n(198),lo=n.n(io),co=Object(At.a)({root:{objectFit:"contain"}}),uo=function ErrorImage(){var e=co();return l.a.createElement("img",{src:lo.a,className:e.root,alt:"Song Loading Error"})},so=function(){function User(e,t,n){var r=this;Object(L.a)(this,User),this.googleUser=void 0,this.name=void 0,this.userID=void 0,this.authToken=void 0,this.googleUser=e,this.userID=t,this.name=n,this.authToken=e.get().getAuthResponse().id_token,this.googleUser.listen((function(){r.refreshAuthToken.call(r)}))}return Object(S.a)(User,[{key:"refreshAuthToken",value:function refreshAuthToken(){this.authToken=this.getNewAuthToken()}},{key:"getNewAuthToken",value:function getNewAuthToken(){return this.googleUser.get().getAuthResponse().id_token}}]),User}(),ho=l.a.createContext(null),mo=function deserializeUser(e,t){return fo(e)?new so(t,e.id,e.name):null},fo=function validateResponse(e){return"object"===typeof e&&(null!==e&&void 0!==e&&("id"in e&&"name"in e))},po=function TrackListProvider(e){var t=qa(),n=l.a.useContext(ho),r=Object(i.useState)({state:"not-started"}),a=Object(s.a)(r,2),o=a[0],c=a[1],u=function handleFetchedTracklist(e){if(Object(Ja.isLeft)(e))c({state:"error",error:e.left});else{var t=oo.fromJSONObject(e.right);Object(Ja.isLeft)(t)?c({state:"error",error:"Failed to deserialize payload to tracklist"}):c({state:"loaded",item:t.right})}},d=function(){var t=Object(ua.a)(ca.a.mark((function _callee(){var t;return ca.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Qa(e.song.id);case 2:t=n.sent,u(t);case 4:case"end":return n.stop()}}),_callee)})));return function fetchTrackList(){return t.apply(this,arguments)}}(),h=function(){var t=Object(ua.a)(ca.a.mark((function _callee2(t){var r;return ca.a.wrap((function _callee2$(a){for(;;)switch(a.prev=a.next){case 0:if(null!==n&&e.song.isOwner(n)){a.next=3;break}return c({state:"loaded",item:t}),a.abrupt("return");case 3:return a.next=5,no(t,n.authToken);case 5:r=a.sent,u(r);case 7:case"end":return a.stop()}}),_callee2)})));return function handleTrackListChanged(e){return t.apply(this,arguments)}}(),m=function refresh(){return c({state:"not-started"})};switch(o.state){case"not-started":return c({state:"loading"}),d(),l.a.createElement(l.a.Fragment,null);case"error":return t(o.error),l.a.createElement(uo,null);case"loading":return e.children({state:"loading"},h,m);case"loaded":return e.children({state:"loaded",tracklist:o.item},h,m)}};!function(e){e[e.START=0]="START",e[e.END=1]="END",e[e.MIDDLE=2]="MIDDLE"}(Le||(Le={}));var yo=function normalizeNodeBoundary(e,t){var n=vo(e,t);if(n===Le.MIDDLE)return[e,t];var r=bo(e);return n===Le.END&&(r+=1),normalizeNodeBoundary(function parentNode(e){if(null===e.parentNode)throw new Error("Node doesn't have parent");return e.parentNode}(e),r)},vo=function getPositionForNode(e,t){switch(e.nodeType){case Node.TEXT_NODE:return function getPositionForTextNode(e,t){if(0===t)return Le.START;var n=e.nodeValue;if(null===n)throw new Error("Text node has no value?");return t===n.length?Le.END:Le.MIDDLE}(e,t);case Node.ELEMENT_NODE:return function getPositionForElementNode(e,t){var n=e.childNodes;return 0===t?Le.START:t===n.length?Le.END:Le.MIDDLE}(e,t);default:throw new Error("Crash for now "+e.nodeType)}},bo=function findOffsetForNode(e){if(null===e.parentNode)throw new Error("wtf");for(var t=e.parentNode.childNodes,n=0;n<t.length;n++)if(t.item(n)===e)return n;throw new Error("Child node doesn't exist in parent???")},go=function getSelectedLineIDs(){var e=window.getSelection();if(null===e||0===e.rangeCount)return[];var t=function getWideSelectionBoundary(e){var t=document.createRange(),n=e.getRangeAt(0);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset);for(var r=1;r<e.rangeCount;r++){var a=e.getRangeAt(r);-1===a.compareBoundaryPoints(Range.START_TO_START,t)&&t.setStart(a.startContainer,a.startOffset),1===a.compareBoundaryPoints(Range.END_TO_END,t)&&t.setEnd(a.endContainer,a.endOffset)}return t}(e);!function normalizeRange(e){var t=yo(e.startContainer,e.startOffset),n=Object(s.a)(t,2),r=n[0],a=n[1],o=yo(e.endContainer,e.endOffset),i=Object(s.a)(o,2),l=i[0],c=i[1];e.setStart(r,a),e.setEnd(l,c)}(t);for(var n=document.querySelectorAll("[data-lineid]"),r=[],a=0;a<n.length;a++){var o=n.item(a);if(t.intersectsNode(o)){var i=o.getAttribute("data-lineid");if(null===i)throw new Error("Unexpected - line element should have line ID because that's how it was selected");r.push(i)}}return r},ko=x.k({copiedChordLines:x.b(Ee)}),Eo=function useLineCopyHandler(e){var t=Object(p.b)().enqueueSnackbar;return function(n){var r=go(),a=e.chordLines.list.filter((function(e){return r.includes(e.id)}));if(0===a.size)return!1;var o,i=function serializeCopiedChordLines(e){var t={copiedChordLines:e.map((function(e){return e.forCopying()})).toArray()};return JSON.stringify(t)}(a);return n.clipboardData.setData("application/json",i),n.preventDefault(),o=1===a.size?"1 line copied to your clipboard":"".concat(a.size," lines copied to your clipboard"),t(o,{variant:"info"}),!0}},wo=l.a.createContext({startInteraction:function startInteraction(){},endInteraction:function endInteraction(){}}),Co=function useEditingState(){var e=Object(i.useState)(!1),t=Object(s.a)(e,2),n=t[0],r=t[1],a=Object(i.useContext)(wo),o=a.startInteraction,l=a.endInteraction;return{editing:n,startEdit:function startEdit(){r(!0),o()},finishEdit:function finishEdit(){r(!1),l()}}},Oo=n(89),jo=n.n(Oo),Lo=n(130),So=n.n(Lo),Bo=n(131),To=n.n(Bo),xo=n(12),Do=n(404),Io=function highlightedSpaceStyle(e){return{backgroundColor:e.palette.primary.main}},Fo=function highlightedWordStyle(e){return{color:e.palette.primary.main}},Po=function outlineStyle(e){return{borderStyle:"solid",borderColor:e.palette.primary.main,borderRadius:"0.3em",borderWidth:"0.075em"}},Ao=function withCustomLyricSelector(e,t){return void 0===(null===t||void 0===t?void 0:t.customLyricClassSelector)?e:"".concat(e,".").concat(t.customLyricClassSelector)},zo=function withCustomChordSymbolSelector(e,t){return void 0===(null===t||void 0===t?void 0:t.customChordSymbolClassSelector)?e:"".concat(e,".").concat(t.customChordSymbolClassSelector)},Ro=function dragOverChordLyricStyle(e){return function(t){var n,r=Io(t),a=Fo(t),o=void 0!==(null===e||void 0===e?void 0:e.outline)?e.outline(t):void 0,i=Object(j.a)(Object(j.a)({},Po(t)),o),l=Ao(".".concat("LyricTokenSpace"),e),c=Ao(".".concat("LyricTokenWord"),e),u=zo(".".concat("ChordSymbol"),e);return{root:(n={},Object(N.a)(n,"& ".concat(l),r),Object(N.a)(n,"& ".concat(c),a),Object(N.a)(n,"& ".concat(u),i),n)}}},No=function hoverChordLyricStyle(e){return function(t){var n,r=Io(t),a=Fo(t),o=void 0!==(null===e||void 0===e?void 0:e.outline)?e.outline(t):void 0,i=Object(j.a)(Object(j.a)({},Po(t)),o),l=Ao(".".concat("LyricTokenSpace"),e),c=Ao(".".concat("LyricTokenWord"),e),u=function withCustomChordTargetSelector(e,t){return void 0===(null===t||void 0===t?void 0:t.customChordTargetClassSelector)?e:"".concat(e,".").concat(t.customChordTargetClassSelector)}(".".concat("ChordTarget"),e),s=zo(".".concat("ChordSymbol"),e);return{root:(n={},Object(N.a)(n,"& ".concat(u,":hover ~ ").concat(l),r),Object(N.a)(n,"& ".concat(u,":hover ~ * ").concat(l),r),Object(N.a)(n,"& ".concat(u,":hover ~ ").concat(c),a),Object(N.a)(n,"& ".concat(u,":hover ~ * ").concat(c),a),Object(N.a)(n,"& ".concat(u).concat(s,":hover"),i),Object(N.a)(n,"& ".concat(u,":hover ").concat(s),i),n)}}},_o=function deserializeLyrics(e,t){for(var n=[],r=e.tokenize(),a=function _loop(e){var a=r.get(e);if(void 0===a)throw new Error("Token index not found");var o=a.get((function(n){return function deserializeLyricStr(e,t,n){if(W("serializedStr",e)){var r=V("serializedStr",e);return l.a.createElement(Q,{key:t,type:r.sizedTab,edit:n})}return e}(n,e,t)}));"string"===typeof o&&n.length>0&&"string"===typeof n[n.length-1]?n[n.length-1]+=o:n.push(o)},o=0;o<r.size;o++)a(o);return n},Mo=function serializeLyrics(e){var t="";return e.forEach((function(e){var n=G(e);if(null!==n){var r=V("sizedTab",n);t+=r.serializedStr}else t+=e.textContent})),new re(t)},Uo={variant:"h6",display:"inline"},Ko=Object(Do.a)({root:{whiteSpace:"pre",wordSpacing:".15em",display:"inline-block"}}),Vo=Object(Pt.a)(Ko)(Bt.a),Wo=function LyricDisplay(e){var t,n,r=null!==(t=e.className)&&void 0!==t?t:"",a=Object(xo.a)((n={},Object(N.a)(n,"LyricTokenSpace",e.children.isEntirelySpace()),Object(N.a)(n,"LyricTokenWord",!e.children.isEntirelySpace()),Object(N.a)(n,r,void 0!==e.className),n));return l.a.createElement(Vo,Object.assign({},Uo,{className:a,"data-testid":e["data-testid"]}),_o(e.children,!1))},Go=Object(f.a)({root:{whiteSpace:"pre",cursor:"pointer",fontFamily:"PoriChord",userSelect:"all"}})(Bt.a),Jo=function ChordSymbol(e){return l.a.createElement(Go,{variant:"h6",display:"inline","data-testid":"ChordSymbol",className:e.className},function formattedChord(){var t=e.children;return t.endsWith(" ")?t:ee(t+=" ")}())},Ho=n(401),qo=n(402),Yo=function NewDNDChord(e,t){return{type:"chord",sourceBlockID:e,chord:t}},$o=function useChordDrop(e,t){var n=Object(qo.a)({accept:"chord",drop:function drop(){return{type:"dropped-chord-result",blockID:e,tokenIndex:t}},collect:function collect(e){return{isOver:e.isOver({shallow:!0})}}}),r=Object(s.a)(n,2),a=r[0].isOver;return[r[1],a]},Xo=function ChordlessTokenDroppable(e){var t=$o(e.blockID,e.tokenIndex),n=Object(s.a)(t,2),r=n[0],a=n[1]?e.dragOverClassName:e.hoverableClassName,o=l.a.cloneElement(e.children,{className:a});return l.a.createElement(Ho.a,{rootRef:r},o)},Qo=function ChordTokenDroppable(e){var t=$o(e.blockID,0),n=Object(s.a)(t,2),r=n[0],a=n[1],o=e.onDragOver;return Object(i.useEffect)((function(){o(a)}),[o,a]),l.a.createElement(Ho.a,{rootRef:r},e.children)},Zo=n(403),ei=function DraggableChordSymbol(e){var t=Object(Zo.a)({item:Yo(e.chordBlockID,e.children),end:function end(t,n){if(void 0!==t){var r=n.getDropResult();(function isDropResult(e){return null!==e&&void 0!==e&&("object"===typeof e&&"dropped-chord-result"===e.type)})(r)&&e.onDrop({chord:t.chord,sourceBlockID:t.sourceBlockID,destinationBlockID:r.blockID,splitIndex:r.tokenIndex,dropType:r.dropEffect})}}}),n=Object(s.a)(t,2)[1];return l.a.createElement(Ho.a,{rootRef:n},l.a.createElement(Jo,{className:e.className},e.children))},ti=function reducer(e,t){return e.set(t.index,t.isDraggingOver)},ni=n(45),ri=function ControlledTextInput(e){var t=Object(ni.a)(),n=function finish(t){var n;null===(n=e.onFinish)||void 0===n||n.call(e,t)},r=function(){var n,r,a,o=void 0;void 0!==e.typographyVariant&&(o=null===t||void 0===t||null===(a=t.typography)||void 0===a?void 0:a[e.typographyVariant]);var i={style:{padding:void 0===e.paddingSpacing?0:t.spacing(e.paddingSpacing),fontSize:null===(n=o)||void 0===n?void 0:n.fontSize,opacity:1,background:jr.a[100]},className:null===(r=e.classes)||void 0===r?void 0:r.root};return void 0!==e.width&&i.style&&(i.style.width=e.width),i}();return l.a.createElement(yn.a,{autoFocus:!0,variant:e.variant,inputProps:Object(j.a)({"data-testid":"InnerInput"},r),InputProps:e.InputProps,inputRef:e.inputRef,value:e.value,onBlur:function blurHandler(){n(e.value)},onChange:function updateValue(t){e.onValueChange(t.target.value)},onKeyDown:function keyDownHandler(t){"Enter"===t.key&&n(e.value)},placeholder:e.placeholder,error:e.error,fullWidth:!0,"data-testid":"TextInput"})},ai=function TextInput(e){var t=Object(i.useState)(e.value),n=Object(s.a)(t,2),r=n[0],a=n[1];return l.a.createElement(ri,{classes:e.classes,value:r,onValueChange:a,variant:e.variant,typographyVariant:e.typographyVariant,width:e.width,onFinish:e.onFinish})},oi=Object(Pt.a)({root:{color:"transparent",cursor:"pointer",userSelect:"none",position:"absolute",left:0,top:0,transform:"translate(0%, -115%)"}})(Vo),ii=function ChordTargetBox(e){return l.a.createElement(oi,Object.assign({},Uo,{onClick:e.onClick,className:e.className,"data-testid":"ChordEditButton"}),e.children)},li=function Token(e){var t=0===e.index?"FirstLyricToken":void 0,n=l.a.createElement(Wo,{className:t,"data-testid":"Token-".concat(e.index)},e.children);return l.a.createElement(Nt.a,{className:e.className,key:e.index,position:"relative",display:"inline","data-testid":"TokenBox-".concat(e.index)},function invisibleTarget(){if(void 0===e.invisibleTarget)return null;var t=_o(e.children,!1);return l.a.createElement(ii,{className:Object(xo.a)("ChordTarget","ChordSymbol"),onClick:e.invisibleTarget.onClick},t)}(),n)},ci=Object(f.a)((function(e){return{root:{fontFamily:"PoriChord",borderBottom:"solid",borderBottomColor:e.palette.primary.main,borderBottomWidth:"2px",width:"4em"}}}))(ai),ui={dragOver:Object(_.a)(Ro({outline:function outline(e){return{borderColor:jo.a[300],color:jo.a[300]}},customLyricClassSelector:"FirstLyricToken",customChordSymbolClassSelector:"BlockChordSymbol",customChordTargetClassSelector:"BlockChordTarget"})),hoverable:Object(_.a)(No({outline:function outline(e){return{color:e.palette.primary.dark}},customLyricClassSelector:"FirstLyricToken",customChordSymbolClassSelector:"BlockChordSymbol",customChordTargetClassSelector:"BlockChordTarget"}))},si={dragOver:Object(_.a)(Ro()),hoverable:Object(_.a)(No())},di=function Block(e){var t={hoverable:ui.hoverable(),dragOver:ui.dragOver()},n={hoverable:si.hoverable(),dragOver:si.dragOver()},r=Co(),a=r.editing,o=r.startEdit,c=r.finishEdit,u=function useChordTokenDragState(e,t){var n=Object(i.useReducer)(ti,Object(R.a)([!1,!1])),r=Object(s.a)(n,2),a=r[0],o=r[1],l=function getValue(e){var t=a.get(e);if(void 0===t)throw new Error("Out of index error");return t},c=[Object(i.useCallback)((function(e){return o({index:0,isDraggingOver:e})}),[o]),Object(i.useCallback)((function(e){return o({index:1,isDraggingOver:e})}),[o])];return[l(0)||l(1)?t:e,c[0],c[1]]}(t.hoverable.root,t.dragOver.root),d=Object(s.a)(u,3),m=d[0],f=d[1],p=d[2],y=e.chordBlock.lyricTokens;if(0===y.size){var v=new re("\xa0");y=Object(R.a)([v])}var b=function clickHandler(t){return function(n){0!==t&&e.onBlockSplit(e.chordBlock,t),o(),n.stopPropagation()}},g=function onDrop(t){e.songDispatch({type:"drag-and-drop-chord",sourceBlockID:t.sourceBlockID,newChord:t.chord,dropType:t.dropType,destinationBlockID:t.destinationBlockID,splitIndex:t.splitIndex})},k=function endEdit(t){var n;null===(n=e.onChordChange)||void 0===n||n.call(e,e.chordBlock,t),c()},E=function makeChordlessToken(t,r){var a={onClick:b(r)};return l.a.createElement(Xo,{key:r,blockID:e.chordBlock,tokenIndex:r,hoverableClassName:n.hoverable.root,dragOverClassName:n.dragOver.root},l.a.createElement(li,{index:r,invisibleTarget:a},t))},w=y.get(0);if(void 0===w)throw new Error("Lyric tokens list guaranteed at least one token");var C=y.slice(1),O=function makeFirstToken(t){return""!==e.chordBlock.chord?l.a.createElement(Qo,{key:0,blockID:e.chordBlock,onDragOver:p},l.a.createElement(li,{index:0},t)):E(t,0)}(w),j=C.map((function(e,t){return E(e,t+1)})).unshift(O),L=a?l.a.createElement(Nt.a,{"data-testid":"ChordEdit"},l.a.createElement(ci,{value:e.chordBlock.chord,variant:"filled",typographyVariant:"h6",onFinish:k})):""===e.chordBlock.chord?l.a.createElement(Jo,null,e.chordBlock.chord):l.a.createElement(ei,{chordBlockID:e.chordBlock,onDrop:g,className:Object(xo.a)("ChordSymbol","BlockChordSymbol")},e.chordBlock.chord);return l.a.createElement(Nt.a,{display:"inline-block"},l.a.createElement(h.a,{container:!0,direction:"column","data-testid":e["data-testid"],className:m},l.a.createElement(h.a,{className:Object(xo.a)("ChordTarget","BlockChordTarget"),onClick:b(0),item:!0},l.a.createElement(Qo,{blockID:e.chordBlock,onDragOver:f},L)),l.a.createElement(h.a,{item:!0,"data-testid":"Lyric"},j)))},hi=n(380),mi=Object(Pt.a)((function(e){return{contained:{backgroundColor:"transparent","&:hover":{backgroundColor:e.palette.primary.dark}}}}))(Kt.a),fi=Object(Pt.a)({tooltip:{padding:0,background:"transparent",margin:0}})(Vn.a),pi=function WithHoverMenu(e){var t=l.a.createElement(hi.a,{orientation:"vertical",variant:"text"},e.menuItems.map((function(e,t){return l.a.createElement(mi,{key:t,onClick:e.onClick,"data-testid":e["data-testid"]},e.icon)})));return l.a.createElement(fi,{placement:"right",title:t,interactive:!0},e.children)},yi=function contentEditableElement(e){if(null===e.current)throw new Error("unexpected for ref to be null");return e.current},vi=function selectionRange(e){var t=yi(e),n=window.getSelection();if(null===n||0===n.rangeCount)return null;var r=n.getRangeAt(0);return null!==r&&t.contains(r.startContainer)&&t.contains(r.endContainer)?r:null},bi=function insertNodeAtSelection(e,t){var n=yi(e),r=vi(e);return null!==r&&(r.deleteContents(),r.insertNode(t),r.collapse(!1),n.normalize(),!0)},gi=function childIndex(e,t){for(var n=e.childNodes,r=0;r<n.length;r++)if(t===n.item(r))return r;return null},ki=function nodeBeforeSelection(e){var t,n=yi(e),r=vi(e);if(null===r)return null;if(r.startContainer===n){if(0===r.startOffset)return null;t=r.startOffset-1}else{if(0!==r.startOffset)return null;var a=gi(n,r.startContainer);if(null===a||0===a)return null;t=a-1}return n.childNodes.item(t)},Ei=function enterHandler(e){return function(t){return"Enter"===t.key&&(e(),!0)}},wi=function specialBackspaceHandler(e,t){return function(n){return!("Backspace"!==n.key||!n.metaKey&&!n.ctrlKey)&&(!!function isSelectionAtBeginning(e){var t=vi(e);if(null===t)return!1;if(!t.collapsed)return!1;var n=yi(e);return t.startContainer===n&&0===t.startOffset||null!==n.firstChild&&t.startContainer===n.firstChild&&0===t.startOffset}(e)&&(t(),!0))}},Ci=function specialEnterHandler(e,t){return function(n){if(!("Enter"===n.key&&(n.metaKey||n.ctrlKey)))return!1;var r=vi(e);return null!==r&&(t(r.startOffset),!0)}},Oi=function tabHandler(e,t){return function(n){var r;if("Tab"!==n.key||n.shiftKey)if("Tab"===n.key&&n.shiftKey)r=o.LargeTab;else{if(" "!==n.key||!n.shiftKey)return!1;r=o.SmallTab}else r=o.MediumTab;var a=t(r);return bi(e,a)}},ji=function backspaceHandler(e){return function(t){if("Backspace"!==t.key)return!1;var n=ki(e);if(null===n||null===G(n))return!1;var r=n.parentElement;return null!==r&&(r.removeChild(n),!0)}},Li=function directionKeyHandler(e){return function(t){var n,r=yi(e),a=window.getSelection();if(null===a)return!1;if(t.shiftKey||t.metaKey||t.ctrlKey)return!1;if("ArrowLeft"!==t.key&&"ArrowRight"!==t.key)return!1;if("ArrowLeft"===t.key){var o=ki(e);if(null===o||null===G(o))return!1;var i=gi(r,o);if(null===i)return console.error("Unexpected - node cannot be found inside contenteditable element"),!1;n=i}else{var l=function nodeAfterSelection(e){var t=yi(e),n=vi(e);if(null===n)return null;var r,a=t.childNodes.length;if(n.endContainer===t){if(n.endOffset===a)return null;r=n.endOffset}else{if(n.endContainer.nodeType===n.endContainer.TEXT_NODE){var o=n.endContainer;if(n.endOffset!==o.length)return null}var i=gi(t,n.endContainer);if(null===i||i===a)return null;r=i+1}return t.childNodes.item(r)}(e);if(null===l||null===G(l))return!1;var c=gi(r,l);if(null===c)return console.error("Unexpected - node cannot be found inside contenteditable element"),!1;n=c+1}return a.setBaseAndExtent(r,n,r,n),!0}},Si=function useKeyDownHandler(e){var t=function useDomLyricTab(){var e=X();return function(t){var n=document.createElement("span");n.className=e[t].root,n.contentEditable="false";var r=V("sizedTab",t);return n.dataset.lyrictabtype=r["data-lyrictabtype"],n}}(),n=[Ci(e.contentEditableRef,e.specialEnterCallback),wi(e.contentEditableRef,e.specialBackspaceCallback),Oi(e.contentEditableRef,t),Ei(e.enterCallback),ji(e.contentEditableRef),Li(e.contentEditableRef),function(e){return!(!e.metaKey&&!e.ctrlKey)&&("b"===e.key||"B"===e.key||"u"===e.key||"U"===e.key||"i"===e.key||"I"===e.key)}];return function(e){var t,r=Object(z.a)(n);try{for(r.s();!(t=r.n()).done;){if((0,t.value)(e))return void e.preventDefault()}}catch(a){r.e(a)}finally{r.f()}}},Bi=function serializedLyricsFromRange(e){var t=e.cloneContents();return Mo(t.childNodes)},Ti=function composeMultilinePaste(e,t){var n=function splitContentBySelection(e){var t=vi(e),n=yi(e),r=document.createRange(),a=document.createRange();return null!==t?(r.setStart(n,0),r.setEnd(t.startContainer,t.startOffset),a.setStart(t.endContainer,t.endOffset),a.setEnd(n,n.childNodes.length)):(r.selectNodeContents(n),a.setStart(r.endContainer,r.endOffset),a.setEnd(r.endContainer,r.endOffset)),[r,a]}(e),r=Object(s.a)(n,2),a=r[0],o=r[1],i=Bi(a);i=i.append(t[0]);var l=t.slice(1).map((function(e){return new re(e)})),c=l.length-1,u=l[c].append(Bi(o));return l[c]=u,[i,l]},xi=function handlePlainTextPaste(e,t){return function(n){var r=n.clipboardData.getData("text/plain");if(""===r)return!1;var a=r.split("\r\n");if(0===(a=a.flatMap((function(e){return e.split("\n")}))).length)return!1;if(1===a.length)return bi(e,document.createTextNode(a[0]));var o=Ti(e,a),i=Object(s.a)(o,2),l=i[0],c=i[1];return t(l,c),!0}},Di=function handleJSONPaste(e){return function(t){var n=t.clipboardData.getData("application/json");return""!==n&&e(n)}},Ii=[function handleSelectOpaqueBlock(e){if(!e.isCollapsed)return!1;var t=e.getRangeAt(0);return null!==G(t.endContainer)&&(t.setStartAfter(t.endContainer),t.setEndAfter(t.endContainer),t.collapse(!0),!0)}],Fi=function handleSelectionChange(e){var t=document.getSelection();if(null!==t&&1===t.rangeCount){var n,r=Object(z.a)(Ii);try{for(r.s();!(n=r.n()).done;){if((0,n.value)(t))return void e.preventDefault()}}catch(a){r.e(a)}finally{r.f()}}},Pi=Object(f.a)({root:{width:"100%",backgroundColor:jr.a[200],whiteSpace:"pre",display:"inline-block"}})(Bt.a),Ai=Object(_.a)({root:{display:"inline-block",width:"100%",pointerEvents:"auto",userSelect:"text",outline:"none",wordSpacing:".15em","&:empty:before":{content:'"\\a0"'}}}),zi=function LyricInput(e){var t=l.a.createRef(),n=function value(){var e=yi(t);return null===e.textContent?new re(""):Mo(e.childNodes)},r=function finish(t){e.onFinish(t)},a=Si({contentEditableRef:t,enterCallback:function enterCallback(){r(n())},specialBackspaceCallback:function specialBackspaceCallback(){e.onSpecialBackspace()},specialEnterCallback:function specialEnterCallback(t){r(n()),e.onSpecialEnter(t)}}),o=function usePasteHandler(e){var t=[Di(e.pasteJSONCallback),xi(e.contentEditableRef,e.pastePlainTextCallback)];return function(e){var n,r=Object(z.a)(t);try{for(r.s();!(n=r.n()).done;){if((0,n.value)(e))return void e.preventDefault()}}catch(a){r.e(a)}finally{r.f()}}}({contentEditableRef:t,pasteJSONCallback:function pasteJSONCallback(t){var a=e.onJSONPaste(t),o=Object(s.a)(a,2),i=o[0],l=o[1];return i&&(r(n()),null===l||void 0===l||l()),i},pastePlainTextCallback:function pastePlainTextCallback(t,n){r(t),e.onLyricOverflow(n)}}),c=Ai(),u=_o(e.children,!0);return function useFocusAndPlaceCaretEffect(e){Object(i.useEffect)((function(){var t=yi(e);t.focus();var n=window.getSelection();if(null!==n){var r=document.createRange();r.selectNodeContents(t),r.collapse(!1),n.removeAllRanges(),n.addRange(r)}}))}(t),function useSelectionChangeEffect(){Object(i.useEffect)((function(){return document.addEventListener("selectionchange",Fi),function(){return document.removeEventListener("selectionchange",Fi)}}))}(),l.a.createElement(Pi,{classes:e.classes,variant:e.variant,display:"inline","data-testid":"LyricInput"},l.a.createElement("span",{contentEditable:!0,className:c.root,ref:t,"data-testid":"InnerInput",onBlur:function handleBlur(){r(n())},onKeyDown:a,onPaste:o,suppressContentEditableWarning:!0},u))},Ri=Object(Pt.a)((function(e){return{root:Object(j.a)(Object(j.a)({},Ko.root),{},{borderBottom:"solid",borderBottomColor:e.palette.secondary.main,borderBottomWidth:"2px"})}}))(zi),Ni=function WithLyricInput(e){var t=Co(),n=t.editing,r=t.startEdit,a=t.finishEdit,o=e.songDispatch,c=e.chordLine,u=Object(p.b)().enqueueSnackbar,s=Object(i.useMemo)((function(){return{lyricEdit:function lyricEdit(e){a(),o({type:"replace-line-lyrics",line:c,lineID:c,newLyric:e})},lyricPasteOverflow:function lyricPasteOverflow(e){o({type:"insert-overflow-lyrics",insertionLineID:c,overflowLyrics:e}),a()},jsonPaste:function jsonPaste(e){var t=function deserializeCopiedChordLines(e){var t=Object(B.parseJSON)(e,(function(){return new Error("Failed to parse json string")}));if(Object(B.isLeft)(t))return t;var n=t.right;if(void 0===n.copiedChordLines)return null;var r=ko.decode(n);if(Object(B.isLeft)(r))return Object(B.left)(new Error("Invalid Chord Lines payload"));var a=r.right.copiedChordLines.map((function(e){return je.fromValidatedFields(e)}));return Object(B.right)(a)}(e);if(null===t)return[!1,null];if(Object(B.isLeft)(t)){var n="Failed to paste copied lines: "+t.left.message;return u(n,{variant:"error"}),[!0,null]}return[!0,function insertLines(){return o({type:"batch-insert-lines",insertLineID:c,copiedLines:t.right})}]},specialBackspace:function specialBackspace(){o({type:"merge-lines",latterLineID:c}),a()},specialEnter:function specialEnter(e){o({type:"split-line",lineID:c,splitIndex:e}),a()}}}),[c,o,a,u]),d=e.children(r);return n?l.a.createElement(l.a.Fragment,null,d,l.a.createElement(Nt.a,{position:"absolute",left:"0",bottom:"2px",width:"100%"},l.a.createElement(Ri,{variant:"h6",onFinish:s.lyricEdit,onJSONPaste:s.jsonPaste,onLyricOverflow:s.lyricPasteOverflow,onSpecialBackspace:s.specialBackspace,onSpecialEnter:s.specialEnter},e.chordLine.lyrics))):d},_i=Object(Do.a)({root:{borderColor:U.a[500],borderStyle:"solid",borderRadius:"0.3em",borderWidth:"0.075em",color:U.a[500],display:"inline-block"}}),Mi=n(58),Ui=Object(f.a)({root:{color:jr.a[400]}})(Bt.a),Ki=function EditableTypography(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],o=void 0!==e.editControl?e.editControl.editing:r,c=function startEdit(){void 0!==e.editControl?e.editControl.onStartEdit():a(!0)},u=function finishEdit(t){void 0!==e.editControl?e.editControl.onEndEdit():a(!1),e.onValueChange&&e.onValueChange(t)},d=o?function editableLine(){if("inherit"===e.variant||"srOnly"===e.variant)throw new Error("can't have these variant types");return l.a.createElement(ai,{value:e.value,variant:"filled",typographyVariant:e.variant,onFinish:u,"data-testid":"EditableLine"})}():function nonEditableLine(){e.value,e.placeholder,e.onValueChange,e.editControl;var t=Object(Mi.a)(e,["value","placeholder","onValueChange","editControl"]);return""===e.value&&void 0!==e.placeholder?l.a.createElement(Ui,Object.assign({},t,{onClick:c}),e.placeholder):l.a.createElement(Bt.a,Object.assign({},t,{onClick:c}),ee(e.value))}();return l.a.createElement(Nt.a,null,d)},Vi=n(381),Wi=n(382),Gi=n(200),Ji=n.n(Gi),Hi=Object(f.a)((function(e){return{root:{textAlign:"right",width:er(e,"body1","00:00")}}}))(ri),qi=function TimeInput(e){var t=function secondsToString(e){return null===e?"":Rn.Duration.fromMillis(1e3*e).toFormat("mss")},n=t(e.seconds),r=Object(i.useState)(n),a=Object(s.a)(r,2),o=a[0],c=a[1],u=Object(i.useRef)(null),d=Object(i.useContext)(zt),h=function decomposeTimeString(e){var t=Number(e),n=t%100;return[Math.floor(t/100),n]},m=function validateTimeValue(e){if(""===e)return!0;var t=h(e),n=Object(s.a)(t,2),r=n[0],a=n[1];return!isNaN(r)&&!isNaN(a)&&!(a>59||a<0)},f=function finish(t){var n,r;if(""!==t){if(m(t)){var a=h(t),o=Object(s.a)(a,2),i=o[0],l=o[1];null===(n=e.onFinish)||void 0===n||n.call(e,60*i+l)}}else null===(r=e.onFinish)||void 0===r||r.call(e,null)},p=l.a.createElement(Vi.a,{position:"start"},l.a.createElement(Wi.a,{edge:"start",onClick:function handleCurrentTimeButton(){var e=d.current;if(null!==e){var n=e(),r=t(n);c(r),f(r),null!==u.current&&void 0!==u.current.focus&&null!==u.current.focus&&u.current.focus()}}},l.a.createElement(Ji.a,null))),y=function formatValue(e){if(""===e)return"";if(1===e.length)return"0:0"+e;if(2===e.length)return"0:"+e;var t=e.length-2;return e.substring(0,t)+":"+e.substring(t)}(o),v=!m(o);return l.a.createElement(Hi,{placeholder:"0:00",value:y,onValueChange:function handleValueChange(e){c(function sanitizeValue(e){var t=e.replaceAll(/\D/g,"");return"0"===t?"000":"00"===t?"":t=t.replace(/^0+/,"")}(e))},variant:"standard",typographyVariant:"body1",onFinish:function onFinish(){return f(o)},paddingSpacing:.5,error:v,InputProps:{startAdornment:p,disableUnderline:!v},inputRef:u})},Yi=Object(f.a)(_i)(Ki),$i=Object(f.a)((function(e){return{tooltip:{background:"white",boxShadow:e.shadows[2]}}}))(Vn.a),Xi=function WithSection(e){var t,n=Co(),r=n.editing,a=n.startEdit,o={editing:r,onStartEdit:a,onEndEdit:n.finishEdit},c=e.chordLine,u=e.songDispatch,s=Object(i.useCallback)((function(e){u({type:"set-section",lineID:c,label:e})}),[c,u]),d=Object(i.useCallback)((function(e){u({type:"set-section",lineID:c,time:e})}),[c,u]),h=e.children(a),m=e.chordLine.section;if(!r&&void 0===m)return h;var f=null!==(t=null===m||void 0===m?void 0:m.name)&&void 0!==t?t:"",p=function(){var e="time"===(null===m||void 0===m?void 0:m.type)?m.time:null;return l.a.createElement(qi,{seconds:e,onFinish:d})}(),y=r;return l.a.createElement(l.a.Fragment,null,l.a.createElement(Nt.a,null,l.a.createElement($i,{arrow:!0,placement:"left",interactive:!0,title:p,disableFocusListener:y},l.a.createElement("span",null,l.a.createElement(Yi,{value:f,variant:"body2","data-testid":"EditLabel",editControl:o,onValueChange:s})))),h)},Qi=Object(Pt.a)({root:{userSelect:"all"}})(Nt.a),Zi=Object(Pt.a)({root:{color:jo.a[300]}})(So.a),el=Object(Pt.a)({root:{"&:hover":{backgroundColor:jr.a[100]},whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}})(Nt.a),tl=l.a.memo((function Line(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],o=e.chordLine,c=e.songDispatch,u=Object(i.useMemo)((function(){return{chordChange:function chordChange(e,t){c({type:"set-chord",lineID:o,blockID:e,newChord:t})},blockSplit:function blockSplit(e,t){c({type:"split-block",lineID:o,blockID:e,splitIndex:t})},remove:function remove(){r||(a(!0),setTimeout((function(){c({type:"remove-line",lineID:o})}),250))}}}),[o,c,r]),d=e.chordLine.chordBlocks;0===d.length&&(d=new se([new le({chord:"",lyric:new re("")})]));var h=d.list.map((function(e){return l.a.createElement(di,{key:e.id,chordBlock:e,songDispatch:c,onChordChange:u.chordChange,onBlockSplit:u.blockSplit,"data-testid":"Block"})})),m=function withHoverMenu(e,t){return l.a.createElement(pi,{menuItems:t},function basicLine(e){return l.a.createElement(el,{"data-testid":"NoneditableLine",onClick:e},h)}(e))},f=l.a.createElement(Xi,{chordLine:o,songDispatch:c},(function(e){return function withLyricInput(e){return l.a.createElement(Ni,{chordLine:o,songDispatch:c},(function(t){return m(t,e)}))}([{onClick:e,icon:l.a.createElement(To.a,null),"data-testid":"EditLabel"},{onClick:u.remove,icon:l.a.createElement(Zi,null),"data-testid":"RemoveButton"}])})),p=r?"up":"down";return l.a.createElement(Kn.a,{direction:p,in:!r,timeout:250},l.a.createElement(Qi,null,l.a.createElement(Nt.a,{borderBottom:1,width:"100%",position:"relative","data-lineid":e["data-lineid"],"data-testid":e["data-testid"]},f)))})),nl=n(201),rl=n.n(nl),al=n(139),ol=Object(f.a)({root:{"&:hover .MuiDivider-root":{backgroundColor:"rgba(0, 0, 0, 0.25)"}}})(h.a),il=Object(f.a)({tooltip:{padding:0,background:"transparent",margin:0}})(Vn.a),ll=Object(f.a)({root:{width:"100%",backgroundColor:"transparent"}})(Jt.a),cl=Object(f.a)((function(e){return{root:{color:e.palette.secondary.light}}}))(rl.a),ul=l.a.memo((function NewLine(e){var t=Object(al.a)(),n=function handleAddLine(){e.songDispatch({type:"add-line",lineID:e.lineID})};return l.a.createElement(il,{title:function hoverMenu(){return l.a.createElement(Kt.a,{"data-testid":"AddButton",onClick:n},l.a.createElement(cl,null))}(),interactive:!0,placement:"right"},l.a.createElement(ol,{container:!0,direction:"column",justify:"center",onClick:n,"data-testid":e["data-testid"],style:{minHeight:t.spacing(3)}},l.a.createElement(ll,null)))})),sl=Object(_.a)({root:{pointerEvents:"none"}}),dl=Object(Pt.a)({root:{width:"auto"}})(St.a),hl=function ChordPaperBody(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Eo(e.song),c=e.songDispatch,u=Object(i.useMemo)((function(){return{startInteraction:function startInteraction(){setTimeout((function(){a(!0)}))},endInteraction:function endInteraction(){setTimeout((function(){a(!1)}))}}}),[]),d=sl(),m=function(){var t=e.song.chordLines.list.flatMap((function(e){return[l.a.createElement(tl,{key:e.id,chordLine:e,songDispatch:c,"data-lineid":e.id,"data-testid":"Line"}),l.a.createElement(ul,{key:"NewLine-"+e.id,lineID:e,songDispatch:c,"data-testid":"NewLine"})]})),n=l.a.createElement(ul,{key:"NewLine-Top",lineID:"beginning",songDispatch:c,"data-testid":"NewLine-Top"});return t=t.splice(0,0,n)}(),f=!r,p=f?void 0:d.root;return l.a.createElement(wo.Provider,{value:u},l.a.createElement(dl,{onKeyDown:f?function handleKeyDown(e){var t=function handleBatchLineDelete(e){if("Backspace"!==e.key)return!1;var t=go();return 0!==t.length&&(e.preventDefault(),t.map((function(e){return{type:"ChordLine",id:e}})))}(e);!1!==t&&c({type:"batch-remove-lines",lineIDs:t})}:void 0,onCopy:f?o:void 0,className:p,elevation:0,tabIndex:0},l.a.createElement(h.a,{container:!0,justify:"center"},l.a.createElement(h.a,{item:!0,xs:10},m))))},ml=Object(f.a)({root:{color:jr.a[600]}})(Bt.a),fl=function LastSavedAt(e){var t=Object(i.useState)(new Date),n=Object(s.a)(t,2)[1];return Object(i.useEffect)((function(){var e=setInterval((function(){return n(new Date)}),3e4);return function(){return clearInterval(e)}}),[n]),l.a.createElement(ml,{classes:e.classes,variant:"caption"},"Last Saved: ".concat(function timeDescription(){var t=Rn.DateTime.fromJSDate(e.lastSaved);if(t.diffNow().as("day")<=-1)return t.toLocaleString(Rn.DateTime.DATE_MED);if(t.diffNow().as("second")>=-1)return"just now";var n=t.toRelative();return null===n?"WHAT IS HAPPENING? CONTACT YOUR DEV":n}()))},pl=Object(f.a)((function(e){return{root:{position:"absolute",top:e.spacing(2),right:e.spacing(2)}}}))(fl),yl=l.a.memo((function Header(e){var t=Object(al.a)(),n=l.a.createElement(Nt.a,{paddingBottom:t.spacing(.5)},l.a.createElement(Ki,{value:e.song.title,variant:"h4",align:"center","data-testid":"SongTitle",placeholder:"Song Title",onValueChange:function updateTitleHandler(t){e.songDispatch({type:"set-header",title:t})}})),r=null===e.song.lastSavedAt?null:l.a.createElement(pl,{lastSaved:e.song.lastSavedAt}),a=l.a.createElement(h.a,{container:!0,justify:"center"},l.a.createElement(h.a,{container:!0,item:!0,xs:6,justify:"center"},l.a.createElement(h.a,{item:!0},l.a.createElement(Bt.a,{display:"block",variant:"caption"},"Composed by:"," "),l.a.createElement(Ki,{value:e.song.composedBy,display:"block",variant:"caption",placeholder:"Stock Aitken Waterman",onValueChange:function updateComposeHandler(t){e.songDispatch({type:"set-header",composedBy:t})},"data-testid":"ComposedBy"}))),l.a.createElement(h.a,{container:!0,item:!0,xs:6,justify:"center"},l.a.createElement(h.a,{item:!0},l.a.createElement(Bt.a,{display:"inline",variant:"caption"},"Performed by:"," "),l.a.createElement(Ki,{value:e.song.performedBy,variant:"caption",placeholder:"Rick Astley",onValueChange:function updatePerformerHandler(t){e.songDispatch({type:"set-header",performedBy:t})},"data-testid":"PerformedBy"}))));return l.a.createElement(Nt.a,{paddingTop:t.spacing(1),paddingLeft:t.spacing(.5),paddingRight:t.spacing(.5),"data-testid":"Header"},r,n,a)})),vl=n(133),bl=n.n(vl),gl=n(206),kl=n.n(gl),El=n(204),wl=n.n(El),Cl=n(132),Ol=n.n(Cl),jl=n(203),Ll=n.n(jl),Sl=n(205),Bl=n.n(Sl),Tl=n(410),xl=n(383),Dl=n(202),Il=n.n(Dl),Fl=function useLoadMenuAction(e,t){return function(){var n=document.createElement("input");n.type="file";var r=function createFilePickerHandler(e,t){return function(){var n=this.files;if(null!==n)if(n.length>1)t("Multiple files selected, only one file expected",{variant:"error"});else{var r=n.item(0);if(null!==r){var a=new FileReader;a.onload=function(n){if(!(null===n.target||null===n.target.result||n.target.result instanceof ArrayBuffer)){var r=ht.deserialize(n.target.result);Object(B.isLeft)(r)?t("Can't load file, Song file failed validation",{variant:"error"}):e(r.right)}},a.readAsText(r)}else t("Could not retrieve file from file dialog",{variant:"error"})}}}(e,t);n.addEventListener("change",r),n.click()}},Pl=n(364),Al=n(365),zl=Object(f.a)((function(e){return{root:{margin:e.spacing(2),display:"flex"}}}))(Pl.a),Rl=Object(f.a)((function(e){return{root:{margin:e.spacing(.5)}}}))(vr.a),Nl=function TransposeMenu(e){var t=Object(i.useState)({originalKey:"C",transposedKey:"C"}),n=Object(s.a)(t,2),r=n[0],a=n[1],o=function keySelectChangeHandler(e){return function(t){var n=t.target.value,o=Object(j.a)({},r);o[e]=n,a(o)}},c=function createKeySelect(e,t,n){var r=[];for(var a in De)r.push(l.a.createElement(Wt.a,{value:a},a));return l.a.createElement(Rl,{id:e,value:t,onChange:n},r)};return l.a.createElement(Mt.a,{open:e.open,onClose:e.onClose},l.a.createElement(Ut.a,null,"Transpose Key"),l.a.createElement(Gt.a,null,l.a.createElement(h.a,{container:!0,direction:"row"},l.a.createElement(h.a,{item:!0},l.a.createElement(zl,null,l.a.createElement(Al.a,{htmlFor:"original-key"},"Original Key"),c("original-key",r.originalKey,o("originalKey")))),l.a.createElement(h.a,{item:!0},l.a.createElement(zl,null,l.a.createElement(Al.a,{htmlFor:"transposed-key"},"Transposed Key"),c("transposed-key",r.transposedKey,o("transposedKey")))))),l.a.createElement(Ht.a,null,l.a.createElement(Kt.a,{onClick:e.onClose},"Cancel"),l.a.createElement(Kt.a,{onClick:function handleTransposeAction(){e.songDispatch({type:"transpose",originalKey:r.originalKey,transposeKey:r.transposedKey}),e.onClose()}},"Transpose")))},_l=Object(f.a)((function(e){return{root:{position:"fixed",top:e.spacing(3),right:e.spacing(2)}}}))(Tl.a),Ml=function ChordPaperMenu(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(!1),c=Object(s.a)(o,2),u=c[0],d=c[1],h=Object(i.useState)(!1),m=Object(s.a)(h,2),f=m[0],y=m[1],b=Object(p.b)().enqueueSnackbar,g=l.a.useContext(ho),k=Fl((function setSong(t){return e.songDispatch({type:"replace-song",newSong:t})}),b),E=function useSaveMenuAction(e){return function(){var t=JSON.stringify(e.fork()),n=new Blob([t],{type:"application/json"}),r=URL.createObjectURL(n),a=document.createElement("a");a.download="chord_paper_song.json",""!==e.title&&(a.download=e.title+".json"),a.href=r,a.click(),URL.revokeObjectURL(r)}}(e.song),w=function useCloudCreateSong(){var e=Object(p.b)().enqueueSnackbar,t=qa(),n=Object(v.h)(),r=function(){var r=Object(ua.a)(ca.a.mark((function _callee(r,a){var o,i,l,c;return ca.a.wrap((function _callee$(u){for(;;)switch(u.prev=u.next){case 0:return o=r.set("owner",a.userID),u.next=3,eo(o,a.authToken);case 3:if(i=u.sent,!Object(Ja.isLeft)(i)){u.next=8;break}return u.next=7,t(i.left);case 7:return u.abrupt("return");case 8:if(l=ht.fromJSONObject(i.right),!Object(Ja.isLeft)(l)){u.next=14;break}return console.error("Backend response does not match song format"),console.log(i.right),e("A failure happened. Check console for more error details",{variant:"error"}),u.abrupt("return");case 14:c=l.right,n.push(kt.withID(c.id).withMode("edit").URL());case 16:case"end":return u.stop()}}),_callee)})));return function createNewSong(e,t){return r.apply(this,arguments)}}();return function(){var e=Object(ua.a)(ca.a.mark((function _callee2(e,t){return ca.a.wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:if(!e.isUnsaved()){n.next=3;break}return n.next=3,r(e,t);case 3:case"end":return n.stop()}}),_callee2)})));return function(t,n){return e.apply(this,arguments)}}()}();return Il()((function(){y(!0),b("Local save and load buttons are enabled!",{variant:"info"})})),u?l.a.createElement(Nl,{song:e.song,songDispatch:e.songDispatch,open:!0,onClose:function onClose(){d(!1)}}):l.a.createElement(_l,{icon:l.a.createElement(Ol.a,null),open:r,onOpen:function openMenu(){a(!0)},onClose:function closeMenu(){a(!1)},direction:"down",ariaLabel:"SpeedDial"},l.a.createElement(xl.a,{icon:l.a.createElement(ir.a,null),tooltipTitle:"Play Mode",onClick:e.onPlay}),!e.song.isUnsaved()&&null!==g&&l.a.createElement(xl.a,{icon:l.a.createElement(Ll.a,null),tooltipTitle:"Fork",onClick:function onClick(){return function forkSong(e,t){var n=e.fork();w(n,t)}(e.song,g)}}),e.song.isUnsaved()&&null!==g&&l.a.createElement(xl.a,{icon:l.a.createElement(bl.a,null),tooltipTitle:"Save to Cloud",onClick:function onClick(){return w(e.song,g)}}),l.a.createElement(xl.a,{icon:l.a.createElement(wl.a,null),tooltipTitle:"Transpose",onClick:function onClick(){d(!0)}}),f&&l.a.createElement(xl.a,{icon:l.a.createElement(Bl.a,null),tooltipTitle:"Save to computer",onClick:E}),f&&l.a.createElement(xl.a,{icon:l.a.createElement(kl.a,null),tooltipTitle:"Load from computer",onClick:k}))},Ul=Object(Pt.a)((function(e){return{root:{position:"relative",margin:e.spacing(5),minHeight:e.spacing(92),minWidth:e.spacing(92)}}}))(St.a),Kl=Object(At.a)({root:{backgroundColor:"white"}}),Vl=function ChordPaper(e){var t=Kl(),n=e.song.isUnsaved()?null:l.a.createElement(po,{song:e.song},(function(n,r,a){return l.a.createElement(Ga,{collapsedButtonClassName:t.root,timeSections:e.song.timeSections,tracklistLoad:n,onTrackListChanged:r,onRefresh:a})}));return l.a.createElement(Rt,null,l.a.createElement(y.a,null,l.a.createElement("title",null,""!==e.song.metadata.title?e.song.metadata.title:"New Song")),l.a.createElement(Ul,{elevation:3,"data-testid":"ChordPaper"},l.a.createElement(yl,{"data-testid":"Header",song:e.song,songDispatch:e.songDispatch}),l.a.createElement(hl,{song:e.song,songDispatch:e.songDispatch}),l.a.createElement(Ml,{song:e.song,songDispatch:e.songDispatch,onPlay:e.onPlay}),n))},Wl=n(222),Gl=["ArrowUp","ArrowLeft","Backspace","ShiftLeft"],Jl=["KeyA","KeyB","KeyC","KeyD","KeyE","KeyF","KeyG","KeyH","KeyI","KeyJ","KeyK","KeyL","KeyM","KeyN","KeyO","KeyP","KeyQ","KeyR","KeyS","KeyT","KeyU","KeyV","KeyW","KeyX","KeyY","KeyZ","Digit1","Digit2","Digit3","Digit4","Digit5","Digit6","Digit7","Digit8","Digit9","Digit0","Space","Enter","ArrowDown","ArrowRight","Comma","Period","Slash","Backslash","Semicolon","Quote","Backquote","Tab","ShiftRight","Equal","BracketLeft","BracketRight"],Hl=function PlayBlock(e){return l.a.createElement(Nt.a,{display:"inline-block"},l.a.createElement(h.a,{container:!0,direction:"column",component:"span"},l.a.createElement(h.a,{item:!0},l.a.createElement(Jo,null,e.block.chord)),l.a.createElement(h.a,{item:!0},l.a.createElement(Wo,{"data-testid":"lyric"},e.block.lyric))))},ql=Object(f.a)(_i)(Bt.a),Yl=Object(f.a)((function(e){return{root:{marginTop:e.spacing(1)}}}))(Nt.a),$l=function PlayLine(e){var t,n=l.a.createElement(Nt.a,null,e.chordLine.chordBlocks.list.map((function(e){return l.a.createElement(Hl,{block:e,key:e.id})}))),r=null===(t=e.chordLine.section)||void 0===t?void 0:t.name;if(void 0!==r&&""!==r){var a=l.a.createElement(Yl,null,l.a.createElement(ql,{variant:"body2"},r));n=l.a.createElement(Nt.a,null,a,n)}return n},Xl=function PlayContent(e){var t=l.a.useRef(),n=Object(i.useState)(0),r=Object(s.a)(n,2),a=r[0],o=r[1],c=function useRegisterKeyListener(){var e=Object(i.useContext)(Jn),t=Object(s.a)(e,3);return[t[0],t[2]]}(),u=Object(s.a)(c,2),d=u[0],h=u[1],m=e.displaySettings.numberOfColumnsPerPage>=1?e.displaySettings.numberOfColumnsPerPage:1,p=e.displaySettings.columnMargin>=0?e.displaySettings.columnMargin:0,y=Object(Wl.a)(),v=y/m,b=v/2,g=Object(i.useCallback)((function(t){var n=window.scrollX+function(){var n="column"===e.displaySettings.scrollType?v:y;return t?n:-n}(),r=n%v;r<b?n-=r:n+=v-r;window.scrollTo({left:n,top:0,behavior:"smooth"})}),[v,y,b,e.displaySettings.scrollType]),k=Object(i.useCallback)((function(){return g(!0)}),[g]),E=Object(i.useCallback)((function(){return g(!1)}),[g]),w=function handleLeftClick(e){return 0!==e.button||k(),!1},C=function handleRightClick(e){return 2===e.button&&(E(),!0)},O=Object(f.a)({root:{columnGap:"0px",columnRuleWidth:"2px",columnRuleStyle:"solid",columnRuleColor:jr.a[300],columns:m,height:"100vh",width:"100%"}})(St.a),j=Object(f.a)({root:{marginLeft:"".concat(p,"px"),marginRight:"".concat(p,"px")}})(Nt.a),L=e.song.chordLines.list.map((function(e){return l.a.createElement($l,{chordLine:e,key:e.id})})),S=Object(f.a)({root:{height:"100vh",pageBreakInside:"avoid"}})(Nt.a),B=function(){if(null===a)return[];for(var e=[],t=0;t<a;t++)e.push(l.a.createElement(S,{key:"empty-column-".concat(t)},l.a.createElement("div",null)));return e}();return Object(i.useEffect)((function(){var e;null===(e=t.current)||void 0===e||e.focus()})),Object(i.useEffect)((function(){var e=function handleKey(e){return function isScrollBackwardsKey(e){var t,n=Object(z.a)(Gl);try{for(n.s();!(t=n.n()).done;){if(t.value===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}(e.code)?(E(),void e.preventDefault()):function isScrollForwardsKey(e){var t,n=Object(z.a)(Jl);try{for(n.s();!(t=n.n()).done;){if(t.value===e)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}(e.code)?(k(),void e.preventDefault()):void 0};return d(e),function(){return h(e)}}),[E,k,d,h]),Object(i.useEffect)((function(){var e=Math.round(document.body.scrollWidth/v)%m;if(0!==e){var t=m-e+a;o(t%=m)}}),[m,v,a,o,e]),l.a.createElement(Ho.a,{rootRef:t},l.a.createElement(O,{onMouseDown:function handleClick(e){for(var t=0,n=[w,C];t<n.length;t++){if((0,n[t])(e))return void e.preventDefault()}},onContextMenu:function cancelContextMenu(e){e.preventDefault()}},l.a.createElement(j,null,L),B))},Ql=n(208),Zl=n.n(Ql),ec=n(207),tc=n.n(ec),nc=n(315),rc=n(408),ac=n(384),oc=n(398),ic=Object(f.a)((function(e){return{root:{margin:e.spacing(1)}}}))(Nt.a),lc=Object(f.a)((function(e){return{root:{fontSize:"0.75rem"}}}))(nc.a),cc=Object(f.a)((function(e){return{root:{fontSize:"0.75rem"}}}))(Bt.a),uc=function DisplaySettingsDialog(e){var t=Object(i.useState)({numberOfColumns:e.defaultSettings.numberOfColumnsPerPage.toString(),fontSize:e.defaultSettings.fontSize.toString(),columnMargin:e.defaultSettings.columnMargin.toString(),scrollType:e.defaultSettings.scrollType}),n=Object(s.a)(t,2),r=n[0],a=n[1],o=function validateNumber(e){if(""===e||Z(e))return Object(B.left)(new Error("A value is required"));var t=Number(e);return isNaN(t)?Object(B.left)(new Error("Only numbers are allowed")):t<=0?Object(B.left)(new Error("Only positive numbers are allowed")):Object(B.right)(t)},c=function validateInt(e){var t=o(e);if(Object(B.isLeft)(t))return t;var n=t.right,r=Math.floor(n);return n!==r?Object(B.left)(new Error("Only integers are allowed")):Object(B.right)(r)},u=function validatedSettings(){var e=c(r.numberOfColumns),t=o(r.fontSize),n=o(r.columnMargin);if(Object(B.isLeft)(e))return e;if(Object(B.isLeft)(t))return t;if(Object(B.isLeft)(n))return n;var a={numberOfColumnsPerPage:e.right,fontSize:t.right,columnMargin:n.right,scrollType:r.scrollType};return Object(B.right)(a)},d=function textSettingChangeHandler(e){return function(t){var n=t.target.value,o=Object(j.a)({},r);o[e]=n,a(o)}},h=[{label:"number of columns",field:"numberOfColumns",adornment:null,validationErrorPropsFn:function validationErrorPropsFn(e){return c(e)}},{label:"font size",field:"fontSize",adornment:"px",validationErrorPropsFn:function validationErrorPropsFn(e){return o(e)}},{label:"column margin",field:"columnMargin",adornment:"px",validationErrorPropsFn:function validationErrorPropsFn(e){return o(e)}}],m=function makeInput(e){var t=Object(j.a)({label:e.label,defaultValue:r[e.field],onChange:d(e.field)},function validationErrorProps(e){return{error:!!Object(B.isLeft)(e)||void 0,helperText:Object(B.isLeft)(e)?e.left.message:void 0}}(e.validationErrorPropsFn(r[e.field])));return null!==e.adornment&&(t.InputProps={endAdornment:l.a.createElement(Vi.a,{position:"end"},e.adornment)}),l.a.createElement(ic,null,l.a.createElement(yn.a,t))},f=l.a.createElement(ic,null,l.a.createElement(Pl.a,{component:"fieldset"},l.a.createElement(lc,null,"scroll type"),l.a.createElement(rc.a,{value:r.scrollType,onChange:function handleScrollTypeChange(e,t){"page"===t||"column"===t?a(Object(j.a)(Object(j.a)({},r),{},{scrollType:t})):console.error("Display dialog - scroll type: Received an invalid radio value")}},l.a.createElement(ac.a,{value:"column",control:l.a.createElement(oc.a,{size:"small"}),label:l.a.createElement(cc,null,"scroll by column")}),l.a.createElement(ac.a,{value:"page",control:l.a.createElement(oc.a,{size:"small"}),label:l.a.createElement(cc,null,"scroll by page")}))));return l.a.createElement(Mt.a,{open:e.open,onClose:e.onClose},l.a.createElement(Ut.a,null,"Display Settings"),l.a.createElement(Gt.a,null,f,h.map((function(e){return m(e)}))),l.a.createElement(Ht.a,null,l.a.createElement(Kt.a,{onClick:e.onClose},"Cancel"),l.a.createElement(Kt.a,{disabled:function hasValidationErrors(){return Object(B.isLeft)(u())}(),onClick:function handleSubmit(){var t,n=u();Object(B.isLeft)(n)||null===(t=e.onSubmit)||void 0===t||t.call(e,{numberOfColumnsPerPage:n.right.numberOfColumnsPerPage,fontSize:n.right.fontSize,columnMargin:n.right.columnMargin,scrollType:n.right.scrollType})}},"OK")))},sc=Object(f.a)({root:{backgroundColor:"transparent"}})(Ol.a),dc=Object(f.a)((function(e){return{root:{position:"fixed",top:e.spacing(3),right:e.spacing(2),"& .MuiSpeedDial-fab":{backgroundColor:"transparent",color:jr.a[500]}}}}))(Tl.a),hc=function PlayMenu(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(!1),c=Object(s.a)(o,2),u=c[0],d=c[1];if(u){return l.a.createElement(uc,{open:!0,onClose:function onClose(){return d(!1)},defaultSettings:e.displaySettings,onSubmit:function handleDisplaySettingsChange(t){var n;null===(n=e.onDisplaySettingsChange)||void 0===n||n.call(e,t),d(!1)}})}return l.a.createElement(dc,{icon:l.a.createElement(sc,null),direction:"down",open:r,onOpen:function openMenu(){a(!0)},onClose:function closeMenu(){a(!1)},ariaLabel:"SpeedDial",FabProps:{color:"inherit"}},l.a.createElement(xl.a,{icon:l.a.createElement(tc.a,null),tooltipTitle:"Display Settings",onMouseDownCapture:function onMouseDownCapture(){return d(!0)}}),l.a.createElement(xl.a,{icon:l.a.createElement(Zl.a,null),tooltipTitle:"Exit Play Mode",onMouseDownCapture:function handleExit(t){var n;null===(n=e.onExit)||void 0===n||n.call(e),t.stopPropagation()}}))},mc=Object(At.a)({root:{backgroundColor:"transparent"}}),fc=function Play(e){var t=Object(i.useState)({numberOfColumnsPerPage:2,fontSize:14,columnMargin:20,scrollType:"column"}),n=Object(s.a)(t,2),r=n[0],a=n[1],o=mc(),c=e.song.isUnsaved()?null:l.a.createElement(po,{song:e.song},(function(t,n,r){return l.a.createElement(Ga,{collapsedButtonClassName:o.root,timeSections:e.song.timeSections,tracklistLoad:t,onTrackListChanged:n,onRefresh:r})}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(y.a,null,l.a.createElement("title",null,""!==e.song.metadata.title?e.song.metadata.title:"New Song")),l.a.createElement(hc,{displaySettings:r,onDisplaySettingsChange:a,onExit:e.onEdit}),l.a.createElement(m.a,{theme:function playTheme(e){return Object(d.a)(Object(j.a)(Object(j.a)({},e),{},{typography:{fontFamily:e.typography.fontFamily,fontWeightRegular:e.typography.fontWeightRegular,fontSize:r.fontSize}}))}},l.a.createElement(Xl,{song:e.song,displaySettings:r})),c)},pc=function SongRouter(e){var t=Object(v.h)(),n=e.path.withMode("edit"),r=e.path.withMode("play");return[l.a.createElement(v.c,{key:e.path.URL(),path:e.path.URL(),exact:!0},l.a.createElement(v.b,{to:n.URL()}),","),l.a.createElement(v.c,{key:n.URL(),path:n.URL()},l.a.createElement(Vl,{song:e.song,songDispatch:e.songDispatch,onPlay:function switchToPlay(){t.push(r.URL())}})),l.a.createElement(v.c,{key:r.URL(),path:r.URL()},l.a.createElement(fc,{song:e.song,onEdit:function switchToEdit(){t.push(n.URL())}}))]},yc=function chordSongReducer(e,t){switch(t.type){case"replace-song":return t.newSong;case"set-header":if(void 0!==t.title){var n=t.title;e=e.update("metadata",(function(e){return Object(j.a)(Object(j.a)({},e),{},{title:n})}))}if(void 0!==t.composedBy){var r=t.composedBy;e=e.update("metadata",(function(e){return Object(j.a)(Object(j.a)({},e),{},{composedBy:r})}))}if(void 0!==t.performedBy){var a=t.performedBy;e=e.update("metadata",(function(e){return Object(j.a)(Object(j.a)({},e),{},{performedBy:a})}))}return e;case"set-last-saved-at":return e.set("lastSavedAt",t.lastSavedAt);case"add-line":return"beginning"===t.lineID?e.addBeginning(new je({})):e.addAfter(t.lineID,new je({}));case"remove-line":return e.removeElement(t.lineID);case"split-line":var o=e.splitLine(t.lineID,t.splitIndex),i=Object(s.a)(o,2),l=i[0];return i[1]?l:e;case"merge-lines":var c=e.mergeLineWithPrevious(t.latterLineID),u=Object(s.a)(c,2),d=u[0];return u[1]?d:e;case"batch-insert-lines":var h,m=e.get(t.insertLineID);return e=(h=e).addAfter.apply(h,[t.insertLineID].concat(Object(E.a)(t.copiedLines))),m.isEmpty()&&(e=e.removeElement(t.insertLineID)),e;case"batch-remove-lines":return e.removeMultipleElements(t.lineIDs);case"replace-line-lyrics":return e.replaceElement(t.lineID,(function(e){return e.replaceLyrics(t.newLyric)}));case"insert-overflow-lyrics":var f,p=t.overflowLyrics.map((function(e){return je.fromLyrics(e)}));return(f=e).addAfter.apply(f,[t.insertionLineID].concat(Object(E.a)(p)));case"set-chord":return e.replaceElement(t.lineID,(function(e){return e.setChord(t.blockID,t.newChord)}));case"split-block":return e.replaceElement(t.lineID,(function(e){return e.splitBlock(t.blockID,t.splitIndex)}));case"drag-and-drop-chord":var y=e.findLineWithBlock(t.sourceBlockID),v=e.findLineWithBlock(t.destinationBlockID),b=y===v,g=function syncSameLines(e){b&&(y=e,v=e)};return"move"===t.dropType&&g(y=y.replaceElement(t.sourceBlockID,(function(e){return e.set("chord","")}))),0!==t.splitIndex&&g(v=v.splitBlock(t.destinationBlockID,t.splitIndex)),g(v=v.replaceElement(t.destinationBlockID,(function(e){return e.set("chord",t.newChord)}))),b?g(y=y.normalizeBlocks()):(y=y.normalizeBlocks(),v=v.normalizeBlocks()),e=(e=e.replaceElement(y,(function(){return y}))).replaceElement(v,(function(){return v}));case"set-section":return e.updateCollection((function(e){return e.replace(t.lineID,(function(e){return e=function updateTime(e){if(void 0!==t.time){var n=e.setSectionTime(t.time);e=Object(s.a)(n,1)[0]}return e}(e=function updateName(e){if(void 0!==t.label){var n=e.setSectionName(t.label);e=Object(s.a)(n,1)[0]}return e}(e))}))}));case"transpose":return e.transpose(t.originalKey,t.transposeKey)}},vc=function useChordSongReducer(e,t){var n=Object(i.useCallback)((function(e,n){var r=yc(e,n);return null===t||void 0===t||t(r,n),r}),[t]);return Object(i.useReducer)(n,e)},bc=n(209),gc=n.n(bc),kc=function withSongContext(e){return function(t){var n=vc(t.song),r=Object(s.a)(n,2),a=r[0],o=r[1],i=(t.song,Object(Mi.a)(t,["song"])),c=Object(j.a)(Object(j.a)({},i),{},{song:a,songDispatch:o});return l.a.createElement(e,c)}}(pc),Ec=function Demo(){var e=ht.fromJSONObject(Dt);if(Object(B.isLeft)(e))return l.a.createElement(Ft,null);var t=e.right;return l.a.createElement(kc,{path:jt,song:t})},wc=n(386),Cc=n(221),Oc=function HTML5BackendWithCTRLKey(){var e=Cc.a.apply(void 0,arguments),t=function welpThingsBroke(){throw console.error("----------------------BAD THING HAPPENED----------------------"),console.error("HTML5 Drag and Drop backend changed internally"),console.error("Drag and drop is probably broken"),console.error("----------------------BAD THING HAPPENED----------------------"),new Error("HTMLBackend changed and is now broken")},n=e;return void 0!==n.handleTopDragEnter&&null!==n.handleTopDragEnter||t(),n.__original__handleTopDragEnter=n.handleTopDragEnter,n.handleTopDragEnter=function(e){var t;null===(t=n.__original__handleTopDragEnter)||void 0===t||t.call(n,e),n.altKeyPressed=e.ctrlKey||e.metaKey},void 0!==n.handleTopDragOver&&null!==n.handleTopDragOver||t(),n.__original__handleTopDragOver=n.handleTopDragOver,n.handleTopDragOver=function(e){var t;null===(t=n.__original__handleTopDragOver)||void 0===t||t.call(n,e),n.altKeyPressed=e.ctrlKey||e.metaKey},e},jc=function DragAndDrop(e){return l.a.createElement(wc.a,{backend:Oc},e.children)},Lc=(n(307),n(395)),Sc=n(388),Bc=n(389),Tc=n(390),xc=n(397),Dc=(n(308),{Lydian:[{interval:"1",importance:"root"},{interval:"2",importance:"normal"},{interval:"3",importance:"chordtone"},{interval:"#4",importance:"special"},{interval:"5",importance:"chordtone"},{interval:"6",importance:"normal"},{interval:"7",importance:"chordtone"}],Ionian:[{interval:"1",importance:"root"},{interval:"2",importance:"normal"},{interval:"3",importance:"chordtone"},{interval:"4",importance:"normal"},{interval:"5",importance:"chordtone"},{interval:"6",importance:"normal"},{interval:"7",importance:"chordtone"}],Mixolydian:[{interval:"1",importance:"root"},{interval:"2",importance:"normal"},{interval:"3",importance:"chordtone"},{interval:"4",importance:"normal"},{interval:"5",importance:"chordtone"},{interval:"6",importance:"normal"},{interval:"b7",importance:"chordtone"}],Dorian:[{interval:"1",importance:"root"},{interval:"2",importance:"normal"},{interval:"b3",importance:"chordtone"},{interval:"4",importance:"normal"},{interval:"5",importance:"chordtone"},{interval:"6",importance:"special"},{interval:"b7",importance:"chordtone"}],Aeolian:[{interval:"1",importance:"root"},{interval:"2",importance:"normal"},{interval:"b3",importance:"chordtone"},{interval:"4",importance:"normal"},{interval:"5",importance:"chordtone"},{interval:"b6",importance:"normal"},{interval:"b7",importance:"chordtone"}],Phrygian:[{interval:"1",importance:"root"},{interval:"b2",importance:"special"},{interval:"b3",importance:"chordtone"},{interval:"4",importance:"normal"},{interval:"5",importance:"chordtone"},{interval:"b6",importance:"normal"},{interval:"b7",importance:"chordtone"}],Locrian:[{interval:"1",importance:"root"},{interval:"b2",importance:"special"},{interval:"b3",importance:"chordtone"},{interval:"4",importance:"normal"},{interval:"b5",importance:"chordtone"},{interval:"b6",importance:"normal"},{interval:"b7",importance:"chordtone"}],Dominant:[{interval:"1",importance:"root"},{interval:"b2",importance:"special"},{interval:"#2",importance:"special"},{interval:"3",importance:"chordtone"},{interval:"#4",importance:"special"},{interval:"b6",importance:"special"},{interval:"b7",importance:"chordtone"}]}),Ic=function buildScale(e,t){var n=Dc[t].map((function convertToScaleNote(t){return{note:et[e][t.interval],interval:t.interval,importance:t.importance}}));return{center:e,name:t,notes:n}},Fc=mapObjectKey(Dc,(function(e){return function buildScaleCollection(e){return mapObjectKey(De,(function(t){return Ic(t,e)}))}(e)})),Pc=function(){function ScaleUtility(e){Object(L.a)(this,ScaleUtility),this.scale=void 0,this.scale=e}return Object(S.a)(ScaleUtility,[{key:"name",value:function name(){return"".concat(this.scale.center," ").concat(this.scale.name)}}]),ScaleUtility}(),Ac=n(112),zc={highE:void 0,B:void 0,G:void 0,D:void 0,A:void 0,E:void 0},Rc=function(){function FretboardClass(){Object(L.a)(this,FretboardClass),this.noteMap=void 0,this.noteMap={highE:FretboardClass.buildString("E"),B:FretboardClass.buildString("B"),G:FretboardClass.buildString("G"),D:FretboardClass.buildString("D"),A:FretboardClass.buildString("A"),E:FretboardClass.buildString("E")}}return Object(S.a)(FretboardClass,null,[{key:"buildString",value:function buildString(e){for(var t=mapObjectKey(De,(function(){return[]})),n=ze[e],r=0;r<=FretboardClass.maxFrets;r++){var a,o=n.semitonesUp(xe(r)),i=Object(z.a)(o);try{for(i.s();!(a=i.n()).done;){t[a.value].push(r)}}catch(l){i.e(l)}finally{i.f()}}return t}}]),Object(S.a)(FretboardClass,[{key:"getPositions",value:function getPositions(e,t,n){var r,a=mapObjectKey(zc,(function(){return[]}));for(r in a){var o,i=this.noteMap[r][e],l=Object(z.a)(i);try{for(l.s();!(o=l.n()).done;){var c=o.value;c<t||c>n||a[r].push({fret:c,note:e})}}catch(u){l.e(u)}finally{l.f()}}return a}}]),FretboardClass}();Rc.maxFrets=24;var Nc=new Rc,_c=function getLabelText(e,t){switch(t){case"interval":return e.interval;case"note":return e.note}},Mc=Object(f.a)({root:{transform:"rotate(270deg)","& svg":{transform:"scale(0.85)"},"& .title":{fontFamily:"PoriChord"}}})(Nt.a),Uc={highE:1,B:2,G:3,D:4,A:5,E:6},Kc=function convertScaleViewToFingers(e,t){var n,r=[];for(n in e){var a,o=Uc[n],i=e[n],l=Object(z.a)(i);try{var c=function _loop(){var e=a.value,n=function(){var n=e.fret-t+1;if(n<=0)throw new Error("Invalid finger generated - got a zero or negative fretting");return n}(),i=function(){switch(e.importance){case"normal":return"black";case"root":return"#f44336";case"chordtone":return"#64b5f6";case"special":return"purple"}}(),l="root"===e.importance?Ac.c.SQUARE:Ac.c.CIRCLE;r.push([o,n,{text:e.labelText,color:i,shape:l}])};for(l.s();!(a=l.n()).done;)c()}catch(u){l.e(u)}finally{l.f()}}return r},Vc=function ScaleChart(e){var t=Object(i.useRef)(null),n=Object(i.useRef)(null);Object(i.useEffect)((function(){if(null!==t.current){null!==n.current&&n.current.remove();var r=e.startingFret+4,a=function generateGuitarScaleView(e,t,n,r){var a,o=mapObjectKey(zc,(function(){return[]})),i=Object(z.a)(e.notes);try{var l=function _loop(){var e=a.value,i=Nc.getPositions(e.note,t,n),l=void 0;for(l in i){var c,u=i[l].map((function(t){return{fret:t.fret,labelText:_c(e,r),importance:e.importance}}));(c=o[l]).push.apply(c,Object(E.a)(u))}};for(i.s();!(a=i.n()).done;)l()}catch(c){i.e(c)}finally{i.f()}return o}(e.scale,e.startingFret,r,"note"),o=new Ac.b(t.current);o.chord({barres:[],fingers:Kc(a,e.startingFret),title:new Pc(e.scale).name()}),o.configure({position:e.startingFret,fretLabelPosition:Ac.a.LEFT}),o.draw(),n.current=o,t.current.querySelectorAll(".nut-text,.position").forEach((function(e){if(e instanceof SVGTextElement){var t=function getPos(e){if(0!==e.x.baseVal.numberOfItems&&0!==e.y.baseVal.numberOfItems)return[e.x.baseVal.getItem(0).value,e.y.baseVal.getItem(0).value]}(e);void 0!==t&&setTimeout((function(){return e.setAttribute("transform","rotate(90,".concat(t[0],",").concat(t[1],")"))}))}}))}}),[e.scale,e.startingFret]);var r={ref:t};return l.a.createElement(Mc,r)},Wc=n(387),Gc=n(399),Jc=function(){var e,t,n=[];for(e in De)for(t in Dc)n.push({note:e,scaleName:t,label:"".concat(e," ").concat(t)});return n}(),Hc=function ScaleSelection(e){var t=Object(Wc.a)({matchFrom:"start"});return l.a.createElement(Gc.a,{multiple:!0,options:Jc,filterOptions:t,getOptionLabel:function getOptionLabel(e){return e.label},renderInput:function renderInput(e){return l.a.createElement(yn.a,Object.assign({},e,{variant:"outlined",label:"Scales"}))},value:e.scales,onChange:function changeHandler(t,n){e.onSelection(n)}})};Lc.a.use([Sc.a,Bc.a]);var qc=Object(f.a)((function(e){return{root:{margin:e.spacing(2)}}}))(Nt.a),Yc=Object(f.a)({root:{display:"block"}})(St.a),$c=function GuitarDemo(e){var t=Object(i.useState)([]),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(5),c=Object(s.a)(o,2),u=c[0],d=c[1],m=Object(i.useRef)(null),f=Object(i.useRef)(null),p=l.a.createElement(yn.a,{label:"Starting Fret",type:"number",InputLabelProps:{shrink:!0},variant:"outlined",value:u,onChange:function onChange(e){var t=parseInt(e.target.value);t<=0||t>21||t%1===0&&d(t)}}),y=l.a.createElement(h.a,{container:!0},l.a.createElement(h.a,{item:!0,xs:9},l.a.createElement(qc,null,l.a.createElement(Hc,{scales:r,onSelection:a}))),l.a.createElement(h.a,{item:!0,xs:3},l.a.createElement(qc,null,p))),v=function makeSlide(e){return l.a.createElement(Tc.a,null,l.a.createElement(Vc,{scale:Fc[e.scaleName][e.note],startingFret:u}))},b=r.length>4,g=r.length>8,k=function(){var e=g?r.map(v):r.slice(0,4).map(v);return l.a.createElement(xc.a,{slidesPerView:4,navigation:g,loop:g,onSlideChange:function rotateSecondRow(e){if(g&&null!==f.current){var t=(e.realIndex+4)%r.length;f.current.slideToLoop(t)}},onSwiper:function onSwiper(e){m.current=e}},e)}(),E=function(){if(!b)return null;var e=g?r.map(v):r.slice(4,8).map(v);return l.a.createElement(xc.a,{slidesPerView:4,loop:g,onSwiper:function onSwiper(e){f.current=e},initialSlide:4},e)}();return l.a.createElement(Yc,null,y,k,E)},Xc=n(393),Qc=n(318),Zc=n(391),eu=n(394),tu=n(366),nu=n(213),ru=n.n(nu),au=n(215),ou=n.n(au),iu=n(214),lu=n.n(iu),cu=n(217),uu=n.n(cu),su=n(212),du=n.n(su),hu=n(216),mu=n.n(hu),fu=n(219),pu=n.n(fu),yu=n(218),vu=n.n(yu),bu=function LoadSongDialog(e){var t=Object(i.useState)({state:"not-started"}),n=Object(s.a)(t,2),r=n[0],a=n[1],o=qa(),c=l.a.useContext(ho),u=Object(v.h)(),d=function wrapInDialog(t){return l.a.createElement(Mt.a,{open:e.open,onClose:e.onClose,fullWidth:!0},l.a.createElement(Ut.a,null,"Load Songs"),l.a.createElement(Gt.a,null,t))};if(null===c)return d(l.a.createElement(Bt.a,null,"You must be logged in to load a song graahhhhh *foams at mouth*"));var h=function summarySortFn(e,t){return e.lastSavedAt===t.lastSavedAt?0:null===e.lastSavedAt?1:null===t.lastSavedAt?-1:e.lastSavedAt<t.lastSavedAt?1:-1},m=function(){var e=Object(ua.a)(ca.a.mark((function _callee(){var e,t,n;return ca.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Za(c.userID,c.authToken);case 2:if(e=r.sent,!Object(B.isLeft)(e)){r.next=6;break}return a({state:"error",error:e.left}),r.abrupt("return");case 6:if(t=ct.fromJSONList(e.right),!Object(B.isLeft)(t)){r.next=10;break}return a({state:"error",error:t.left}),r.abrupt("return");case 10:(n=t.right).sort(h),a({state:"loaded",item:n});case 13:case"end":return r.stop()}}),_callee)})));return function loadSummaries(){return e.apply(this,arguments)}}(),f=function summaryListItem(t){var n=kt.withID(t.id),r=function detailElement(e,n){return""===e?null:l.a.createElement(Bt.a,{key:"".concat(t.id,"-").concat(n),display:"block",variant:"caption"},"".concat(n,": ").concat(e))},a=l.a.createElement(l.a.Fragment,null,r(t.metadata.performedBy,"Performed by"),r(t.metadata.composedBy,"Composed by"),null!==t.lastSavedAt&&l.a.createElement(Bt.a,{key:"".concat(t.id,"-lastSavedAt"),display:"block",variant:"caption"},"Last Saved At: ".concat(t.lastSavedAt.toLocaleString()))),o=""!==t.metadata.title?t.metadata.title:"(Untitled)";return l.a.createElement(l.a.Fragment,null,l.a.createElement(Qc.a,{key:t.id,button:!0,onClick:function navigateToSong(){var t;u.push(n.URL()),null===(t=e.onClose)||void 0===t||t.call(e)}},l.a.createElement(Zc.a,{primary:o,primaryTypographyProps:{key:"".concat(t.id,"-primary")},secondary:a,secondaryTypographyProps:{key:"".concat(t.id,"-seccondary")}})),l.a.createElement(Jt.a,{key:"".concat(t.id,"-divider")}))};switch(r.state){case"not-started":return a({state:"loading"}),m(),l.a.createElement(l.a.Fragment,null);case"error":return o(r.error),d(l.a.createElement(uo,null));case"loading":return d(l.a.createElement(wr.a,null));case"loaded":return d(function summaryCards(e){return 0===e.length?l.a.createElement(Bt.a,null,"You don't have any songs saved. GET TO IT"):l.a.createElement(tu.a,null,e.map(f))}(r.item))}},gu=n(321),ku=Object(f.a)((function(e){return{root:{color:e.palette.secondary.light}}}))(Bt.a),Eu=Object(f.a)((function(e){return{root:{color:e.palette.primary.main}}}))(Bt.a),wu=function LineBreak(){return l.a.createElement(Bt.a,null,"\xa0")},Cu=n(392),Ou=n(210),ju=n.n(Ou),Lu=Object(Pt.a)((function(e){return{root:{color:e.palette.success.main}}}))(ju.a),Su=Object(Pt.a)({root:{display:"inherit"}})(Cu.a),Bu=function Playground(e){var t=vc(e.initialSong),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(i.useState)(!1),c=Object(s.a)(o,2),u=c[0],d=c[1],h=e.expectedSong;return Object(i.useEffect)((function(){u||void 0!==h&&h.contentEquals(r)&&d(!0)}),[r,h,u,d]),l.a.createElement(Su,{badgeContent:l.a.createElement(Lu,null),invisible:!u},l.a.createElement(St.a,{elevation:1},l.a.createElement(hl,{song:r,songDispatch:a})))},Tu=function AddChord(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly appear?")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Adding Chords"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Add a chord by hovering above a word, and clicking the outlined box. Let's add"," ",l.a.createElement(Eu,{display:"inline"},"B7")," back above"," ",l.a.createElement(ku,{display:"inline"},"appear"),"."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},xu=function AddLine(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]}),new je({blocks:[new le({chord:"",lyric:new re("Every time you are near")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Adding New Lines"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"You can add more lines by hovering below (or above) and existing line, and clicking the gray line or the add icon to the right."),l.a.createElement(Bt.a,null,"Let's add a line, and change the lyrics to:"),l.a.createElement(ku,null,"Why do birds suddenly ap-pear?"),l.a.createElement(ku,null,"Every time you are near"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},Du=function ChordPositioning(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"",lyric:new re("appear?")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly")}),new le({chord:"F#7",lyric:new re(" ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]})]}),n=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly")}),new le({chord:"F#7",lyric:new re(" ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Chord Positioning"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Sometimes you want to emphasize a chord landing on a specific syllable or between words. Without the overhead of standard notation, we can do this by breaking up lyrics and annotating spaces."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Let's change the lyrics to:"),l.a.createElement(ku,null,"Why do birds suddenly ap-pear?"),l.a.createElement(Bt.a,null,"And add a tab after the"," ",l.a.createElement(ku,{display:"inline"},"?")),l.a.createElement(Bt.a,null,"Then add the chord"," ",l.a.createElement(Eu,{display:"inline"},"F#7")," to the space before"," ",l.a.createElement(ku,{display:"inline"},"ap-")),l.a.createElement(Bt.a,null,"Add the chord"," ",l.a.createElement(Eu,{display:"inline"},"B7sus4")," to"," ",l.a.createElement(ku,{display:"inline"},"pear")),l.a.createElement(Bt.a,null,"Add the chord"," ",l.a.createElement(Eu,{display:"inline"},"B7")," to the tabbed space after"," "),l.a.createElement(Bt.a,null,"It should look like this:"),l.a.createElement(Bu,{initialSong:t}),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:n}))},Iu=function CopyAndPaste(){var e=new ht({lines:[new je({blocks:[new le({chord:"",lyric:new re("But I'm a ")}),new le({chord:"G",lyric:new re("creep, I'm a ")}),new le({chord:"B7",lyric:new re("weirdo")})]}),new je({blocks:[new le({chord:"",lyric:new re("What the hell am doing ")}),new le({chord:"C",lyric:new re("here? I don't be-")}),new le({chord:"Cm",lyric:new re("long here")})]}),new je({blocks:[new le({chord:"",lyric:new re("I don't care if it ")}),new le({chord:"G",lyric:new re("hurts, I wanna have con-")}),new le({chord:"B7",lyric:new re("trol")})]}),new je({blocks:[new le({chord:"",lyric:new re("I want a perfect ")}),new le({chord:"C",lyric:new re("body, I want a perfect ")}),new le({chord:"Cm",lyric:new re("soul")})]}),new je({blocks:[new le({chord:"",lyric:new re("I want you to ")}),new le({chord:"G",lyric:new re("notice when I'm not a-")}),new le({chord:"B7",lyric:new re("round")})]}),new je({blocks:[new le({chord:"",lyric:new re("You're so fucking ")}),new le({chord:"C",lyric:new re("special, I wish I was ")}),new le({chord:"Cm",lyric:new re("special")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"",lyric:new re("But I'm a ")}),new le({chord:"G",lyric:new re("creep, I'm a ")}),new le({chord:"B7",lyric:new re("weirdo")})]}),new je({blocks:[new le({chord:"",lyric:new re("What the hell am doing ")}),new le({chord:"C",lyric:new re("here? I don't be-")}),new le({chord:"Cm",lyric:new re("long here")})]}),new je({blocks:[new le({chord:"",lyric:new re("I don't care if it ")}),new le({chord:"G",lyric:new re("hurts, I wanna have con-")}),new le({chord:"B7",lyric:new re("trol")})]}),new je({blocks:[new le({chord:"",lyric:new re("I want a perfect ")}),new le({chord:"C",lyric:new re("body, I want a perfect ")}),new le({chord:"Cm",lyric:new re("soul")})]}),new je({blocks:[new le({chord:"",lyric:new re("I want you to ")}),new le({chord:"G",lyric:new re("notice when I'm not a-")}),new le({chord:"B7",lyric:new re("round")})]}),new je({blocks:[new le({chord:"",lyric:new re("You're so fucking ")}),new le({chord:"C",lyric:new re("special, I wish I was ")}),new le({chord:"Cm",lyric:new re("special")})]}),new je({blocks:[new le({chord:"",lyric:new re("But I'm a ")}),new le({chord:"G",lyric:new re("creep, I'm a ")}),new le({chord:"B7",lyric:new re("weirdo")})]}),new je({blocks:[new le({chord:"",lyric:new re("What the hell am doing ")}),new le({chord:"C",lyric:new re("here? I don't be-")}),new le({chord:"Cm",lyric:new re("long here")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Copying and Pasting Lines"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Sometimes you want to just repeat what's on the page without entering it all over again - choruses with the same lyrics, repeating instrumental sections. You can do this by copying and pasting entire lines that you've already written out."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"The easiest way to copy is to drag down from some empty space on the left of the line you wish to start copying from, then pressing (CTRL or CMD) + C, or right click ","->"," copy."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"To paste, click to edit a lyric line, and press (CTRL or CMD) + V, or right click ","->"," paste."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Note that there's no partial copy - if any part of the line is selected during the copy, the whole line is copied."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"If you have trouble selecting a line, try dragging your cursor starting further left and above the line."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Let's try copying and pasting the repeated chorus:"),l.a.createElement(ku,{variantMapping:{body1:"div"}},"But I'm a creep, I'm a weirdo"),l.a.createElement(ku,{variantMapping:{body1:"div"}},"What the hell am I doing here? I don't belong here."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Copy those two lines, add a new line at the bottom, and paste it there."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},Fu=function DragAndDropChord(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds ")}),new le({chord:"B7",lyric:new re("suddenly appear?")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Dragging and Dropping Chords"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"It's also possible to drag and drop chords onto different parts of the line when its initial placement wasn't quite correct. Just drag a chord and drop it to the space above or on another lyric."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"If you hold CTRL or CMD while dragging and dropping, the chord will be copied instead of moved over."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Let's move the"," ",l.a.createElement(Eu,{display:"inline"},"B7")," above"," ",l.a.createElement(ku,{display:"inline"},"suddenly")," ","to above"," ",l.a.createElement(ku,{display:"inline"},"appear"),"."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},Pu=function EditChord(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"Bm",lyric:new re("appear?")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Editing Chords"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Click on a chord to change it, then press enter to commit your changes. Let's change the chord above"," ",l.a.createElement(ku,{display:"inline"},"appear")," ","from ",l.a.createElement(Eu,{display:"inline"},"Bm")," to"," ",l.a.createElement(Eu,{display:"inline"},"B7"),"."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},Au=function EditLyrics(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why oh why do birds suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Editing Lyrics"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"You can edit the lyrics by clicking anywhere along the lyrics. Finish editing lyrics by pressing enter or clicking outside the text edit box. Chord Paper will move chords along with lyrics when you edit them. Let's change the lyrics to:"),l.a.createElement(ku,null,"Why oh why do birds suddenly appear?"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},zu=function Instrumental(){var e=new ht({lines:[new je({blocks:[new le({chord:"Bm",lyric:new re("\ue200")}),new le({chord:"A",lyric:new re("\ue200")}),new le({chord:"E",lyric:new re("\ue400")})]})]}),t=new ht({}),n=new ht({lines:[new je({blocks:[new le({chord:"Bm",lyric:new re("\ue200")}),new le({chord:"A",lyric:new re("\ue200")}),new le({chord:"E",lyric:new re("\ue400")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Instrumental Sections"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"In addition to putting chords over lyrics, you can also put them in the spaces between lyrics. When there are no lyrics around the harmony, you can use tabs to create spacing in the lyrics for placing chords."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"You can do this by hitting"," ",l.a.createElement(ku,{display:"inline"},"tab")," when editting lyrics, for a normal sized tab, or"," ",l.a.createElement(ku,{display:"inline"},"SHIFT + space")," ","for a small sized tab, or"," ",l.a.createElement(ku,{display:"inline"},"SHIFT + tab")," ","for a large sized tab."),l.a.createElement(Bu,{initialSong:e}),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Let's replicate the example from above using"," ",l.a.createElement(ku,{display:"inline"},"tab"),"s. Start by editing the lyrics. Insert two normal sized tabs with the ",l.a.createElement(ku,{display:"inline"},"tab")," ","key, and a large sized tab using"," ",l.a.createElement(ku,{display:"inline"},"SHIFT + tab")," ","key. Then add"," ",l.a.createElement(Eu,{display:"inline"},"Bm"),","," ",l.a.createElement(Eu,{display:"inline"},"A"),","," ",l.a.createElement(Eu,{display:"inline"},"E"),","," ","respectively to each tab."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:t,expectedSong:n}))},Ru=function MergeLine(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds")})]}),new je({blocks:[new le({chord:"",lyric:new re("suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Merging Lines"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Sometimes the lyrics that we paste in is not the division we want. Let's merge the two lines. Click into the second line, move the cursor to the beginning of the line, and press"),l.a.createElement(Bt.a,null,"(CTRL+Backspace : Windows | CMD+Backspace : Mac)"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},Nu=function PasteLyrics(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]}),new je({})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]}),new je({blocks:[new le({chord:"",lyric:new re("Every time you are near")})]}),new je({blocks:[new le({chord:"",lyric:new re("Just like me, they long to be")})]}),new je({blocks:[new le({chord:"",lyric:new re("Close to you")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Pasting Lyrics"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"It would be annoying to have to type out the lyrics. But we can paste it in! Copy these lyrics, click into the second line, and paste:"),l.a.createElement(ku,{variantMapping:{body1:"div"}},"Every time you are near"),l.a.createElement(ku,{variantMapping:{body1:"div"}},"Just like me, they long to be"),l.a.createElement(ku,{variantMapping:{body1:"div"}},"Close to you"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},_u=function RemoveChord(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ")}),new le({chord:"B7",lyric:new re("appear?")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly appear?")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Removing Chords"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Simply remove all the chord text when editing to clear the chord. Let's remove the"," ",l.a.createElement(Eu,{display:"inline"},"B7"),"."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},Mu=Object(Pt.a)({root:{color:jo.a[300]}})(So.a),Uu=function RemoveLine(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]}),new je({blocks:[new le({chord:"",lyric:new re("Every time you are near")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Removing Lines"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Similarly, you can remove a line by hovering over the line, and clicking the ",l.a.createElement(Mu,null)," icon to the right. Let's remove the second line of lyrics."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))},Ku=function Header(){return l.a.createElement(Bt.a,{variant:"h5"},"Learning Chord Paper")},Vu=function Preamble(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,null,"Chord Paper aims to be as intuitive and handy as possible, but there could still be features that aren't obvious as we work out the kinks. Let's walk through the basics together by making some changes to chords and lyrics!"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Since Chord Paper is still in early stages, some of these could change in the future."))},Wu=function Starting(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Ku,null),l.a.createElement(wu,null),l.a.createElement(Vu,null))},Gu=Object(Pt.a)(_i)(Bt.a),Ju=[{title:"Starting",route:"/learn/start",component:Wu},{title:"Edit a Chord",route:"/learn/edit_chord",component:Pu},{title:"Remove a Chord",route:"/learn/remove_chord",component:_u},{title:"Add a Chord",route:"/learn/add_chord",component:Tu},{title:"Drag and Drop Chords",route:"/learn/drag_and_drop_chord",component:Fu},{title:"Edit Lyrics",route:"/learn/edit_lyrics",component:Au},{title:"Instrumentals",route:"/learn/instrumentals",component:zu},{title:"Chord Positioning",route:"/learn/chord_positioning",component:Du},{title:"Adding New Line",route:"/learn/add_line",component:xu},{title:"Removing a Line",route:"/learn/remove_line",component:Uu},{title:"Pasting Lyrics",route:"/learn/paste_lyrics",component:Nu},{title:"Merging Lines",route:"/learn/merge_lines",component:Ru},{title:"Splitting Lines",route:"/learn/split_lines",component:function SplitLine(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear? Every ")}),new le({chord:"B7",lyric:new re("time you are near")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear? ")})]}),new je({blocks:[new le({chord:"",lyric:new re("Every ")}),new le({chord:"B7",lyric:new re("time you are near")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Splitting Lines"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Similarly, we can split lines that may be too long for our chart into two lines. Move the cursor to where you want the line to split, and press"),l.a.createElement(Bt.a,null,"(CTRL+Enter : Windows | CMD+Enter : Mac)"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Right now, chords won't move to the subsequent line - only lyrics will. This can be worked around by dragging and dropping chords after until the feature is cleaned up."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Let's break the one long line of lyrics up, so that it looks like:"),l.a.createElement(ku,null,"Why do birds suddenly appear?"),l.a.createElement(ku,null,"Every time you are near"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))}},{title:"Copying and Pasting Lines",route:"/learn/copy_and_paste",component:Iu},{title:"Labels",route:"/learn/labels",component:function Labels(){var e=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})]}),new je({blocks:[new le({chord:"",lyric:new re("Every time you are near")})]})]}),t=new ht({lines:[new je({blocks:[new le({chord:"C^",lyric:new re("Why do birds suddenly ap-")}),new le({chord:"B7sus4",lyric:new re("pear?")}),new le({chord:"B7",lyric:new re("\ue200")})],section:{type:"label",name:"Verse"}}),new je({blocks:[new le({chord:"",lyric:new re("Every time you are near")})]})]});return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Labels"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,'It\'s common to label sections to navigate easily within the song. For example, some common labels are "Verse", "Chorus", "Bridge", or more simplified markers like "A", "B", etc.'),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Add a label to a line by hovering over the line, and then clicking the ",l.a.createElement(To.a,null)," icon to insert a label for that line. Let's add"," ",l.a.createElement(Gu,{display:"inline"},"Verse")," to the first line."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try it!"),l.a.createElement(Bu,{initialSong:e,expectedSong:t}))}},{title:"Play Mode",route:"/learn/play_mode",component:function PlayMode(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Play Mode"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Play mode is where you focus on playing the song rather than writing or transcribing it. The chords and lyrics are laid out for ease of reading while playing through."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"To go forward a page, left click anywhere on the page, or tap any button except the buttons that go back a page."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"To go back a page, right click anywhere on the page, or tap left, up, or backspace."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"Try this by going into your own song or the demo song, hovering over the menu icon on the bottom right, and clicking the"," ",l.a.createElement(ir.a,null)," icon."))}},{title:"Saving and Loading",route:"/learn/saving",component:function Saving(){return l.a.createElement(l.a.Fragment,null,l.a.createElement(Bt.a,{variant:"h6"},"Saving and Loading"),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"You can save and load your songs if you have logged in. When you want to save your song to the cloud, hover to the bottom right menu and click ",l.a.createElement(bl.a,null)," to commit the song. After the song is saved once, it will continue to save any changes automatically."),l.a.createElement(wu,null),l.a.createElement(Bt.a,null,"If you don't want to sign in or save your songs to the cloud, I get it. You can also reveal (offline) Save and Load menu icons in the bottom right menu by entering the Konami code to save and load the files striaght to your computer."))}}],Hu=Object(f.a)({root:{color:"white"}})(ir.a),qu=Object(f.a)((function(e){return{root:{marginTop:e.spacing(5),marginBottom:e.spacing(5),padding:e.spacing(5),minHeight:e.spacing(46),width:e.spacing(92),position:"relative"}}}))(St.a),Yu=Object(f.a)((function(e){return{root:{position:"absolute",bottom:e.spacing(2),right:e.spacing(2)}}}))(gu.a),$u=function Tutorial(e){var t=function matchEntry(t){return t.route===e.route},n=Ju.find(t);if(void 0===n)return l.a.createElement(Ft,null);var r=Ju.findIndex(t),a=null;if(r<Ju.length-1){var o=Ju[r+1];a=l.a.createElement(b.b,{to:o.route},l.a.createElement(Yu,{color:"primary"},l.a.createElement(Hu,null)))}return l.a.createElement(qu,null,l.a.createElement(n.component,null),a)},Xu=n(211),Qu=n.n(Xu),Zu=Object(f.a)({root:{width:"100%",cursor:"pointer"}})(St.a),es=Object(f.a)((function(e){return{root:{margin:e.spacing(2),color:jr.a[600]}}}))(Bt.a),ts=Object(At.a)({root:{display:"inline-block",objectFit:"contain"}}),ns=function Login(e){var t=Object(i.useState)(!1),n=Object(s.a)(t,2),r=n[0],a=n[1],o=Object(p.b)().enqueueSnackbar,c=qa(),u=ts(),d=l.a.useContext(ho),m=function userNotSignedIn(e){return null===e};if(Object(i.useEffect)((function(){r||(void 0!==window.gapi?a(!0):o("gapi is not loaded, working offline only",{variant:"error"}))}),[r,o]),Object(i.useEffect)((function(){r&&gapi.load("auth2",(function(){var t=function(){var t=Object(ua.a)(ca.a.mark((function _callee(t){var n,r,a;return ca.a.wrap((function _callee$(i){for(;;)switch(i.prev=i.next){case 0:return n=t.get().getAuthResponse().id_token,i.next=3,$a(n);case 3:if(r=i.sent,!Object(Ja.isLeft)(r)){i.next=8;break}return i.next=7,c(r.left);case 7:return i.abrupt("return");case 8:if(null!==(a=mo(r.right,t))){i.next=13;break}return console.error("JSON payload is not a user",r.right),o("Failed to login to backend. Check console for more error details",{variant:"error"}),i.abrupt("return");case 13:e.onUserChanged(a);case 14:case"end":return i.stop()}}),_callee)})));return function handleGoogleLogin(e){return t.apply(this,arguments)}}();if(m(d)){gapi.auth2.init({client_id:"650853277550-ta69qbfcvdl6tb5ogtnh2d07ae9rcdlf.apps.googleusercontent.com",scope:"profile email"}).then((function handleAuthInit(e){e.attachClickHandler(document.getElementById("google-sign-in"),{},(function(){return t(e.currentUser)}),(function(e){console.error("Failed to login to Google",e)})),e.isSignedIn.get()&&t(e.currentUser)}))}}))}),[o,d,e,r,c]),!r)return l.a.createElement("div",null);return l.a.createElement(Zu,{id:"google-sign-in",classes:e.classes},l.a.createElement(h.a,{container:!0,alignItems:"center",justify:"center"},l.a.createElement(h.a,{item:!0},l.a.createElement("img",{src:Qu.a,alt:"Google Signin",className:u.root})),l.a.createElement(h.a,{item:!0},l.a.createElement(es,{variant:"h6",display:"inline"},function userDescription(e){return m(e)?"Sign In":null===e.name?"You Logged In But Who Are You???":e.name}(d)))))},rs=Object(f.a)({root:{cursor:"pointer"}}),as=rs(du.a),os=rs(ru.a),is=Object(f.a)({root:{display:"flex",flexDirection:"column"}})(Xc.a),ls=Object(f.a)({root:{maxWidth:"none"}})(h.a),cs=Object(f.a)((function(e){return{root:{padding:e.spacing(3)}}}))(h.a),us=Object(f.a)({root:{color:jr.a[600]}})(Bt.a),ss=Object(f.a)({root:{minWidth:"24px",height:"100vh"}})(St.a),ds=Object(f.a)({root:{height:"100%",width:"100%"}})(h.a),hs=Object(At.a)({root:{flexGrow:1}}),ms=function SideMenu(e){var t=l.a.useContext(ho),n=Object(i.useState)(!1),r=Object(s.a)(n,2),a=r[0],o=r[1],c=Object(i.useState)(!1),u=Object(s.a)(c,2),d=u[0],m=u[1],f=Object(i.useState)(!1),p=Object(s.a)(f,2),y=p[0],v=p[1],g=hs(),k={variant:"h6"},E=function learnClickHandler(){v(!y)},w={textDecoration:"none",color:"inherit"},C=l.a.createElement(is,{variant:"persistent",open:!a,anchor:"left"},l.a.createElement(ss,null,l.a.createElement(ds,{container:!0,direction:"column",alignContent:"center"},l.a.createElement(ls,{item:!0,xs:1}),l.a.createElement(ls,{item:!0,xs:1},l.a.createElement(as,{onClick:function onClick(){return o(!0)}})),l.a.createElement(ls,{item:!0,xs:10})))),O=l.a.createElement(is,{variant:"persistent",open:a,anchor:"left"},l.a.createElement(cs,{container:!0,alignItems:"center",justify:"space-between"},l.a.createElement(h.a,{item:!0},l.a.createElement(b.b,{to:"/",style:w,"data-testid":"Menu-TitleButton"},l.a.createElement(us,{variant:"h5",display:"inline"},"Chord Paper"))),l.a.createElement(h.a,{item:!0},l.a.createElement(os,{onClick:function onClick(){return o(!1)}}))),l.a.createElement(Jt.a,null),l.a.createElement(tu.a,null,l.a.createElement(b.b,{key:kt.URL(),to:kt.URL(),style:w,"data-testid":"Menu-HomeButton"},l.a.createElement(Qc.a,{key:"New Song",button:!0},l.a.createElement(eu.a,null,l.a.createElement(mu.a,null)),l.a.createElement(Zc.a,{primary:"New Song",primaryTypographyProps:k}))),null!==t&&l.a.createElement(Qc.a,{key:"Load Song",button:!0,onClick:function onClick(e){return m(!0)}},l.a.createElement(eu.a,null,l.a.createElement(uu.a,null)),l.a.createElement(Zc.a,{primary:"Load Song",primaryTypographyProps:k})),l.a.createElement(b.b,{key:jt.URL(),to:jt.URL(),style:w,"data-testid":"Menu-DemoButton"},l.a.createElement(Qc.a,{key:"Demo",button:!0},l.a.createElement(eu.a,null,l.a.createElement(vu.a,null)),l.a.createElement(Zc.a,{primary:"Demo",primaryTypographyProps:k}))),function tutorialMenu(){var e=function allExerciseRoutes(){return Ju.map((function(e){return{title:e.title,route:e.route}}))}().map((function(e){return l.a.createElement(b.b,{key:e.route,to:e.route,style:w},l.a.createElement(Qc.a,{button:!0},l.a.createElement(Zc.a,{inset:!0,primary:e.title})))}));return l.a.createElement(l.a.Fragment,null,l.a.createElement(Qc.a,{key:"Learn",button:!0,onClick:E},l.a.createElement(eu.a,null,l.a.createElement(lu.a,null)),l.a.createElement(Zc.a,{primary:"Learn",primaryTypographyProps:k}),y?l.a.createElement(ou.a,null):l.a.createElement(Er.a,null)),l.a.createElement(Cr.a,{in:y,timeout:"auto"},l.a.createElement(tu.a,null,e)))}(),l.a.createElement(b.b,{key:"/about",to:"/about",style:w,"data-testid":"Menu-AboutButton"},l.a.createElement(Qc.a,{key:"About",button:!0},l.a.createElement(eu.a,null,l.a.createElement(pu.a,null)),l.a.createElement(Zc.a,{primary:"About",primaryTypographyProps:k})))),l.a.createElement("div",{className:g.root}),l.a.createElement(ns,{onUserChanged:e.onUserChanged}));return l.a.createElement(l.a.Fragment,null,C,O,d&&l.a.createElement(bu,{open:!0,onClose:function onClose(){return m(!1)}}))},fs=function InternalFetcher(e){var t=qa(),n=Object(i.useState)({state:"not-started"}),r=Object(s.a)(n,2),a=r[0],o=r[1],c=function(){var t=Object(ua.a)(ca.a.mark((function _callee(){var t,n;return ca.a.wrap((function _callee$(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,Xa(e.id);case 2:if(t=r.sent,!Object(Ja.isLeft)(t)){r.next=6;break}return o({state:"error",error:t.left}),r.abrupt("return");case 6:if(n=ht.fromJSONObject(t.right),!Object(Ja.isLeft)(n)){r.next=10;break}return o({state:"error",error:"Failed to deserialize payload to song"}),r.abrupt("return");case 10:o({state:"loaded",item:n.right});case 11:case"end":return r.stop()}}),_callee)})));return function fetchSong(){return t.apply(this,arguments)}}();switch(a.state){case"not-started":return o({state:"loading"}),c(),l.a.createElement(l.a.Fragment,null);case"error":return t(a.error),l.a.createElement(uo,null);case"loading":return l.a.createElement(_t.a,{size:200,thickness:1});case"loaded":return e.children(a.item)}},ps=function SongFetcher(e){var t=Object(v.j)().id;return l.a.createElement(fs,{key:t,id:t},e.children)},ys=Object(f.a)((function(e){return{root:{position:"absolute",top:0,right:0,padding:e.spacing(1),color:jr.a[600]}}}))(Bt.a),vs=function Version(){var e=null!=="0.7.0.5.g568d2f0"?"0.7.0.5.g568d2f0":"dev-build";return l.a.createElement(ys,{variant:"subtitle2"},e)},bs=function createTheme(){return Object(d.a)({palette:{primary:{main:"#4fc3f7",light:"#8bf6ff",dark:"#0093c4",contrastText:"#000000"},secondary:{main:"#844ffc",light:"#bb7eff",dark:"#4a1fc8",contrastText:"#ffffff"},success:{main:"#00c853",light:"#5efc82",dark:"#009624",contrastText:"#000000"}},typography:{fontFamily:"Merriweather",fontWeightRegular:300}})}(),gs=Object(f.a)((function(e){return{variantSuccess:{backgroundColor:e.palette.success.main}}}))(p.a),ks=Object(f.a)({root:{backgroundImage:"url(".concat(k.a,")"),minHeight:"100vh"}})(h.a),Es=function withCloudSaveSongContext(e){return function(t){var n=function useCloud(){var e=Object(i.useRef)(!1);return[Object(i.useCallback)((function(t,n){"set-last-saved-at"!==n.type&&(e.current=!0)}),[]),function useSave(t,n){var r=l.a.useContext(ho),a=qa(),o=Object(p.b)().enqueueSnackbar,c=Object(v.h)(),u=Object(i.useCallback)((function(t){return e.current&&!t.isUnsaved()&&t.isOwner(r)}),[r]);Object(i.useEffect)((function(){var i=function(){var t=Object(ua.a)(ca.a.mark((function _callee(t){return ca.a.wrap((function _callee$(n){for(;;)switch(n.prev=n.next){case 0:if("string"!==typeof t){n.next=4;break}o(t,{variant:"error"}),n.next=6;break;case 4:return n.next=6,a(t);case 6:e.current=!0;case 7:case"end":return n.stop()}}),_callee)})));return function handleError(e){return t.apply(this,arguments)}}(),l=function(){var t=Object(ua.a)(ca.a.mark((function _callee2(t,r){var a,o;return ca.a.wrap((function _callee2$(l){for(;;)switch(l.prev=l.next){case 0:return l.next=2,to(r,t.authToken);case 2:if(a=l.sent,!Object(B.isLeft)(a)){l.next=7;break}return l.next=6,i(a.left);case 6:return l.abrupt("return");case 7:if(e.current=!1,o=ht.fromJSONObject(a.right),!Object(B.isLeft)(o)){l.next=13;break}return l.next=12,i("Song results from backend can't be deserialized");case 12:return l.abrupt("return");case 13:n({type:"set-last-saved-at",lastSavedAt:o.right.lastSavedAt});case 14:case"end":return l.stop()}}),_callee2)})));return function save(e,n){return t.apply(this,arguments)}}(),c=function(){var e=Object(ua.a)(ca.a.mark((function _callee3(e){return ca.a.wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:if(null!==r){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,gc()();case 4:if(t.sent){t.next=6;break}return t.abrupt("return");case 6:if(u(e)){t.next=8;break}return t.abrupt("return");case 8:return t.next=10,l(r,e);case 10:case"end":return t.stop()}}),_callee3)})));return function saveIfChanged(t){return e.apply(this,arguments)}}(),s=setInterval((function(){return c(t)}),1e4);return function(){return clearInterval(s)}}),[t,n,r,o,a,u]),Object(i.useEffect)((function(){var e=function unloadMessageFn(e){u(t)&&(e.preventDefault(),e.returnValue=!0)};return window.addEventListener("beforeunload",e),function(){return window.removeEventListener("beforeunload",e)}}),[t,u]);return l.a.createElement(v.a,{message:function showLeavingPrompt(){return!u(t)||!Ct.isEditMode(c.location.pathname)||"This page is asking you to confirm that you want to leave - data you have entered may not be saved."}})}]}(),r=Object(s.a)(n,2),a=r[0],o=r[1],c=vc(t.song,a),u=Object(s.a)(c,2),d=u[0],h=u[1],m=o(d,h),f=(t.song,Object(Mi.a)(t,["song"])),y=Object(j.a)(Object(j.a)({},f),{},{song:d,songDispatch:h});return l.a.createElement(l.a.Fragment,null,m,l.a.createElement(e,y))}}(pc),ws=function AppContent(){var e=Object(i.useState)(null),t=Object(s.a)(e,2),n=t[0],r=t[1],a=function handleUserChanged(e){return r(e)},o=Object(v.i)(),c=kt.withID(":id"),u=Ct.isPlayMode(o.pathname)||Lt.isPlayMode(o.pathname)||o.pathname===bt.URL(),d=function withRegularAppLayout(e){return l.a.createElement(l.a.Fragment,null,!u&&l.a.createElement(ms,{onUserChanged:a}),l.a.createElement(ks,{container:!0},l.a.createElement(h.a,{item:!0,container:!0,justify:"center"},e)),l.a.createElement(vs,null))},m=l.a.createElement(v.e,null,l.a.createElement(v.b,{from:ft.URL(),to:wt.URL(),exact:!0}),l.a.createElement(v.c,{key:wt.URL(),path:wt.URL()},d(l.a.createElement(Es,{song:new ht({}),path:wt}))),l.a.createElement(v.c,{key:c.URL(),path:c.URL()},d(l.a.createElement(ps,null,(function(e){return l.a.createElement(Es,{song:e,path:c.parent().withID(e.id)})})))),l.a.createElement(v.c,{key:jt.URL(),path:jt.URL()},d(l.a.createElement(Ec,null))),function TutorialSwitches(e){return Ju.map((function(t){return l.a.createElement(v.c,{key:t.route,exact:!0,path:t.route},e(l.a.createElement($u,{route:t.route})))}))}(d),l.a.createElement(v.c,{key:yt.URL(),path:yt.URL(),exact:!0},d(l.a.createElement(xt,null))),l.a.createElement(v.c,{key:bt.URL(),path:bt.URL(),exact:!0},l.a.createElement($c,null)),l.a.createElement(v.b,{to:ft.URL()}));return l.a.createElement(ho.Provider,{value:n},m)};var Cs=function App(){return l.a.createElement(y.b,null,l.a.createElement(m.a,{theme:bs},l.a.createElement(y.a,{titleTemplate:"%s - Chord Paper",defaultTitle:"Chord Paper"}),l.a.createElement(gs,null,l.a.createElement(b.a,null,l.a.createElement(jc,null,l.a.createElement(qn,null,l.a.createElement(ws,null)))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));u.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(Cs,null)),document.getElementById("root")),function unregister(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}()}},[[248,1,2]]]);
//# sourceMappingURL=main.6f76a8a6.chunk.js.map