(this["webpackJsonpchord-paper-fe"]=this["webpackJsonpchord-paper-fe"]||[]).push([[0],{107:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(8),o=n.n(i),c=(n(90),n(71)),l=n(141),d=n(135),u=function(e){var t=e.match(/((\w|')+|[^\w'])/g);return null===t?[]:t},s=n(57),h=n(56),f=n(30),m=n(31),v=function(){function e(t){Object(f.a)(this,e),this.elements=void 0,this.elements=void 0!==t?t:[]}return Object(m.a)(e,[{key:"indexOf",value:function(e){var t=this.elements.findIndex((function(t){return t.id===e}));if(t<0)throw new Error("Can't find element inside collection");return t}},{key:"addAfter",value:function(e){for(var t,n=this.indexOf(e.id),a=arguments.length,r=new Array(a>1?a-1:0),i=1;i<a;i++)r[i-1]=arguments[i];(t=this.elements).splice.apply(t,[n+1,0].concat(r))}},{key:"remove",value:function(e){var t=this.indexOf(e.id);return this.elements.splice(t,1)[0]}}]),e}(),g=n(54),p=n.n(g),y=n(14),b=n(12),E=function(e){return JSON.stringify(e,(function(e,t){if("id"!==e)return t}))},k=y.d({chord:y.c,lyric:y.c,type:y.b("ChordBlock")}),O=function(){function e(t){var n=t.chord,a=t.lyric;Object(f.a)(this,e),this.id=void 0,this.chord=void 0,this.lyric=void 0,this.type=void 0,this.id=p.a.generate(),this.chord=n,this.lyric=a,this.type="ChordBlock"}return Object(m.a)(e,[{key:"serialize",value:function(){return E(this)}},{key:"split",value:function(t){if(0===t)throw new Error("Split index can't be zero");var n=this.lyricTokens,a=n.slice(0,t),r=n.slice(t),i=new e({chord:this.chord,lyric:a.join("")});return this.chord="",this.lyric=r.join(""),i}},{key:"lyricTokens",get:function(){return u(this.lyric)}}],[{key:"fromValidatedFields",value:function(t){return new e({chord:t.chord,lyric:t.lyric})}},{key:"deserialize",value:function(t){var n=Object(b.parseJSON)(t,(function(){return new Error("Failed to parse json string")}));if(Object(b.isLeft)(n))return n;var a=n.right,r=k.decode(a);return Object(b.isLeft)(r)?Object(b.left)(new Error("Invalid Chord Block object")):Object(b.right)(new e({chord:r.right.chord,lyric:r.right.lyric}))}}]),e}(),j=y.d({elements:y.a(k),type:y.b("ChordLine")}),w=function(e){Object(s.a)(n,e);var t=Object(h.a)(n);function n(e){var a;return Object(f.a)(this,n),(a=t.call(this,e)).id=void 0,a.type=void 0,a.id=p.a.generate(),a.type="ChordLine",a}return Object(m.a)(n,[{key:"serialize",value:function(){return E(this)}},{key:"replaceLyrics",value:function(e){e!==this.lyrics&&(this.elements=[new O({chord:"",lyric:e})])}},{key:"setChord",value:function(e,t){var n=this.indexOf(e.id);this.elements[n].chord=t,""===this.elements[n].chord&&this.mergeBlocks(n)}},{key:"mergeBlocks",value:function(e){0!==e&&(this.elements[e-1].lyric+=this.elements[e].lyric,this.elements.splice(e,1))}},{key:"splitBlock",value:function(e,t){var n=this.indexOf(e.id),a=this.elements[n].split(t);this.elements.splice(n,0,a)}},{key:"clone",value:function(){var e=new n(this.elements);return e.id=this.id,e}},{key:"chordBlocks",get:function(){return this.elements}},{key:"lyrics",get:function(){return this.chordBlocks.map((function(e){return e.lyric})).join("")}}],[{key:"fromValidatedFields",value:function(e){return new n(e.elements.map((function(e){return O.fromValidatedFields(e)})))}},{key:"deserialize",value:function(e){var t=Object(b.parseJSON)(e,(function(){return new Error("Failed to parse json string")}));if(Object(b.isLeft)(t))return t;var n=t.right,a=j.decode(n);return Object(b.isLeft)(a)?Object(b.left)(new Error("Invalid Chord Line object")):Object(b.right)(this.fromValidatedFields(a.right))}},{key:"fromLyrics",value:function(e){return new n([new O({chord:"",lyric:e})])}}]),n}(v),C=y.d({title:y.c,composedBy:y.c,performedBy:y.c,asHeardFrom:y.c}),L=y.d({elements:y.a(j),metadata:C}),B=function(e){Object(s.a)(n,e);var t=Object(h.a)(n);function n(e,a){var r;return Object(f.a)(this,n),(r=t.call(this,e)).metadata=void 0,r.metadata=void 0!==a?a:{title:"",composedBy:"",performedBy:"",asHeardFrom:""},r}return Object(m.a)(n,[{key:"serialize",value:function(){return E(this)}},{key:"clone",value:function(){return new n(this.elements,this.metadata)}},{key:"chordLines",get:function(){return this.elements}},{key:"title",get:function(){return this.metadata.title},set:function(e){this.metadata.title=e}},{key:"performedBy",get:function(){return this.metadata.performedBy},set:function(e){this.metadata.performedBy=e}},{key:"composedBy",get:function(){return this.metadata.composedBy},set:function(e){this.metadata.composedBy=e}},{key:"asHeardFrom",get:function(){return this.metadata.asHeardFrom},set:function(e){this.metadata.asHeardFrom=e}}],[{key:"fromValidatedFields",value:function(e){return new n(e.elements.map((function(e){return w.fromValidatedFields(e)})),e.metadata)}},{key:"deserialize",value:function(e){var t=Object(b.parseJSON)(e,(function(){return new Error("Failed to parse json string")}));if(Object(b.isLeft)(t))return t;var n=t.right,a=L.decode(n);return Object(b.isLeft)(a)?Object(b.left)(new Error("Invalid Chord Song object")):Object(b.right)(this.fromValidatedFields(a.right))}},{key:"fromLyricsLines",value:function(e){return new n(e.map((function(e){return w.fromLyrics(e)})))}}]),n}(v),S=n(15),F=n(5),x=n(139),A=n(72),R=n(134),V=n(138),P=n(143),T=n(74),z=n(19),H=n(144),I=n(112),N=function(e){var t=Object(a.useState)(e.children),n=Object(S.a)(t,2),i=n[0],o=n[1],c=r.a.createRef(),l=Object(z.a)(),d=function(t){e.onFinish&&e.onFinish(t)},u=Object(I.a)((function(t){return void 0===e.variant?{root:{}}:{root:{fontSize:t.typography[e.variant].fontSize}}}))(H.a);return r.a.createElement(u,{autoFocus:!0,inputProps:Object(T.a)({"data-testid":"InnerInput"},function(t,n){var a,r,i=0;void 0!==e.variant&&(null===t||void 0===t||null===(a=t.typography)||void 0===a||null===(r=a[e.variant])||void 0===r?void 0:r.padding)&&(i=t.typography[e.variant].padding);var o={style:{padding:i}};return n&&o.style&&(o.style.width=n),o}(l,e.width)),inputRef:c,value:i,onBlur:function(){d(i)},onChange:function(e){o(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&d(i)},onPaste:function(t){var n=t.clipboardData.getData("text/plain");if(""!==n){var a=n.split("\n");if(a.length>1&&void 0!==e.onPasteOverflow){t.preventDefault();var r=function(e){var t,n;null===c.current||null===c.current.selectionStart||null===c.current.selectionEnd?(t=i,n=""):(t=i.slice(0,c.current.selectionStart),n=i.slice(c.current.selectionEnd));var a=t+e[0],r=e.slice(1);return r[r.length-1]+=n,[a,r]}(a),l=Object(S.a)(r,2),u=l[0],s=l[1];o(u),d(u),e.onPasteOverflow(s)}}},fullWidth:!0,"data-testid":"EditableLine"})},W=n(109),D=n(111),J=n(137),M=n(48),U=n.n(M),G=function(e){return/^\s+$/.test(e)},Y=function(e){return G(e)?"\xa0":e},$=Object(I.a)((function(e){return{root:{whiteSpace:"pre","&:hover":{color:e.palette.secondary.main},cursor:"pointer",fontFamily:"PoriChord"}}}))(R.a),_=function(e){return r.a.createElement($,{variant:"h5",display:"inline","data-testid":"Chord"},function(){var t=e.children;return t.endsWith(" ")?t:Y(t+=" ")}())},q=Object(F.a)((function(e){return{root:{"&:hover":{color:e.palette.secondary.main},cursor:"pointer"}}}))(R.a),K=Object(F.a)((function(e){return{root:{whiteSpace:"pre","&:hover":{backgroundColor:e.palette.secondary.light},cursor:"pointer"}}}))(R.a),Z=function(e){var t=Object(a.useState)(!1),n=Object(S.a)(t,2),i=n[0],o=n[1],c=e.chordBlock.lyricTokens;0===c.length&&(c=["\xa0"]);var l,u=c.map((function(t,n){return function(t,n){var a,i={key:n,variant:"h5",display:"inline",onClick:(a=n,function(){0!==a&&e.onBlockSplit&&e.onBlockSplit(e.chordBlock,a),o(!0)}),"data-testid":"Token-".concat(n)};return G(t)?r.a.createElement(K,i,t):r.a.createElement(q,i,t)}(t,n)}));return l=i?r.a.createElement(P.a,{"data-testid":"ChordEdit"},r.a.createElement(N,{width:"5em",variant:"h5",onFinish:function(t){e.onChordChange&&e.onChordChange(e.chordBlock,t),o(!1)}},e.chordBlock.chord)):r.a.createElement(_,null,e.chordBlock.chord),r.a.createElement(d.a,{container:!0,direction:"column",component:"span","data-testid":e["data-testid"]},r.a.createElement(d.a,{item:!0,onClick:function(){return o(!0)}},l),r.a.createElement(d.a,{item:!0,"data-testid":"Lyric"},r.a.createElement(r.a.Fragment,null,u)))},Q=n(64),X=n.n(Q),ee=n(65),te=n.n(ee),ne=n(66),ae=n.n(ne),re={root:{color:"white"}},ie=Object(F.a)(re)(X.a),oe=Object(F.a)(re)(te.a),ce=Object(F.a)(re)(ae.a),le=Object(F.a)((function(e){return{contained:{backgroundColor:e.palette.primary.main,"&:hover":{backgroundColor:e.palette.primary.dark}}}}))(W.a),de=Object(F.a)({tooltip:{padding:0}})(D.a),ue=Object(F.a)((function(e){return{root:{"&:hover":{backgroundColor:U.a[100]},maxWidth:e.spacing(92)}}}))(P.a),se=function(e){var t=e.chordLine.chordBlocks;0===t.length&&(t=[new O({chord:"",lyric:""})]);var n=function(t,n){e.chordLine.setChord(t,n),e.onChangeLine&&e.onChangeLine(e.chordLine)},a=function(t,n){e.chordLine.splitBlock(t,n),e.onChangeLine&&e.onChangeLine(e.chordLine)},i=t.map((function(e,t){return r.a.createElement(d.a,{item:!0,key:e.id},r.a.createElement(Z,{key:e.id,chordBlock:e,onChordChange:n,onBlockSplit:a,"data-testid":"Block-".concat(t)}))}));return r.a.createElement(de,{placement:"right",title:r.a.createElement(J.a,{variant:"outlined",orientation:"vertical"},r.a.createElement(le,{variant:"contained",onClick:e.onEditButton,"data-testid":"EditButton"},r.a.createElement(ie,null)),r.a.createElement(le,{variant:"contained",onClick:e.onAddButton,"data-testid":"AddButton"},r.a.createElement(oe,null)),r.a.createElement(le,{variant:"contained",onClick:e.onRemoveButton,"data-testid":"RemoveButton"},r.a.createElement(ce,null))),interactive:!0},r.a.createElement(ue,{"data-testid":"NoneditableLine"},r.a.createElement(d.a,{container:!0},i)))},he=function(e){var t=Object(a.useState)(!1),n=Object(S.a)(t,2),i=n[0],o=n[1],c=Object(a.useState)(!1),l=Object(S.a)(c,2),u=l[0],s=l[1],h=function(){o(!0)},f=function(t){o(!1),e.chordLine.replaceLyrics(t),e.onChangeLine&&e.onChangeLine(e.chordLine)},m=function(){e.onAddLine&&e.onAddLine(e.chordLine)},v=function(){s(!0),e.onRemoveLine&&setTimeout((function(){e.onRemoveLine&&e.onRemoveLine(e.chordLine)}),250)},g=function(t){e.onPasteOverflow&&(e.onPasteOverflow(e.chordLine,t),o(!1))},p=i?function(){var t=e.chordLine.lyrics;return r.a.createElement(d.a,{container:!0,direction:"column"},r.a.createElement(d.a,{item:!0},r.a.createElement(R.a,{variant:"h5"},"Chords Placeholder")),r.a.createElement(d.a,{item:!0},r.a.createElement(N,{variant:"h5",onFinish:f,onPasteOverflow:g},t)))}():r.a.createElement(se,{chordLine:e.chordLine,onChangeLine:e.onChangeLine,onAddButton:m,onRemoveButton:v,onEditButton:h}),y=u?"up":"down";return r.a.createElement(V.a,{direction:y,in:!u,timeout:250},r.a.createElement(P.a,{borderBottom:1,borderColor:"grey.50",width:"auto",minWidth:"30em",margin:"3rem","data-testid":e["data-testid"]},p))},fe=Object(F.a)((function(e){return{root:{padding:e.spacing(9.5),width:"max-content"}}}))(x.a),me=function(e){var t=function(t){var n=new w;e.song.addAfter(t,n),o()},n=function(t){e.song.remove(t),o()},a=function(e){o()},i=function(t,n){var a,r=n.map((function(e){return w.fromLyrics(e)}));(a=e.song).addAfter.apply(a,[t].concat(Object(A.a)(r))),o()},o=function(){e.onSongChanged&&e.onSongChanged(e.song)};return r.a.createElement(fe,{elevation:0},r.a.createElement(d.a,{container:!0,justify:"center"},r.a.createElement(d.a,{item:!0},e.song.chordLines.map((function(e,o){return r.a.createElement(he,{key:e.id,chordLine:e,onAddLine:t,onRemoveLine:n,onChangeLine:a,onPasteOverflow:i,"data-testid":"Line-".concat(o)})})))))},ve=n(75),ge=n(73),pe=Object(I.a)((function(e){return{root:{color:U.a[200]}}}))(R.a),ye=function(e){var t=Object(a.useState)(!1),n=Object(S.a)(t,2),i=n[0],o=n[1],c=function(){o(!0)},l=function(t){o(!1),e.onValueChange&&e.onValueChange(t)},d=i?function(){if("inherit"===e.variant||"srOnly"===e.variant)throw new Error("can't have these variant types");return r.a.createElement(N,{variant:e.variant,onFinish:l,"data-testid":"EditableLine"},e.children)}():function(){e.children,e.placeholder,e.onValueChange;var t=Object(ge.a)(e,["children","placeholder","onValueChange"]);return""===e.children&&void 0!==e.placeholder?r.a.createElement(pe,Object.assign({},t,{onClick:c}),e.placeholder):r.a.createElement(R.a,Object.assign({},t,{onClick:c}),Y(e.children))}();return r.a.createElement(P.a,null,d)},be=function(e){var t=Object(ve.a)(),n=function(){e.onSongChanged&&e.onSongChanged(e.song)},a=r.a.createElement(d.a,{item:!0,container:!0,xs:3,direction:"column"},r.a.createElement(d.a,{item:!0},r.a.createElement(R.a,{display:"inline",variant:"caption"},"As heard from:"," "),r.a.createElement(ye,{variant:"caption",placeholder:"https://www.youtube.com/watch?v=dM9zwZCOmjM",onValueChange:function(t){e.song.asHeardFrom=t,n()},"data-testid":"AsHeardAt"},e.song.asHeardFrom))),i=r.a.createElement(d.a,{item:!0,xs:6},r.a.createElement(ye,{variant:"h4",align:"center","data-testid":"SongTitle",placeholder:"Song Title",onValueChange:function(t){e.song.title=t,n()}},e.song.title)),o=r.a.createElement(d.a,{item:!0,container:!0,xs:3,direction:"column"},r.a.createElement(d.a,{item:!0},r.a.createElement(R.a,{display:"inline",variant:"subtitle2"},"Composed by:"," "),r.a.createElement(ye,{variant:"subtitle2",placeholder:"Stock Waterman",onValueChange:function(t){e.song.composedBy=t,n()},"data-testid":"ComposedBy"},e.song.composedBy)),r.a.createElement(d.a,{item:!0},r.a.createElement(R.a,{display:"inline",variant:"subtitle2"},"Performed by:"," "),r.a.createElement(ye,{variant:"subtitle2",placeholder:"Rick Astley",onValueChange:function(t){e.song.performedBy=t,n()},"data-testid":"PerformedBy"},e.song.performedBy)));return r.a.createElement(P.a,{paddingTop:t.spacing(1),paddingLeft:t.spacing(.5),paddingRight:t.spacing(.5),"data-testid":"Header"},r.a.createElement(d.a,{container:!0},a,i,o))},Ee=n(55),ke=n.n(Ee),Oe=n(68),je=n(145),we=n(146),Ce=n(140),Le=n(69),Be=n.n(Le),Se=n(70),Fe=n.n(Se),xe=n(49),Ae=Object(I.a)((function(e){return{root:{position:"fixed",bottom:e.spacing(2),right:e.spacing(2)}}}))(je.a),Re=function(e){var t=Object(a.useState)(!1),n=Object(S.a)(t,2),i=n[0],o=n[1],c=Object(xe.b)().enqueueSnackbar,l=function(){var t=Object(Oe.a)(ke.a.mark((function t(){var n;return ke.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:(n=document.createElement("input")).type="file",n.addEventListener("change",(function(){var t=n.files;if(null!==t)if(t.length>1)c("Multiple files selected, only one file expected",{variant:"error"});else{var a=t.item(0);if(null!==a){var r=new FileReader;r.onload=function(t){if(!(null===t.target||null===t.target.result||t.target.result instanceof ArrayBuffer)){var n=B.deserialize(t.target.result);Object(b.isLeft)(n)?c("Can't load file, Song file failed validation",{variant:"error"}):e.onLoad&&e.onLoad(n.right)}},r.readAsText(a)}else c("Could not retrieve file from file dialog",{variant:"error"})}})),n.click();case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();return r.a.createElement(Ae,{icon:r.a.createElement(we.a,null),open:i,onOpen:function(){o(!0)},onClose:function(){o(!1)},ariaLabel:"SpeedDial"},r.a.createElement(Ce.a,{icon:r.a.createElement(Be.a,null),tooltipTitle:"Save",onClick:function(){var t=new Blob([e.song.serialize()],{type:"application/json"}),n=URL.createObjectURL(t),a=document.createElement("a");a.download="chord_paper_song.json",a.href=n,a.click(),URL.revokeObjectURL(n)}}),r.a.createElement(Ce.a,{icon:r.a.createElement(Fe.a,null),tooltipTitle:"Load",onClick:l}))},Ve=Object(F.a)((function(e){return{root:{margin:e.spacing(5),minHeight:"750px",width:"max-content"}}}))(x.a),Pe=function(e){var t=Object(a.useState)(e.initialSong),n=Object(S.a)(t,2),i=n[0],o=n[1],c=function(e){o(e.clone())};return r.a.createElement(Ve,{elevation:3},r.a.createElement(be,{"data-testid":"Header",song:i,onSongChanged:c}),r.a.createElement(me,{song:i,onSongChanged:c}),r.a.createElement(Re,{song:i,onLoad:function(e){o(e.clone())}}))};var Te=function(){var e=Object(c.a)({palette:{primary:{main:"#4fc3f7",light:"#8bf6ff",dark:"#0093c4",contrastText:"#000000"},secondary:{main:"#844ffc",light:"#bb7eff",dark:"#4a1fc8",contrastText:"#ffffff"}},typography:{fontFamily:"Playfair",fontWeightRegular:500}}),t=["We're no strangers to love","You know the rules and so do I","A full commitment's what I'm thinking of","You wouldn't get this from any other guy","I just wanna tell you how I'm feeling","Gotta make you understand","Never gonna give you up","Never gonna let you down","Never gonna run around and desert you","Never gonna make you cry","Never gonna say goodbye","Never gonna tell a lie and hurt you"],n=["A","Bb7","Cm","D/C#","Em7","Fmaj7","G"],a=function(e){var t=function(e,t){for(var n=u(e),a=[],r=0;r<n.length;r+=t){var i=n.slice(r,r+t);a.push(i.join(""))}return a}(e,4).map((function(e){return new O({chord:n[Math.floor(Math.random()*n.length)],lyric:e})}));return new w(t)};return r.a.createElement(l.a,{theme:e},r.a.createElement(xe.a,null,r.a.createElement(d.a,{container:!0,justify:"center"},r.a.createElement(d.a,{item:!0},r.a.createElement(Pe,{initialSong:function(){var e=t.map((function(e){return a(e)}));return new B(e)}()})))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Te,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},85:function(e,t,n){e.exports=n(107)},90:function(e,t,n){}},[[85,1,2]]]);
//# sourceMappingURL=main.7ce4e5c6.chunk.js.map